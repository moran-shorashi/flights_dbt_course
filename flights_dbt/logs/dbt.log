[0m14:32:28.486741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107758d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a6f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d5ff90>]}


============================== 14:32:28.516465 | ad42051e-4524-433e-b048-0d7207e293b9 ==============================
[0m14:32:28.516465 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:32:28.517809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/moranshorashi/.dbt', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:32:29.046497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad42051e-4524-433e-b048-0d7207e293b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d5f810>]}
[0m14:32:29.063556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad42051e-4524-433e-b048-0d7207e293b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103bc510>]}
[0m14:32:29.065221 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:32:29.140953 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:32:29.141799 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:32:29.142264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad42051e-4524-433e-b048-0d7207e293b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a6ff90>]}
[0m14:32:29.938150 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m14:32:29.950594 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m14:32:29.953925 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_airport.sql
[0m14:32:29.958655 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_airport.sql
[0m14:32:30.032171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad42051e-4524-433e-b048-0d7207e293b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a0310>]}
[0m14:32:30.039252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad42051e-4524-433e-b048-0d7207e293b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111593450>]}
[0m14:32:30.039881 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:32:30.040370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad42051e-4524-433e-b048-0d7207e293b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d4f9d0>]}
[0m14:32:30.042488 [info ] [MainThread]: 
[0m14:32:30.043591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:32:30.045358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m14:32:30.057430 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m14:32:30.058115 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m14:32:30.058596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:30.224805 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_demo" does not exist

[0m14:32:30.232995 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m14:32:30.233411 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:32:30.233768 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:32:30.234042 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:32:30.234340 [debug] [ThreadPool]: On list_flights_demo: No close available on handle
[0m14:32:30.235322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:30.235593 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m14:32:30.235867 [info ] [MainThread]: 
[0m14:32:30.236336 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m14:32:30.237109 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_demo" does not exist
  
[0m14:32:30.238514 [debug] [MainThread]: Command `dbt run` failed at 14:32:30.238343 after 1.80 seconds
[0m14:32:30.238966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110776d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d4fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a3850>]}
[0m14:32:30.239409 [debug] [MainThread]: Flushing usage events
[0m14:37:09.333866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f86a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f87190>]}


============================== 14:37:09.395129 | 3f5caedd-3681-41a6-9788-283ec6ca5a53 ==============================
[0m14:37:09.395129 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:37:09.395873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/moranshorashi/.dbt', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:37:09.575215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f5caedd-3681-41a6-9788-283ec6ca5a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f87190>]}
[0m14:37:09.589880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f5caedd-3681-41a6-9788-283ec6ca5a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f01190>]}
[0m14:37:09.591867 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:37:09.629367 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:37:09.702325 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading flights_dbt: dimensions/schema.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | - name: dim_airport
    2  |     description: "dim_airport"
    3  |     columns:
    4  |       - name: airport_code
    5  |         description: "The primary key for this table"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 16
[0m14:37:09.703256 [debug] [MainThread]: Command `dbt run` failed at 14:37:09.703067 after 0.41 seconds
[0m14:37:09.703841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092bc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10533d710>]}
[0m14:37:09.704295 [debug] [MainThread]: Flushing usage events
[0m14:38:21.144208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110110a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c7aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11421bb90>]}


============================== 14:38:21.181888 | fbff5f07-a868-4788-b2ba-9a898be100de ==============================
[0m14:38:21.181888 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:38:21.182890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:38:21.346300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbff5f07-a868-4788-b2ba-9a898be100de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114231cd0>]}
[0m14:38:21.361021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbff5f07-a868-4788-b2ba-9a898be100de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114245f50>]}
[0m14:38:21.362901 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:38:21.409554 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:38:21.461841 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading flights_dbt: dimensions/schema.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | - name: dim_airport
    2  |     description: dim_airport
    3  |     columns:
    4  |       - name: airport_code
    5  |         description: "The primary key for this table"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 16
[0m14:38:21.462786 [debug] [MainThread]: Command `dbt run` failed at 14:38:21.462612 after 0.34 seconds
[0m14:38:21.463313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c79350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f33ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b7910>]}
[0m14:38:21.463806 [debug] [MainThread]: Flushing usage events
[0m14:38:26.689817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d047d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdf8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0e7690>]}


============================== 14:38:26.695229 | b7a5f17f-0b64-4646-81ea-ae4fbdad273c ==============================
[0m14:38:26.695229 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:38:26.696005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:38:26.766815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7a5f17f-0b64-4646-81ea-ae4fbdad273c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cde4410>]}
[0m14:38:26.781778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7a5f17f-0b64-4646-81ea-ae4fbdad273c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0cd590>]}
[0m14:38:26.782413 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:38:26.801172 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:38:26.824067 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading flights_dbt: dimensions/schema.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | - name: dim_airport
    2  |     description: dim_airport
    3  |     columns:
    4  |       - name: airport_code
    5  |         description: "The primary key for this table"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 16
[0m14:38:26.825139 [debug] [MainThread]: Command `dbt run` failed at 14:38:26.824925 after 0.15 seconds
[0m14:38:26.825754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdbb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca5ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0ccb50>]}
[0m14:38:26.826257 [debug] [MainThread]: Flushing usage events
[0m14:38:45.240626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063257d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106576790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106454590>]}


============================== 14:38:45.246087 | 12ad74d6-9227-4bb7-b9b6-f24d0814185d ==============================
[0m14:38:45.246087 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:38:45.246746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:38:45.318056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12ad74d6-9227-4bb7-b9b6-f24d0814185d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106299e50>]}
[0m14:38:45.333235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12ad74d6-9227-4bb7-b9b6-f24d0814185d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b1c50>]}
[0m14:38:45.333910 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:38:45.354276 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:38:45.368628 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading flights_dbt: dimensions/schema.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | - name: dim_airport
    2  |     columns:
    3  |       - name: airport_code
    4  |         description: "The primary key for this table"
    5  |         tests:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 12
[0m14:38:45.369608 [debug] [MainThread]: Command `dbt run` failed at 14:38:45.369415 after 0.15 seconds
[0m14:38:45.370114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023c1890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d492d0>]}
[0m14:38:45.370555 [debug] [MainThread]: Flushing usage events
[0m14:39:55.088601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113481f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11312c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ac610>]}


============================== 14:39:55.137273 | 999c3582-79cb-474a-a946-38637350a2e7 ==============================
[0m14:39:55.137273 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:39:55.138030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/moranshorashi/.dbt', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:39:55.304924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '999c3582-79cb-474a-a946-38637350a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113096590>]}
[0m14:39:55.319678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '999c3582-79cb-474a-a946-38637350a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136a8c50>]}
[0m14:39:55.321639 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:39:55.367602 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:39:55.497191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:39:55.497837 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/schema.yml
[0m14:39:55.498281 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/dim_airport.sql
[0m14:39:55.538338 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_airport.sql
[0m14:39:55.562735 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_airport.sql
[0m14:39:55.601573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '999c3582-79cb-474a-a946-38637350a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113734950>]}
[0m14:39:55.618077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '999c3582-79cb-474a-a946-38637350a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f2e0d0>]}
[0m14:39:55.618609 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:39:55.618999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '999c3582-79cb-474a-a946-38637350a2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eb31d0>]}
[0m14:39:55.621024 [info ] [MainThread]: 
[0m14:39:55.621969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:55.623263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m14:39:55.636159 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m14:39:55.636687 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m14:39:55.637099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:55.707953 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_demo" does not exist

[0m14:39:55.715391 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m14:39:55.715901 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:39:55.716269 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:39:55.716543 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:39:55.716835 [debug] [ThreadPool]: On list_flights_demo: No close available on handle
[0m14:39:55.717767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:55.718034 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m14:39:55.718310 [info ] [MainThread]: 
[0m14:39:55.718714 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m14:39:55.719318 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_demo" does not exist
  
[0m14:39:55.720193 [debug] [MainThread]: Command `dbt run` failed at 14:39:55.720029 after 0.67 seconds
[0m14:39:55.720680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113424350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130ae090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fdf7d0>]}
[0m14:39:55.721051 [debug] [MainThread]: Flushing usage events
[0m17:26:08.211654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e302f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df94510>]}


============================== 17:26:08.278168 | 6a5d1709-6c3f-4179-9235-efe9437d53db ==============================
[0m17:26:08.278168 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:26:08.279026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:26:08.668561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a5d1709-6c3f-4179-9235-efe9437d53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e27ce50>]}
[0m17:26:08.690919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a5d1709-6c3f-4179-9235-efe9437d53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e34ed10>]}
[0m17:26:08.693639 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:26:08.792973 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:26:08.826895 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:26:08.827678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a5d1709-6c3f-4179-9235-efe9437d53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed38910>]}
[0m17:26:09.926797 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:26:09.956442 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m17:26:09.965836 [debug] [MainThread]: 1603: static parser failed on fact/fact_boarding_passes.sql
[0m17:26:09.972576 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_boarding_passes.sql
[0m17:26:09.976661 [debug] [MainThread]: 1699: static parser successfully parsed fact/fact_flights.sql
[0m17:26:09.990273 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_aircraft.sql
[0m17:26:09.998824 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_aircraft.sql
[0m17:26:10.000668 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_airport.sql
[0m17:26:10.007196 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_airport.sql
[0m17:26:10.150158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a5d1709-6c3f-4179-9235-efe9437d53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed8bb10>]}
[0m17:26:10.159606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a5d1709-6c3f-4179-9235-efe9437d53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee03210>]}
[0m17:26:10.160110 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:26:10.160512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a5d1709-6c3f-4179-9235-efe9437d53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecaffd0>]}
[0m17:26:10.164582 [info ] [MainThread]: 
[0m17:26:10.165868 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:26:10.167491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m17:26:10.181966 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m17:26:10.182604 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:26:10.182954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:10.615161 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_demo" does not exist

[0m17:26:10.649528 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:26:10.650173 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:26:10.650929 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m17:26:10.651360 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:26:10.651925 [debug] [ThreadPool]: On list_flights_demo: No close available on handle
[0m17:26:10.654226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:10.654733 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m17:26:10.655049 [info ] [MainThread]: 
[0m17:26:10.655543 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m17:26:10.656250 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_demo" does not exist
  
[0m17:26:10.657253 [debug] [MainThread]: Command `dbt run` failed at 17:26:10.657077 after 2.53 seconds
[0m17:26:10.657904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e285410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed353d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df82390>]}
[0m17:26:10.658477 [debug] [MainThread]: Flushing usage events
[0m17:28:16.992235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e57aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e3110>]}


============================== 17:28:17.036703 | 173dc42e-e007-4f3d-b9ec-736768739bbe ==============================
[0m17:28:17.036703 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:28:17.038415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/moranshorashi/.dbt', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:28:17.261506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '173dc42e-e007-4f3d-b9ec-736768739bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4abf90>]}
[0m17:28:17.289606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '173dc42e-e007-4f3d-b9ec-736768739bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4d47d0>]}
[0m17:28:17.291464 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:28:17.320511 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:28:17.471730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:28:17.473285 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/dim_airport.sql
[0m17:28:17.524333 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_airport.sql
[0m17:28:17.558063 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_airport.sql
[0m17:28:17.635824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '173dc42e-e007-4f3d-b9ec-736768739bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e3510>]}
[0m17:28:17.646288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '173dc42e-e007-4f3d-b9ec-736768739bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f376510>]}
[0m17:28:17.646857 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:28:17.647280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '173dc42e-e007-4f3d-b9ec-736768739bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c08d910>]}
[0m17:28:17.649978 [info ] [MainThread]: 
[0m17:28:17.652206 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:28:17.654503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m17:28:17.672704 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m17:28:17.673963 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:28:17.674533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:17.718246 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_demo" does not exist

[0m17:28:17.731477 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:28:17.732753 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:28:17.733228 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m17:28:17.733645 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:28:17.734139 [debug] [ThreadPool]: On list_flights_demo: No close available on handle
[0m17:28:17.736017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:17.736471 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m17:28:17.736857 [info ] [MainThread]: 
[0m17:28:17.737397 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m17:28:17.738109 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_demo" does not exist
  
[0m17:28:17.739047 [debug] [MainThread]: Command `dbt run` failed at 17:28:17.738871 after 0.79 seconds
[0m17:28:17.739625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab1410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a941890>]}
[0m17:28:17.740182 [debug] [MainThread]: Flushing usage events
[0m17:31:02.354190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dd1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e7a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dd0c50>]}


============================== 17:31:02.394690 | bc2e7d9a-1536-46cb-8ad7-c685b34afa98 ==============================
[0m17:31:02.394690 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:31:02.395807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'profiles_dir': '/Users/moranshorashi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:31:02.673461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e92f10>]}
[0m17:31:02.697551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e92f10>]}
[0m17:31:02.698627 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:31:02.755910 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:31:02.832071 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:31:02.834132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b7f510>]}
[0m17:31:03.766501 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:31:03.786845 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m17:31:03.792047 [debug] [MainThread]: 1603: static parser failed on fact/fact_boarding_passes.sql
[0m17:31:03.797949 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fact/fact_boarding_passes.sql
[0m17:31:03.800513 [debug] [MainThread]: 1699: static parser successfully parsed fact/fact_flights.sql
[0m17:31:03.806221 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_aircraft.sql
[0m17:31:03.813410 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_aircraft.sql
[0m17:31:03.816332 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_airport.sql
[0m17:31:03.822548 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_airport.sql
[0m17:31:03.983966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b82010>]}
[0m17:31:03.997626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ca3d0>]}
[0m17:31:03.998205 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:31:03.998609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbe1750>]}
[0m17:31:04.001190 [info ] [MainThread]: 
[0m17:31:04.002113 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:31:04.003787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m17:31:04.021766 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m17:31:04.022718 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:31:04.023366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:04.198326 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:31:04.201054 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m17:31:04.202538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now create_flights_dbt_course_flights_wh)
[0m17:31:04.203818 [debug] [ThreadPool]: Creating schema "database: "flights_dbt_course"
schema: "flights_wh"
"
[0m17:31:04.211941 [debug] [ThreadPool]: Using postgres connection "create_flights_dbt_course_flights_wh"
[0m17:31:04.212577 [debug] [ThreadPool]: On create_flights_dbt_course_flights_wh: BEGIN
[0m17:31:04.212918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:04.226546 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:31:04.226954 [debug] [ThreadPool]: Using postgres connection "create_flights_dbt_course_flights_wh"
[0m17:31:04.227247 [debug] [ThreadPool]: On create_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "create_flights_dbt_course_flights_wh"} */
create schema if not exists "flights_wh"
[0m17:31:04.280526 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:31:04.281782 [debug] [ThreadPool]: On create_flights_dbt_course_flights_wh: COMMIT
[0m17:31:04.282408 [debug] [ThreadPool]: Using postgres connection "create_flights_dbt_course_flights_wh"
[0m17:31:04.282809 [debug] [ThreadPool]: On create_flights_dbt_course_flights_wh: COMMIT
[0m17:31:04.285457 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:31:04.285846 [debug] [ThreadPool]: On create_flights_dbt_course_flights_wh: Close
[0m17:31:04.288117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_flights_dbt_course_flights_wh, now list_flights_dbt_course_flights_wh)
[0m17:31:04.294282 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:31:04.294668 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m17:31:04.295115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:04.306978 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:31:04.307418 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:31:04.307964 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:31:04.352561 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:31:04.354005 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m17:31:04.354710 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m17:31:04.359609 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:04.359960 [debug] [MainThread]: On master: BEGIN
[0m17:31:04.360216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:04.372799 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:31:04.373468 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:04.374018 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:31:04.407905 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m17:31:04.410439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b72d0>]}
[0m17:31:04.411033 [debug] [MainThread]: On master: ROLLBACK
[0m17:31:04.411833 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:04.412391 [debug] [MainThread]: On master: BEGIN
[0m17:31:04.413400 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:31:04.413864 [debug] [MainThread]: On master: COMMIT
[0m17:31:04.414318 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:04.414644 [debug] [MainThread]: On master: COMMIT
[0m17:31:04.415441 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:31:04.415931 [debug] [MainThread]: On master: Close
[0m17:31:04.416837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:04.417313 [info ] [MainThread]: 
[0m17:31:04.448962 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m17:31:04.450026 [info ] [Thread-1 (]: 1 of 5 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m17:31:04.451130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m17:31:04.451614 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m17:31:04.454482 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m17:31:04.455718 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 17:31:04.451875 => 17:31:04.455428
[0m17:31:04.456268 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m17:31:04.527284 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m17:31:04.528883 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m17:31:04.529462 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m17:31:04.530050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:04.542468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:31:04.543060 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m17:31:04.543582 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select *,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 14:31:02' as dbt_time
from aircrafts_data as ad 
inner join seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m17:31:04.586395 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "aircrafts_data" does not exist
LINE 19: from aircrafts_data as ad 
              ^

[0m17:31:04.586904 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: ROLLBACK
[0m17:31:04.587624 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 17:31:04.456565 => 17:31:04.587391
[0m17:31:04.588307 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m17:31:04.660000 [debug] [Thread-1 (]: Database Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)
  relation "aircrafts_data" does not exist
  LINE 19: from aircrafts_data as ad 
                ^
  compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m17:31:04.661368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b468d0>]}
[0m17:31:04.679647 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model flights_wh.dim_aircraft .................. [[31mERROR[0m in 0.21s]
[0m17:31:04.680734 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m17:31:04.681561 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m17:31:04.682767 [info ] [Thread-1 (]: 2 of 5 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m17:31:04.684531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m17:31:04.685510 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m17:31:04.688860 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m17:31:04.690149 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 17:31:04.685864 => 17:31:04.689797
[0m17:31:04.690608 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m17:31:04.698534 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m17:31:04.700091 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m17:31:04.700720 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m17:31:04.701039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:04.718899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:31:04.719458 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m17:31:04.719923 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   '2023-08-16 14:31:02' as dbt_time
from airports_data
  );
  
[0m17:31:04.722388 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airports_data" does not exist
LINE 16: from airports_data
              ^

[0m17:31:04.722921 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: ROLLBACK
[0m17:31:04.723526 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 17:31:04.690884 => 17:31:04.723325
[0m17:31:04.723857 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m17:31:04.726378 [debug] [Thread-1 (]: Database Error in model dim_airport (models/dimensions/dim_airport.sql)
  relation "airports_data" does not exist
  LINE 16: from airports_data
                ^
  compiled Code at target/run/flights_dbt/models/dimensions/dim_airport.sql
[0m17:31:04.726799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112caea10>]}
[0m17:31:04.727554 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model flights_wh.dim_airport ................... [[31mERROR[0m in 0.04s]
[0m17:31:04.729612 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m17:31:04.730659 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m17:31:04.731468 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m17:31:04.732990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m17:31:04.733937 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m17:31:04.738744 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m17:31:04.740414 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 17:31:04.734587 => 17:31:04.740112
[0m17:31:04.740836 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m17:31:04.746077 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m17:31:04.747136 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m17:31:04.747669 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m17:31:04.748089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:04.763418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:31:04.763876 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m17:31:04.764664 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select *,
 '2023-08-16 14:31:02' as dbt_time
 from boarding_passes as bp
 inner join ticket_flights as tf on bp.flight_id =tf.flight_id
  );
  
[0m17:31:04.766651 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "boarding_passes" does not exist
LINE 14:  from boarding_passes as bp
               ^

[0m17:31:04.767208 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: ROLLBACK
[0m17:31:04.768119 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 17:31:04.741186 => 17:31:04.767848
[0m17:31:04.768641 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m17:31:04.771805 [debug] [Thread-1 (]: Database Error in model fact_boarding_passes (models/fact/fact_boarding_passes.sql)
  relation "boarding_passes" does not exist
  LINE 14:  from boarding_passes as bp
                 ^
  compiled Code at target/run/flights_dbt/models/fact/fact_boarding_passes.sql
[0m17:31:04.772468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c4de50>]}
[0m17:31:04.773068 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model flights_wh.fact_boarding_passes .......... [[31mERROR[0m in 0.04s]
[0m17:31:04.773601 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m17:31:04.774205 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m17:31:04.775054 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m17:31:04.775952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.my_first_dbt_model)
[0m17:31:04.776417 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m17:31:04.779902 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m17:31:04.781213 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 17:31:04.776658 => 17:31:04.780780
[0m17:31:04.781814 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m17:31:04.786732 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m17:31:04.787993 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:31:04.788594 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m17:31:04.789056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:04.803204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:31:04.803992 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:31:04.804939 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:31:04.851354 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m17:31:04.857701 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:31:04.858192 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:31:04.860569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:31:04.891517 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m17:31:04.892090 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:31:04.892460 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m17:31:04.893647 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:31:04.901331 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:31:04.902003 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:31:04.903981 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:31:04.905985 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 17:31:04.782329 => 17:31:04.905774
[0m17:31:04.906595 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m17:31:04.907439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c8bd50>]}
[0m17:31:04.909641 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.13s]
[0m17:31:04.910858 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m17:31:04.913193 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m17:31:04.914201 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:31:04.915417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m17:31:04.916189 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m17:31:04.920169 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m17:31:04.921478 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 17:31:04.916568 => 17:31:04.921141
[0m17:31:04.921909 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m17:31:04.951654 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m17:31:04.953366 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:31:04.954398 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m17:31:04.954931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:04.968746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:31:04.969308 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:31:04.969842 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:31:05.003314 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:31:05.008622 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:31:05.010495 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:31:05.011895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:31:05.014640 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m17:31:05.015272 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:31:05.015964 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m17:31:05.017380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:31:05.021408 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:31:05.022110 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:31:05.024032 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:31:05.026370 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 17:31:04.922139 => 17:31:05.026109
[0m17:31:05.026943 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m17:31:05.027929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2e7d9a-1536-46cb-8ad7-c685b34afa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d2aa50>]}
[0m17:31:05.028985 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.11s]
[0m17:31:05.030494 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m17:31:05.033710 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:05.034502 [debug] [MainThread]: On master: BEGIN
[0m17:31:05.034914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:31:05.048595 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:31:05.049228 [debug] [MainThread]: On master: COMMIT
[0m17:31:05.049798 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:05.050247 [debug] [MainThread]: On master: COMMIT
[0m17:31:05.050807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:31:05.051276 [debug] [MainThread]: On master: Close
[0m17:31:05.052118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:05.052454 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m17:31:05.052783 [info ] [MainThread]: 
[0m17:31:05.053230 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m17:31:05.055559 [debug] [MainThread]: Command end result
[0m17:31:05.067591 [info ] [MainThread]: 
[0m17:31:05.068432 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:31:05.070216 [info ] [MainThread]: 
[0m17:31:05.071018 [error] [MainThread]: [33mDatabase Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)[0m
[0m17:31:05.071683 [error] [MainThread]:   relation "aircrafts_data" does not exist
[0m17:31:05.072260 [error] [MainThread]:   LINE 19: from aircrafts_data as ad 
[0m17:31:05.072734 [error] [MainThread]:                 ^
[0m17:31:05.073679 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m17:31:05.074255 [info ] [MainThread]: 
[0m17:31:05.074870 [error] [MainThread]: [33mDatabase Error in model dim_airport (models/dimensions/dim_airport.sql)[0m
[0m17:31:05.075299 [error] [MainThread]:   relation "airports_data" does not exist
[0m17:31:05.075745 [error] [MainThread]:   LINE 16: from airports_data
[0m17:31:05.076339 [error] [MainThread]:                 ^
[0m17:31:05.077918 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_airport.sql
[0m17:31:05.078454 [info ] [MainThread]: 
[0m17:31:05.078899 [error] [MainThread]: [33mDatabase Error in model fact_boarding_passes (models/fact/fact_boarding_passes.sql)[0m
[0m17:31:05.079439 [error] [MainThread]:   relation "boarding_passes" does not exist
[0m17:31:05.080249 [error] [MainThread]:   LINE 14:  from boarding_passes as bp
[0m17:31:05.081248 [error] [MainThread]:                  ^
[0m17:31:05.081732 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/fact/fact_boarding_passes.sql
[0m17:31:05.083296 [info ] [MainThread]: 
[0m17:31:05.083981 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m17:31:05.084956 [debug] [MainThread]: Command `dbt run` failed at 17:31:05.084738 after 2.79 seconds
[0m17:31:05.085634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e336c50>]}
[0m17:31:05.086290 [debug] [MainThread]: Flushing usage events
[0m18:25:24.110237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dced910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc3bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db8f450>]}


============================== 18:25:24.143227 | 435e372e-66a1-4d3f-a834-97892f5974f4 ==============================
[0m18:25:24.143227 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:25:24.143923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:25:24.404770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '435e372e-66a1-4d3f-a834-97892f5974f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db8f450>]}
[0m18:25:24.424437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '435e372e-66a1-4d3f-a834-97892f5974f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc69190>]}
[0m18:25:24.425550 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:25:24.472283 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:25:24.565467 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:25:24.566041 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:25:24.566545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '435e372e-66a1-4d3f-a834-97892f5974f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a359ad0>]}
[0m18:25:25.366626 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m18:25:25.384036 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m18:25:25.389086 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_aircraft.sql
[0m18:25:25.393756 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_aircraft.sql
[0m18:25:25.395730 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_airport.sql
[0m18:25:25.400348 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_airport.sql
[0m18:25:25.402890 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m18:25:25.408411 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m18:25:25.410999 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_flights.sql
[0m18:25:25.517847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '435e372e-66a1-4d3f-a834-97892f5974f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfbe8d0>]}
[0m18:25:25.547408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '435e372e-66a1-4d3f-a834-97892f5974f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df3de10>]}
[0m18:25:25.548019 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:25:25.548524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435e372e-66a1-4d3f-a834-97892f5974f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7f1890>]}
[0m18:25:25.552162 [info ] [MainThread]: 
[0m18:25:25.553599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:25:25.555802 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:25:25.572575 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:25:25.573161 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:25:25.573958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:25.702007 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_demo" does not exist

[0m18:25:25.712662 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:25:25.713201 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m18:25:25.713830 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m18:25:25.714505 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m18:25:25.715191 [debug] [ThreadPool]: On list_flights_demo: No close available on handle
[0m18:25:25.716847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:25.717406 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:25:25.717826 [info ] [MainThread]: 
[0m18:25:25.728986 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:25:25.729988 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_demo" does not exist
  
[0m18:25:25.731278 [debug] [MainThread]: Command `dbt run` failed at 18:25:25.730784 after 1.68 seconds
[0m18:25:25.731989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10def3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e211550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d812990>]}
[0m18:25:25.732565 [debug] [MainThread]: Flushing usage events
[0m18:32:00.832969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae45bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad97d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ada8cd0>]}


============================== 18:32:00.880070 | caae3caa-2cdd-4ca0-8b7b-d7317592b128 ==============================
[0m18:32:00.880070 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:32:00.881164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:32:01.118904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caae3caa-2cdd-4ca0-8b7b-d7317592b128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14f0d0>]}
[0m18:32:01.140649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caae3caa-2cdd-4ca0-8b7b-d7317592b128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14f0d0>]}
[0m18:32:01.141932 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:32:01.269633 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:32:01.438867 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:32:01.439476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'caae3caa-2cdd-4ca0-8b7b-d7317592b128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0931d0>]}
[0m18:32:02.205488 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m18:32:02.219785 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m18:32:02.225089 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_aircraft.sql
[0m18:32:02.232684 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_aircraft.sql
[0m18:32:02.234793 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_airport.sql
[0m18:32:02.240756 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_airport.sql
[0m18:32:02.242666 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m18:32:02.247948 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m18:32:02.249815 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_flights.sql
[0m18:32:02.356734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caae3caa-2cdd-4ca0-8b7b-d7317592b128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94f710>]}
[0m18:32:02.386870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caae3caa-2cdd-4ca0-8b7b-d7317592b128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba981d0>]}
[0m18:32:02.387632 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:32:02.388353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caae3caa-2cdd-4ca0-8b7b-d7317592b128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf13d0>]}
[0m18:32:02.391365 [info ] [MainThread]: 
[0m18:32:02.392481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:32:02.394588 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt course'
[0m18:32:02.408442 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt course"
[0m18:32:02.408934 [debug] [ThreadPool]: On list_flights_dbt course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt course"} */

    select distinct nspname from pg_namespace
  
[0m18:32:02.409247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:02.556650 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_dbt course" does not exist

[0m18:32:02.566895 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt course"} */

    select distinct nspname from pg_namespace
  
[0m18:32:02.567534 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m18:32:02.568116 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m18:32:02.568428 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m18:32:02.568773 [debug] [ThreadPool]: On list_flights_dbt course: No close available on handle
[0m18:32:02.570433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:02.570778 [debug] [MainThread]: Connection 'list_flights_dbt course' was properly closed.
[0m18:32:02.571118 [info ] [MainThread]: 
[0m18:32:02.585014 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m18:32:02.586560 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "flights_dbt course" does not exist
  
[0m18:32:02.588117 [debug] [MainThread]: Command `dbt run` failed at 18:32:02.587849 after 1.81 seconds
[0m18:32:02.588852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0aa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad82a50>]}
[0m18:32:02.589487 [debug] [MainThread]: Flushing usage events
[0m18:32:58.848164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e396f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e71e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e71e990>]}


============================== 18:32:58.961338 | b3d561e6-757c-4682-ac1d-c0aac7a7d51b ==============================
[0m18:32:58.961338 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:32:58.962133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:32:59.156855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0681d0>]}
[0m18:32:59.175882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e21c210>]}
[0m18:32:59.177144 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:32:59.226973 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:32:59.277787 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:32:59.278518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f158910>]}
[0m18:33:00.037389 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m18:33:00.054904 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m18:33:00.059127 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_aircraft.sql
[0m18:33:00.063482 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_aircraft.sql
[0m18:33:00.065608 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_airport.sql
[0m18:33:00.070951 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_airport.sql
[0m18:33:00.072835 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m18:33:00.078988 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m18:33:00.081617 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_flights.sql
[0m18:33:00.187639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3bbed0>]}
[0m18:33:00.210152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f08af90>]}
[0m18:33:00.210777 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:33:00.211509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2053d0>]}
[0m18:33:00.214437 [info ] [MainThread]: 
[0m18:33:00.215729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:00.217269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:33:00.230941 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:33:00.231518 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:33:00.231968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:00.467704 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:33:00.470006 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:33:00.472569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m18:33:00.479463 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:33:00.479851 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:33:00.480114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:00.491512 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:33:00.491880 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:33:00.492177 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:33:00.496829 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:33:00.498531 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:33:00.499250 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:33:00.505207 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:00.505672 [debug] [MainThread]: On master: BEGIN
[0m18:33:00.505998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:00.516384 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:00.517742 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:00.518134 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:00.540439 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:33:00.543097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f05a090>]}
[0m18:33:00.543726 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:00.544342 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:00.544662 [debug] [MainThread]: On master: BEGIN
[0m18:33:00.545387 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:00.545691 [debug] [MainThread]: On master: COMMIT
[0m18:33:00.545965 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:00.546253 [debug] [MainThread]: On master: COMMIT
[0m18:33:00.546662 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:00.546968 [debug] [MainThread]: On master: Close
[0m18:33:00.547676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:00.548689 [info ] [MainThread]: 
[0m18:33:00.577414 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m18:33:00.578163 [info ] [Thread-1 (]: 1 of 5 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m18:33:00.579235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m18:33:00.579782 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m18:33:00.583028 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m18:33:00.585832 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 18:33:00.580036 => 18:33:00.585211
[0m18:33:00.586623 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m18:33:00.641076 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m18:33:00.642550 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:33:00.642988 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m18:33:00.643322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:00.655000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:00.655402 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:33:00.655747 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select *,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 15:32:58' as dbt_time
from aircrafts_data as ad 
inner join seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m18:33:00.656660 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "aircrafts_data" does not exist
LINE 19: from aircrafts_data as ad 
              ^

[0m18:33:00.657021 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: ROLLBACK
[0m18:33:00.657903 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 18:33:00.587044 => 18:33:00.657633
[0m18:33:00.658774 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m18:33:00.721350 [debug] [Thread-1 (]: Database Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)
  relation "aircrafts_data" does not exist
  LINE 19: from aircrafts_data as ad 
                ^
  compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:33:00.721851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f123110>]}
[0m18:33:00.722534 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model flights_wh.dim_aircraft .................. [[31mERROR[0m in 0.14s]
[0m18:33:00.723112 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m18:33:00.723663 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m18:33:00.724668 [info ] [Thread-1 (]: 2 of 5 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m18:33:00.725846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m18:33:00.726303 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m18:33:00.729577 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m18:33:00.730576 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 18:33:00.726536 => 18:33:00.730310
[0m18:33:00.730923 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m18:33:00.736479 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m18:33:00.737478 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m18:33:00.738214 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m18:33:00.738897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:00.761369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:00.761817 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m18:33:00.762253 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 15:32:58' as dbt_time
from airports_data
  );
  
[0m18:33:00.765124 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airports_data" does not exist
LINE 18: from airports_data
              ^

[0m18:33:00.766046 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: ROLLBACK
[0m18:33:00.767374 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 18:33:00.731141 => 18:33:00.766911
[0m18:33:00.767900 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m18:33:00.774941 [debug] [Thread-1 (]: Database Error in model dim_airport (models/dimensions/dim_airport.sql)
  relation "airports_data" does not exist
  LINE 18: from airports_data
                ^
  compiled Code at target/run/flights_dbt/models/dimensions/dim_airport.sql
[0m18:33:00.775655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f280a50>]}
[0m18:33:00.776395 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model flights_wh.dim_airport ................... [[31mERROR[0m in 0.05s]
[0m18:33:00.777036 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m18:33:00.777792 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m18:33:00.778609 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m18:33:00.779531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m18:33:00.780027 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m18:33:00.783344 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m18:33:00.791944 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 18:33:00.780422 => 18:33:00.791523
[0m18:33:00.792480 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m18:33:00.798038 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m18:33:00.799965 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m18:33:00.800659 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m18:33:00.801399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:00.812634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:00.813204 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m18:33:00.813845 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select *,
 '2023-08-16 15:32:58' as dbt_time
 from boarding_passes as bp
 inner join ticket_flights as tf on bp.flight_id =tf.flight_id
  );
  
[0m18:33:00.816621 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "boarding_passes" does not exist
LINE 14:  from boarding_passes as bp
               ^

[0m18:33:00.817483 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: ROLLBACK
[0m18:33:00.818284 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 18:33:00.792923 => 18:33:00.818038
[0m18:33:00.819365 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m18:33:00.821983 [debug] [Thread-1 (]: Database Error in model fact_boarding_passes (models/facts/fact_boarding_passes.sql)
  relation "boarding_passes" does not exist
  LINE 14:  from boarding_passes as bp
                 ^
  compiled Code at target/run/flights_dbt/models/facts/fact_boarding_passes.sql
[0m18:33:00.822419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f279690>]}
[0m18:33:00.822967 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model flights_wh.fact_boarding_passes .......... [[31mERROR[0m in 0.04s]
[0m18:33:00.823452 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m18:33:00.824500 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:33:00.825146 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:33:00.826559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.my_first_dbt_model)
[0m18:33:00.827000 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:33:00.833327 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:33:00.835514 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:33:00.827245 => 18:33:00.835014
[0m18:33:00.836541 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:33:00.843514 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:33:00.844278 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:00.844671 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:33:00.845000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:00.857485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:00.857903 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:00.858259 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:33:00.929210 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:33:00.937605 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:00.938145 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:33:00.939592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:33:00.943146 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:00.943617 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:33:00.944612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:33:00.968471 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:33:00.969343 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:00.970027 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:33:00.973705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:33:00.980145 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:00.980735 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:33:01.012914 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:33:01.014548 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:33:00.837612 => 18:33:01.014340
[0m18:33:01.014920 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:33:01.015870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a7290>]}
[0m18:33:01.016747 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.19s]
[0m18:33:01.017791 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:33:01.032540 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:33:01.033506 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:33:01.035214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:33:01.036035 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:33:01.039988 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:33:01.041470 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:33:01.036837 => 18:33:01.040991
[0m18:33:01.041996 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:33:01.070476 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:33:01.071555 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:33:01.072120 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:33:01.072674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:01.096108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:01.096822 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:33:01.097535 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:33:01.104957 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:33:01.108473 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:33:01.110136 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:33:01.111688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:33:01.114325 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:33:01.114819 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:33:01.115207 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:33:01.116572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:33:01.119645 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:33:01.120165 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:33:01.120878 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:33:01.122460 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:33:01.042262 => 18:33:01.122229
[0m18:33:01.122854 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:33:01.123635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d561e6-757c-4682-ac1d-c0aac7a7d51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f190a10>]}
[0m18:33:01.124571 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m18:33:01.125748 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:33:01.127483 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:01.127914 [debug] [MainThread]: On master: BEGIN
[0m18:33:01.128240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:01.140604 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:01.141112 [debug] [MainThread]: On master: COMMIT
[0m18:33:01.141515 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:01.141857 [debug] [MainThread]: On master: COMMIT
[0m18:33:01.142429 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:01.142855 [debug] [MainThread]: On master: Close
[0m18:33:01.143597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:01.143962 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:33:01.144341 [info ] [MainThread]: 
[0m18:33:01.144782 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m18:33:01.146090 [debug] [MainThread]: Command end result
[0m18:33:01.157884 [info ] [MainThread]: 
[0m18:33:01.158872 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:33:01.159372 [info ] [MainThread]: 
[0m18:33:01.160027 [error] [MainThread]: [33mDatabase Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)[0m
[0m18:33:01.160701 [error] [MainThread]:   relation "aircrafts_data" does not exist
[0m18:33:01.161654 [error] [MainThread]:   LINE 19: from aircrafts_data as ad 
[0m18:33:01.162223 [error] [MainThread]:                 ^
[0m18:33:01.162863 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:33:01.163718 [info ] [MainThread]: 
[0m18:33:01.165070 [error] [MainThread]: [33mDatabase Error in model dim_airport (models/dimensions/dim_airport.sql)[0m
[0m18:33:01.167424 [error] [MainThread]:   relation "airports_data" does not exist
[0m18:33:01.170691 [error] [MainThread]:   LINE 18: from airports_data
[0m18:33:01.171725 [error] [MainThread]:                 ^
[0m18:33:01.172977 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_airport.sql
[0m18:33:01.174041 [info ] [MainThread]: 
[0m18:33:01.175186 [error] [MainThread]: [33mDatabase Error in model fact_boarding_passes (models/facts/fact_boarding_passes.sql)[0m
[0m18:33:01.176239 [error] [MainThread]:   relation "boarding_passes" does not exist
[0m18:33:01.177544 [error] [MainThread]:   LINE 14:  from boarding_passes as bp
[0m18:33:01.178687 [error] [MainThread]:                  ^
[0m18:33:01.179444 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/facts/fact_boarding_passes.sql
[0m18:33:01.180992 [info ] [MainThread]: 
[0m18:33:01.183201 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m18:33:01.184774 [debug] [MainThread]: Command `dbt run` failed at 18:33:01.184540 after 2.38 seconds
[0m18:33:01.185596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e76c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1ec350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e993c10>]}
[0m18:33:01.186095 [debug] [MainThread]: Flushing usage events
[0m18:35:05.878713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133aedd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136943d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113694990>]}


============================== 18:35:05.933864 | 75d8a34d-55ad-4b7a-87f6-36e44dbbd21b ==============================
[0m18:35:05.933864 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:35:05.934708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/moranshorashi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:35:06.151198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e02d0>]}
[0m18:35:06.169652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e02d0>]}
[0m18:35:06.172486 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:35:06.260687 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:35:06.377297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:06.377687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:06.387992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114167250>]}
[0m18:35:06.427408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113447250>]}
[0m18:35:06.428086 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:35:06.428772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11121d3d0>]}
[0m18:35:06.432879 [info ] [MainThread]: 
[0m18:35:06.434026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:06.435642 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:35:06.452263 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:35:06.452797 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:35:06.453177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:06.664728 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:35:06.666692 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:35:06.669601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m18:35:06.676035 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:35:06.676408 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:35:06.676672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:06.685550 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:35:06.685916 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:35:06.686213 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:35:06.690815 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:35:06.692196 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:35:06.692851 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:35:06.699871 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:06.700399 [debug] [MainThread]: On master: BEGIN
[0m18:35:06.700703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:06.712551 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:06.713016 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:06.713418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:06.737106 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:35:06.739161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113694950>]}
[0m18:35:06.740091 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:06.740720 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:06.741082 [debug] [MainThread]: On master: BEGIN
[0m18:35:06.742160 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:06.742822 [debug] [MainThread]: On master: COMMIT
[0m18:35:06.743176 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:06.743502 [debug] [MainThread]: On master: COMMIT
[0m18:35:06.744230 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:06.744728 [debug] [MainThread]: On master: Close
[0m18:35:06.745448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:06.745876 [info ] [MainThread]: 
[0m18:35:06.771040 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m18:35:06.771992 [info ] [Thread-1 (]: 1 of 5 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m18:35:06.773284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m18:35:06.774114 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m18:35:06.778152 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m18:35:06.780269 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 18:35:06.774729 => 18:35:06.779562
[0m18:35:06.781015 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m18:35:06.836458 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m18:35:06.837246 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:35:06.837856 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m18:35:06.838466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:06.850631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:06.851145 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:35:06.851567 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select *,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 15:35:05' as dbt_time
from aircrafts_data as ad 
inner join seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m18:35:06.852458 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "aircrafts_data" does not exist
LINE 19: from aircrafts_data as ad 
              ^

[0m18:35:06.853132 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: ROLLBACK
[0m18:35:06.853827 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 18:35:06.781416 => 18:35:06.853616
[0m18:35:06.854208 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m18:35:06.927861 [debug] [Thread-1 (]: Database Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)
  relation "aircrafts_data" does not exist
  LINE 19: from aircrafts_data as ad 
                ^
  compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:35:06.928746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140fc250>]}
[0m18:35:06.929967 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model flights_wh.dim_aircraft .................. [[31mERROR[0m in 0.16s]
[0m18:35:06.930969 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m18:35:06.931577 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m18:35:06.932491 [info ] [Thread-1 (]: 2 of 5 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m18:35:06.933518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m18:35:06.934008 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m18:35:06.937026 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m18:35:06.938245 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 18:35:06.934333 => 18:35:06.937874
[0m18:35:06.939386 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m18:35:06.944488 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m18:35:06.945910 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m18:35:06.946844 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m18:35:06.947544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:06.961961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:06.962969 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m18:35:06.963785 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 15:35:05' as dbt_time
from airports_data
  );
  
[0m18:35:06.965301 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airports_data" does not exist
LINE 18: from airports_data
              ^

[0m18:35:06.965925 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: ROLLBACK
[0m18:35:06.966717 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 18:35:06.939739 => 18:35:06.966494
[0m18:35:06.967066 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m18:35:06.970617 [debug] [Thread-1 (]: Database Error in model dim_airport (models/dimensions/dim_airport.sql)
  relation "airports_data" does not exist
  LINE 18: from airports_data
                ^
  compiled Code at target/run/flights_dbt/models/dimensions/dim_airport.sql
[0m18:35:06.971325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11406f350>]}
[0m18:35:06.972286 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model flights_wh.dim_airport ................... [[31mERROR[0m in 0.04s]
[0m18:35:06.973191 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m18:35:06.974192 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m18:35:06.975281 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m18:35:06.976128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m18:35:06.976534 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m18:35:06.979009 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m18:35:06.980872 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 18:35:06.976762 => 18:35:06.980632
[0m18:35:06.981219 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m18:35:06.985399 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m18:35:06.986371 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m18:35:06.986865 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m18:35:06.987259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:07.000169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:07.000673 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m18:35:07.001131 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select *,
 '2023-08-16 15:35:05' as dbt_time
 from boarding_passes as bp
 inner join ticket_flights as tf on bp.flight_id =tf.flight_id
  );
  
[0m18:35:07.002471 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "boarding_passes" does not exist
LINE 14:  from boarding_passes as bp
               ^

[0m18:35:07.003002 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: ROLLBACK
[0m18:35:07.003911 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 18:35:06.981518 => 18:35:07.003628
[0m18:35:07.004525 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m18:35:07.007904 [debug] [Thread-1 (]: Database Error in model fact_boarding_passes (models/facts/fact_boarding_passes.sql)
  relation "boarding_passes" does not exist
  LINE 14:  from boarding_passes as bp
                 ^
  compiled Code at target/run/flights_dbt/models/facts/fact_boarding_passes.sql
[0m18:35:07.008545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114221650>]}
[0m18:35:07.009452 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model flights_wh.fact_boarding_passes .......... [[31mERROR[0m in 0.03s]
[0m18:35:07.010117 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m18:35:07.010673 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:35:07.011193 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:35:07.011967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.my_first_dbt_model)
[0m18:35:07.012345 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:35:07.015029 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:35:07.015865 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:35:07.012587 => 18:35:07.015583
[0m18:35:07.016312 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:35:07.021446 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:35:07.022420 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:07.022952 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:35:07.023654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:07.039679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:07.040461 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:07.041169 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:35:07.127241 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:35:07.136427 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:07.136859 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:35:07.138161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:07.143069 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:07.143489 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:35:07.144370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:07.170793 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:35:07.171512 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:07.171879 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:35:07.173424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:07.178266 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:07.178891 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:35:07.184050 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:35:07.185558 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:35:07.016537 => 18:35:07.185351
[0m18:35:07.185902 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:35:07.186724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142c89d0>]}
[0m18:35:07.187319 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.18s]
[0m18:35:07.188131 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:35:07.190059 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:35:07.190851 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:35:07.192028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:35:07.192655 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:35:07.196053 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:35:07.197388 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:35:07.192979 => 18:35:07.196904
[0m18:35:07.197987 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:35:07.222040 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:35:07.223019 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:07.223801 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:35:07.224765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:07.240708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:07.241698 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:07.242445 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:35:07.264308 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:07.267262 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:07.267649 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:35:07.268687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:07.271966 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:35:07.272899 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:07.273550 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:35:07.274951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:07.277198 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:07.277556 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:35:07.278097 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:07.279652 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:35:07.198406 => 18:35:07.279451
[0m18:35:07.280231 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:35:07.281149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d8a34d-55ad-4b7a-87f6-36e44dbbd21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140d57d0>]}
[0m18:35:07.281754 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m18:35:07.282389 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:35:07.284081 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:07.284435 [debug] [MainThread]: On master: BEGIN
[0m18:35:07.284710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:07.298076 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:07.298663 [debug] [MainThread]: On master: COMMIT
[0m18:35:07.298996 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:07.299256 [debug] [MainThread]: On master: COMMIT
[0m18:35:07.299707 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:07.300007 [debug] [MainThread]: On master: Close
[0m18:35:07.300827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:07.301310 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:35:07.301838 [info ] [MainThread]: 
[0m18:35:07.302370 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m18:35:07.303707 [debug] [MainThread]: Command end result
[0m18:35:07.312589 [info ] [MainThread]: 
[0m18:35:07.313561 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:35:07.314597 [info ] [MainThread]: 
[0m18:35:07.315046 [error] [MainThread]: [33mDatabase Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)[0m
[0m18:35:07.315585 [error] [MainThread]:   relation "aircrafts_data" does not exist
[0m18:35:07.316139 [error] [MainThread]:   LINE 19: from aircrafts_data as ad 
[0m18:35:07.316698 [error] [MainThread]:                 ^
[0m18:35:07.317143 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:35:07.317611 [info ] [MainThread]: 
[0m18:35:07.318192 [error] [MainThread]: [33mDatabase Error in model dim_airport (models/dimensions/dim_airport.sql)[0m
[0m18:35:07.318935 [error] [MainThread]:   relation "airports_data" does not exist
[0m18:35:07.319854 [error] [MainThread]:   LINE 18: from airports_data
[0m18:35:07.320250 [error] [MainThread]:                 ^
[0m18:35:07.323814 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_airport.sql
[0m18:35:07.326964 [info ] [MainThread]: 
[0m18:35:07.332183 [error] [MainThread]: [33mDatabase Error in model fact_boarding_passes (models/facts/fact_boarding_passes.sql)[0m
[0m18:35:07.333381 [error] [MainThread]:   relation "boarding_passes" does not exist
[0m18:35:07.334230 [error] [MainThread]:   LINE 14:  from boarding_passes as bp
[0m18:35:07.334916 [error] [MainThread]:                  ^
[0m18:35:07.335476 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/facts/fact_boarding_passes.sql
[0m18:35:07.336618 [info ] [MainThread]: 
[0m18:35:07.338086 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m18:35:07.340250 [debug] [MainThread]: Command `dbt run` failed at 18:35:07.340083 after 1.49 seconds
[0m18:35:07.343161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120787d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113994c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113994b10>]}
[0m18:35:07.344125 [debug] [MainThread]: Flushing usage events
[0m18:38:29.011568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0dc990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2b4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de23c10>]}


============================== 18:38:29.051065 | 6ce4afb2-7bee-4fac-92ec-08eaac4412ef ==============================
[0m18:38:29.051065 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:38:29.052084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:38:29.232748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de11550>]}
[0m18:38:29.251913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddfee10>]}
[0m18:38:29.254531 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:38:29.293399 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:38:29.377827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:29.378533 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/schema.yml
[0m18:38:29.449156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eace550>]}
[0m18:38:29.459358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e111e10>]}
[0m18:38:29.460329 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:38:29.461102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc6d3d0>]}
[0m18:38:29.464273 [info ] [MainThread]: 
[0m18:38:29.465451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:38:29.467097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:38:29.480271 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:38:29.480858 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:38:29.481314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:29.578419 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:38:29.580081 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:38:29.581834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m18:38:29.587840 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:38:29.588263 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:38:29.588726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:29.599444 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:38:29.599853 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:38:29.600213 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:38:29.606309 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:38:29.607741 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:38:29.608367 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:38:29.614572 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:29.615482 [debug] [MainThread]: On master: BEGIN
[0m18:38:29.615994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:29.629766 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:38:29.630153 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:29.630523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:38:29.653443 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:38:29.655235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd434d0>]}
[0m18:38:29.655684 [debug] [MainThread]: On master: ROLLBACK
[0m18:38:29.656102 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:29.656374 [debug] [MainThread]: On master: BEGIN
[0m18:38:29.656908 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:38:29.657208 [debug] [MainThread]: On master: COMMIT
[0m18:38:29.657849 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:29.658283 [debug] [MainThread]: On master: COMMIT
[0m18:38:29.659154 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:38:29.659913 [debug] [MainThread]: On master: Close
[0m18:38:29.661251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:29.661731 [info ] [MainThread]: 
[0m18:38:29.686133 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m18:38:29.686811 [info ] [Thread-1 (]: 1 of 5 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m18:38:29.688071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m18:38:29.688954 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m18:38:29.692937 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m18:38:29.694858 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 18:38:29.689446 => 18:38:29.694307
[0m18:38:29.695506 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m18:38:29.742223 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m18:38:29.743429 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:38:29.743864 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m18:38:29.744192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:29.756146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:38:29.756554 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:38:29.756900 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select *,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 15:38:28' as dbt_time
from aircrafts_data as ad 
inner join seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m18:38:29.758256 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "aircrafts_data" does not exist
LINE 19: from aircrafts_data as ad 
              ^

[0m18:38:29.758993 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: ROLLBACK
[0m18:38:29.760243 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 18:38:29.695824 => 18:38:29.759890
[0m18:38:29.760866 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m18:38:29.830386 [debug] [Thread-1 (]: Database Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)
  relation "aircrafts_data" does not exist
  LINE 19: from aircrafts_data as ad 
                ^
  compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:38:29.830970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb524d0>]}
[0m18:38:29.831571 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model flights_wh.dim_aircraft .................. [[31mERROR[0m in 0.14s]
[0m18:38:29.832093 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m18:38:29.832735 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m18:38:29.833346 [info ] [Thread-1 (]: 2 of 5 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m18:38:29.834364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m18:38:29.834899 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m18:38:29.837975 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m18:38:29.839352 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 18:38:29.835184 => 18:38:29.838833
[0m18:38:29.839873 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m18:38:29.846017 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m18:38:29.847284 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m18:38:29.848190 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m18:38:29.848693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:29.863975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:38:29.864513 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m18:38:29.864864 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 15:38:28' as dbt_time
from airports_data
  );
  
[0m18:38:29.865673 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airports_data" does not exist
LINE 18: from airports_data
              ^

[0m18:38:29.866017 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: ROLLBACK
[0m18:38:29.866604 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 18:38:29.840236 => 18:38:29.866394
[0m18:38:29.866936 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m18:38:29.871114 [debug] [Thread-1 (]: Database Error in model dim_airport (models/dimensions/dim_airport.sql)
  relation "airports_data" does not exist
  LINE 18: from airports_data
                ^
  compiled Code at target/run/flights_dbt/models/dimensions/dim_airport.sql
[0m18:38:29.871645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ec2d0>]}
[0m18:38:29.872168 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model flights_wh.dim_airport ................... [[31mERROR[0m in 0.04s]
[0m18:38:29.872733 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m18:38:29.873208 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m18:38:29.873734 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m18:38:29.874494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m18:38:29.874984 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m18:38:29.878510 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m18:38:29.879933 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 18:38:29.875231 => 18:38:29.879509
[0m18:38:29.880516 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m18:38:29.886863 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m18:38:29.888251 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m18:38:29.889200 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m18:38:29.889979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:29.901892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:38:29.902373 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m18:38:29.902738 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select *,
 '2023-08-16 15:38:28' as dbt_time
 from boarding_passes as bp
 inner join ticket_flights as tf on bp.flight_id =tf.flight_id
  );
  
[0m18:38:29.904097 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "boarding_passes" does not exist
LINE 14:  from boarding_passes as bp
               ^

[0m18:38:29.904646 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: ROLLBACK
[0m18:38:29.905323 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 18:38:29.880871 => 18:38:29.905108
[0m18:38:29.905748 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m18:38:29.908454 [debug] [Thread-1 (]: Database Error in model fact_boarding_passes (models/facts/fact_boarding_passes.sql)
  relation "boarding_passes" does not exist
  LINE 14:  from boarding_passes as bp
                 ^
  compiled Code at target/run/flights_dbt/models/facts/fact_boarding_passes.sql
[0m18:38:29.909938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec84750>]}
[0m18:38:29.911122 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model flights_wh.fact_boarding_passes .......... [[31mERROR[0m in 0.04s]
[0m18:38:29.912096 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m18:38:29.913006 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:38:29.913828 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:38:29.915376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.my_first_dbt_model)
[0m18:38:29.915876 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:38:29.919611 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:38:29.921281 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:38:29.916140 => 18:38:29.920852
[0m18:38:29.921840 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:38:29.927836 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:38:29.929072 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:38:29.929762 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:38:29.930318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:29.941332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:38:29.941755 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:38:29.942224 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:38:29.995407 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:38:30.005002 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:38:30.005437 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:38:30.006142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:30.010230 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:38:30.010843 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:38:30.015752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:30.046131 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:38:30.046808 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:38:30.047296 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:38:30.052646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:38:30.058425 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:38:30.059200 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:38:30.069769 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:38:30.072258 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:38:29.922211 => 18:38:30.072048
[0m18:38:30.072723 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:38:30.073581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb97290>]}
[0m18:38:30.074466 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.16s]
[0m18:38:30.075684 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:38:30.077405 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:38:30.078930 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:38:30.080104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:38:30.080857 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:38:30.084407 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:38:30.085457 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:38:30.081182 => 18:38:30.085128
[0m18:38:30.086134 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:38:30.115204 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:38:30.117051 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:38:30.117812 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:38:30.118322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:30.130807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:38:30.131255 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:38:30.131739 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:38:30.178608 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:38:30.182026 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:38:30.182814 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:38:30.184350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:30.187624 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:38:30.188286 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:38:30.188983 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:38:30.190621 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:38:30.192902 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:38:30.193414 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:38:30.195128 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:38:30.196771 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:38:30.086591 => 18:38:30.196576
[0m18:38:30.197122 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:38:30.197877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce4afb2-7bee-4fac-92ec-08eaac4412ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb27d10>]}
[0m18:38:30.198501 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.12s]
[0m18:38:30.199418 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:38:30.200986 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:30.201469 [debug] [MainThread]: On master: BEGIN
[0m18:38:30.201821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:38:30.214837 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:38:30.215252 [debug] [MainThread]: On master: COMMIT
[0m18:38:30.215616 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:30.215970 [debug] [MainThread]: On master: COMMIT
[0m18:38:30.216446 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:38:30.217013 [debug] [MainThread]: On master: Close
[0m18:38:30.218440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:30.219446 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:38:30.220027 [info ] [MainThread]: 
[0m18:38:30.220707 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m18:38:30.222645 [debug] [MainThread]: Command end result
[0m18:38:30.232569 [info ] [MainThread]: 
[0m18:38:30.233188 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:38:30.233675 [info ] [MainThread]: 
[0m18:38:30.234271 [error] [MainThread]: [33mDatabase Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)[0m
[0m18:38:30.234749 [error] [MainThread]:   relation "aircrafts_data" does not exist
[0m18:38:30.235207 [error] [MainThread]:   LINE 19: from aircrafts_data as ad 
[0m18:38:30.235838 [error] [MainThread]:                 ^
[0m18:38:30.236495 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:38:30.237261 [info ] [MainThread]: 
[0m18:38:30.237934 [error] [MainThread]: [33mDatabase Error in model dim_airport (models/dimensions/dim_airport.sql)[0m
[0m18:38:30.238591 [error] [MainThread]:   relation "airports_data" does not exist
[0m18:38:30.240258 [error] [MainThread]:   LINE 18: from airports_data
[0m18:38:30.240981 [error] [MainThread]:                 ^
[0m18:38:30.241626 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_airport.sql
[0m18:38:30.242048 [info ] [MainThread]: 
[0m18:38:30.242851 [error] [MainThread]: [33mDatabase Error in model fact_boarding_passes (models/facts/fact_boarding_passes.sql)[0m
[0m18:38:30.243635 [error] [MainThread]:   relation "boarding_passes" does not exist
[0m18:38:30.244260 [error] [MainThread]:   LINE 14:  from boarding_passes as bp
[0m18:38:30.244825 [error] [MainThread]:                  ^
[0m18:38:30.245252 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/facts/fact_boarding_passes.sql
[0m18:38:30.245806 [info ] [MainThread]: 
[0m18:38:30.246342 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m18:38:30.247348 [debug] [MainThread]: Command `dbt run` failed at 18:38:30.247151 after 1.28 seconds
[0m18:38:30.248032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3186d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a318a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3bcc50>]}
[0m18:38:30.248611 [debug] [MainThread]: Flushing usage events
[0m18:41:48.793659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa555d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa4acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd2af90>]}


============================== 18:41:48.816896 | f2e63bf4-827b-4051-94e0-296a10d267cd ==============================
[0m18:41:48.816896 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:41:48.817751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/moranshorashi/.dbt', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:41:48.993762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2e63bf4-827b-4051-94e0-296a10d267cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8170d0>]}
[0m18:41:49.013865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2e63bf4-827b-4051-94e0-296a10d267cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa55790>]}
[0m18:41:49.015947 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:41:49.054594 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:41:49.155757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m18:41:49.156561 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/schema.yml
[0m18:41:49.157768 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/schema.yml
[0m18:41:49.158133 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/dim_aircraft.sql
[0m18:41:49.158440 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m18:41:49.158883 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/dim_airport.sql
[0m18:41:49.228781 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_boarding_passes.sql
[0m18:41:49.249900 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_flights.sql
[0m18:41:49.253607 [debug] [MainThread]: 1699: static parser successfully parsed dimensions/dim_airport.sql
[0m18:41:49.257715 [debug] [MainThread]: 1699: static parser successfully parsed dimensions/dim_aircraft.sql
[0m18:41:49.274546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2e63bf4-827b-4051-94e0-296a10d267cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a2290>]}
[0m18:41:49.282166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2e63bf4-827b-4051-94e0-296a10d267cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105dcf10>]}
[0m18:41:49.282681 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:41:49.283067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2e63bf4-827b-4051-94e0-296a10d267cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c13d0>]}
[0m18:41:49.284996 [info ] [MainThread]: 
[0m18:41:49.286050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:49.287203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:41:49.302184 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:41:49.302741 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:41:49.303267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:49.451529 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:41:49.453225 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:41:49.455048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m18:41:49.460878 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:41:49.461559 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:41:49.461840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:49.473653 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:49.474311 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:41:49.474673 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:41:49.480126 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:41:49.482016 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:41:49.482646 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:41:49.487296 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:49.487650 [debug] [MainThread]: On master: BEGIN
[0m18:41:49.487908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:49.499769 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:49.500462 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:49.500988 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:49.523828 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:41:49.525896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2e63bf4-827b-4051-94e0-296a10d267cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110421990>]}
[0m18:41:49.526627 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:49.527464 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:49.527993 [debug] [MainThread]: On master: BEGIN
[0m18:41:49.529036 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:49.529887 [debug] [MainThread]: On master: COMMIT
[0m18:41:49.530383 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:49.530737 [debug] [MainThread]: On master: COMMIT
[0m18:41:49.531492 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:49.532025 [debug] [MainThread]: On master: Close
[0m18:41:49.532912 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:49.533489 [info ] [MainThread]: 
[0m18:41:49.559966 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:41:49.561201 [info ] [Thread-1 (]: 1 of 2 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:41:49.562809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.my_first_dbt_model)
[0m18:41:49.563652 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:41:49.568081 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:41:49.570140 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:41:49.564135 => 18:41:49.569633
[0m18:41:49.570567 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:41:49.623554 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:41:49.624362 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:41:49.624931 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:41:49.625472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:49.635723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:49.636334 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:41:49.636728 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:41:49.657623 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:41:49.665834 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:41:49.666591 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:41:49.667402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:49.671088 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:41:49.672205 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:41:49.673956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:49.702356 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:41:49.702922 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:41:49.703382 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:41:49.705145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:49.712381 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:41:49.713026 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:41:49.719075 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:41:49.720867 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:41:49.570794 => 18:41:49.720639
[0m18:41:49.721316 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:41:49.722455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e63bf4-827b-4051-94e0-296a10d267cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f768750>]}
[0m18:41:49.723467 [info ] [Thread-1 (]: 1 of 2 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.16s]
[0m18:41:49.724426 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:41:49.725846 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:41:49.726547 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:41:49.727379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:41:49.727967 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:41:49.731693 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:41:49.732699 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:41:49.728283 => 18:41:49.732395
[0m18:41:49.733424 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:41:49.762900 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:41:49.763860 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:41:49.764752 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:41:49.765449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:49.795205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:49.795644 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:41:49.796112 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:41:49.800040 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:41:49.803764 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:41:49.804340 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:41:49.805154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:49.806799 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:41:49.807392 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:41:49.807732 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:41:49.840643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:49.845204 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:41:49.845713 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:41:49.846872 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:41:49.848853 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:41:49.733764 => 18:41:49.848325
[0m18:41:49.850075 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:41:49.851102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e63bf4-827b-4051-94e0-296a10d267cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104c3490>]}
[0m18:41:49.851874 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.12s]
[0m18:41:49.853382 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:41:49.855719 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:49.856290 [debug] [MainThread]: On master: BEGIN
[0m18:41:49.857071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:49.884489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:49.884889 [debug] [MainThread]: On master: COMMIT
[0m18:41:49.885217 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:49.885517 [debug] [MainThread]: On master: COMMIT
[0m18:41:49.886045 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:49.886420 [debug] [MainThread]: On master: Close
[0m18:41:49.887158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:49.887509 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:41:49.887891 [info ] [MainThread]: 
[0m18:41:49.889511 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m18:41:49.890635 [debug] [MainThread]: Command end result
[0m18:41:49.903435 [info ] [MainThread]: 
[0m18:41:49.907603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:49.909928 [info ] [MainThread]: 
[0m18:41:49.913160 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:41:49.915943 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:49.915758 after 1.16 seconds
[0m18:41:49.916838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7ff250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc6cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc6cc10>]}
[0m18:41:49.917695 [debug] [MainThread]: Flushing usage events
[0m18:43:06.992381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bcb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049996d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499bf90>]}


============================== 18:43:07.000953 | 763ae231-4fc0-4c06-93e7-a6d92217fee2 ==============================
[0m18:43:07.000953 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:43:07.001741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:43:07.194446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '763ae231-4fc0-4c06-93e7-a6d92217fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104961290>]}
[0m18:43:07.216060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '763ae231-4fc0-4c06-93e7-a6d92217fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c98990>]}
[0m18:43:07.218473 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:43:07.245921 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:43:07.361436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:43:07.362123 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/schema.yml
[0m18:43:07.362583 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/dim_aircraft.sql
[0m18:43:07.397803 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_aircraft.sql
[0m18:43:07.420349 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_aircraft.sql
[0m18:43:07.472893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '763ae231-4fc0-4c06-93e7-a6d92217fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c98210>]}
[0m18:43:07.484254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '763ae231-4fc0-4c06-93e7-a6d92217fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d89150>]}
[0m18:43:07.485020 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:43:07.485667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '763ae231-4fc0-4c06-93e7-a6d92217fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10249d690>]}
[0m18:43:07.488904 [info ] [MainThread]: 
[0m18:43:07.490632 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:07.492041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:43:07.503264 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:43:07.503832 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:43:07.504229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:07.694863 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:43:07.696765 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:43:07.698961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m18:43:07.706075 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:43:07.706733 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:43:07.707286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:07.720968 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:43:07.721774 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:43:07.722206 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:43:07.726771 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:43:07.728080 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:43:07.728781 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:43:07.734170 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:07.734653 [debug] [MainThread]: On master: BEGIN
[0m18:43:07.735016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:07.747045 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:07.747405 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:07.747781 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:07.770807 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:43:07.773784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '763ae231-4fc0-4c06-93e7-a6d92217fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ecc50>]}
[0m18:43:07.774346 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:07.775013 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:07.775408 [debug] [MainThread]: On master: BEGIN
[0m18:43:07.776245 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:07.776892 [debug] [MainThread]: On master: COMMIT
[0m18:43:07.777183 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:07.777450 [debug] [MainThread]: On master: COMMIT
[0m18:43:07.777935 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:07.778373 [debug] [MainThread]: On master: Close
[0m18:43:07.779299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:07.779823 [info ] [MainThread]: 
[0m18:43:07.809317 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m18:43:07.810276 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m18:43:07.811451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m18:43:07.811995 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m18:43:07.817193 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m18:43:07.818836 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 18:43:07.812616 => 18:43:07.818408
[0m18:43:07.819428 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m18:43:07.866994 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m18:43:07.867889 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:43:07.868302 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m18:43:07.868967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:07.885188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:07.885675 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:43:07.886059 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select *,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 15:43:06' as dbt_time
from aircrafts_data as ad 
inner join seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m18:43:07.887494 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "aircrafts_data" does not exist
LINE 19: from aircrafts_data as ad 
              ^

[0m18:43:07.888284 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: ROLLBACK
[0m18:43:07.890127 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 18:43:07.819842 => 18:43:07.889843
[0m18:43:07.890718 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m18:43:07.971165 [debug] [Thread-1 (]: Database Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)
  relation "aircrafts_data" does not exist
  LINE 19: from aircrafts_data as ad 
                ^
  compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:43:07.972288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '763ae231-4fc0-4c06-93e7-a6d92217fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d42910>]}
[0m18:43:07.973078 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model flights_wh.dim_aircraft .................. [[31mERROR[0m in 0.16s]
[0m18:43:07.974036 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m18:43:07.974898 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:43:07.975747 [info ] [Thread-1 (]: 2 of 3 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:43:07.976729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m18:43:07.977191 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:43:07.981199 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:43:07.982990 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:43:07.977486 => 18:43:07.982412
[0m18:43:07.983541 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:43:07.990005 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:43:07.991082 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:07.991825 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:43:07.992471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:08.004319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:08.005130 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:08.005571 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:43:08.025877 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:43:08.033317 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:08.034284 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:43:08.035767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:08.040541 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:08.041088 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:43:08.042285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:08.066752 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:43:08.067442 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:08.067972 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:43:08.070549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:43:08.077086 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:08.077516 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:43:08.083259 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:43:08.084760 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:43:07.983779 => 18:43:08.084564
[0m18:43:08.085105 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:43:08.085815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '763ae231-4fc0-4c06-93e7-a6d92217fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b1b10>]}
[0m18:43:08.086386 [info ] [Thread-1 (]: 2 of 3 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.11s]
[0m18:43:08.087186 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:43:08.088276 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:43:08.089231 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:43:08.090333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:43:08.090980 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:43:08.094349 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:43:08.095526 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:43:08.091269 => 18:43:08.095247
[0m18:43:08.096089 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:43:08.123257 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:43:08.124473 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:08.124999 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:43:08.125336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:08.139874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:08.140435 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:08.140955 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:43:08.144282 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:43:08.148003 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:08.148534 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:43:08.150237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:08.152457 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:43:08.152845 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:08.153235 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:43:08.155344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:43:08.158317 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:08.158830 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:43:08.159458 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:43:08.160950 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:43:08.096486 => 18:43:08.160754
[0m18:43:08.161305 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:43:08.162036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '763ae231-4fc0-4c06-93e7-a6d92217fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560af10>]}
[0m18:43:08.162821 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.07s]
[0m18:43:08.163932 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:43:08.165794 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:08.166424 [debug] [MainThread]: On master: BEGIN
[0m18:43:08.166805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:08.192543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:08.192915 [debug] [MainThread]: On master: COMMIT
[0m18:43:08.193192 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:08.193531 [debug] [MainThread]: On master: COMMIT
[0m18:43:08.194633 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:08.195130 [debug] [MainThread]: On master: Close
[0m18:43:08.196026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:08.196540 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:43:08.197365 [info ] [MainThread]: 
[0m18:43:08.197810 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m18:43:08.199288 [debug] [MainThread]: Command end result
[0m18:43:08.210058 [info ] [MainThread]: 
[0m18:43:08.210936 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:43:08.211641 [info ] [MainThread]: 
[0m18:43:08.212490 [error] [MainThread]: [33mDatabase Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)[0m
[0m18:43:08.212987 [error] [MainThread]:   relation "aircrafts_data" does not exist
[0m18:43:08.213476 [error] [MainThread]:   LINE 19: from aircrafts_data as ad 
[0m18:43:08.213952 [error] [MainThread]:                 ^
[0m18:43:08.214367 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:43:08.214807 [info ] [MainThread]: 
[0m18:43:08.215303 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:43:08.216206 [debug] [MainThread]: Command `dbt run` failed at 18:43:08.216042 after 1.25 seconds
[0m18:43:08.216618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100becbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464e410>]}
[0m18:43:08.216968 [debug] [MainThread]: Flushing usage events
[0m18:43:38.660141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088851d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108860d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864bd50>]}


============================== 18:43:38.674162 | 03eaa62e-ceaf-4b96-9a32-19080023b0ce ==============================
[0m18:43:38.674162 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:43:38.674997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:43:38.866207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03eaa62e-ceaf-4b96-9a32-19080023b0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4b810>]}
[0m18:43:38.888117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03eaa62e-ceaf-4b96-9a32-19080023b0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108860d90>]}
[0m18:43:38.890712 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:43:38.931523 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:43:39.046053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:39.046929 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/schema.yml
[0m18:43:39.081116 [debug] [MainThread]: 1699: static parser successfully parsed dimensions/dim_airport.sql
[0m18:43:39.121307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03eaa62e-ceaf-4b96-9a32-19080023b0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108582d90>]}
[0m18:43:39.144403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03eaa62e-ceaf-4b96-9a32-19080023b0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7bfd0>]}
[0m18:43:39.145556 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:43:39.146676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03eaa62e-ceaf-4b96-9a32-19080023b0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889f110>]}
[0m18:43:39.151657 [info ] [MainThread]: 
[0m18:43:39.166391 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:39.170338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:43:39.190657 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:43:39.191839 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:43:39.193312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:39.359714 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:43:39.362188 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:43:39.364359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m18:43:39.371950 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:43:39.372676 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:43:39.373060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:39.383190 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:43:39.383656 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:43:39.384176 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:43:39.390715 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:43:39.392484 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:43:39.392979 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:43:39.399966 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:39.400337 [debug] [MainThread]: On master: BEGIN
[0m18:43:39.400670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:39.410646 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:39.411005 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:39.411360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:39.430682 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:43:39.433036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03eaa62e-ceaf-4b96-9a32-19080023b0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108878e90>]}
[0m18:43:39.433495 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:39.433934 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:39.434211 [debug] [MainThread]: On master: BEGIN
[0m18:43:39.434758 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:39.435053 [debug] [MainThread]: On master: COMMIT
[0m18:43:39.435366 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:39.435625 [debug] [MainThread]: On master: COMMIT
[0m18:43:39.435976 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:39.436256 [debug] [MainThread]: On master: Close
[0m18:43:39.436907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:39.437336 [info ] [MainThread]: 
[0m18:43:39.465769 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m18:43:39.466592 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m18:43:39.467906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m18:43:39.469447 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m18:43:39.474819 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m18:43:39.476586 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 18:43:39.470217 => 18:43:39.476087
[0m18:43:39.477226 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m18:43:39.530390 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m18:43:39.531428 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:43:39.531967 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m18:43:39.532415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:39.542436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:39.542861 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:43:39.543253 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select *,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 15:43:38' as dbt_time
from aircrafts_data as ad 
inner join seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m18:43:39.544141 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "aircrafts_data" does not exist
LINE 19: from aircrafts_data as ad 
              ^

[0m18:43:39.544498 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: ROLLBACK
[0m18:43:39.545232 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 18:43:39.477599 => 18:43:39.545026
[0m18:43:39.545587 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m18:43:39.610889 [debug] [Thread-1 (]: Database Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)
  relation "aircrafts_data" does not exist
  LINE 19: from aircrafts_data as ad 
                ^
  compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:43:39.611414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03eaa62e-ceaf-4b96-9a32-19080023b0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ff110>]}
[0m18:43:39.612018 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model flights_wh.dim_aircraft .................. [[31mERROR[0m in 0.14s]
[0m18:43:39.612576 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m18:43:39.613329 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:43:39.614341 [info ] [Thread-1 (]: 2 of 3 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:43:39.615477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m18:43:39.616055 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:43:39.618740 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:43:39.619983 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:43:39.616308 => 18:43:39.619525
[0m18:43:39.620806 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:43:39.629126 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:43:39.630445 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:39.631011 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:43:39.631393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:39.643062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:39.643482 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:39.643867 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:43:39.689250 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:43:39.696284 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:39.696821 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:43:39.697637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:39.700572 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:39.701180 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:43:39.701978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:39.726605 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:43:39.727191 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:39.727760 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:43:39.729463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:43:39.735712 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:39.736134 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:43:39.739954 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:43:39.741583 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:43:39.621172 => 18:43:39.741383
[0m18:43:39.741933 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:43:39.742661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03eaa62e-ceaf-4b96-9a32-19080023b0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932f110>]}
[0m18:43:39.743238 [info ] [Thread-1 (]: 2 of 3 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.13s]
[0m18:43:39.744085 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:43:39.745437 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:43:39.746067 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:43:39.747471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:43:39.748211 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:43:39.752025 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:43:39.753690 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:43:39.748902 => 18:43:39.752981
[0m18:43:39.754590 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:43:39.780422 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:43:39.781661 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:39.782415 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:43:39.783151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:39.795282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:39.795993 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:39.796550 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:43:39.815291 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:43:39.817972 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:39.818405 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:43:39.819259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:39.821088 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:43:39.821433 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:39.821763 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:43:39.822981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:43:39.825345 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:39.825740 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:43:39.826289 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:43:39.827783 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:43:39.755378 => 18:43:39.827580
[0m18:43:39.828162 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:43:39.829076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03eaa62e-ceaf-4b96-9a32-19080023b0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b6bd0>]}
[0m18:43:39.830007 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m18:43:39.830954 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:43:39.833393 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:39.834071 [debug] [MainThread]: On master: BEGIN
[0m18:43:39.834419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:39.850910 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:39.851564 [debug] [MainThread]: On master: COMMIT
[0m18:43:39.852088 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:39.852602 [debug] [MainThread]: On master: COMMIT
[0m18:43:39.853932 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:39.854399 [debug] [MainThread]: On master: Close
[0m18:43:39.855216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:39.855973 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:43:39.856738 [info ] [MainThread]: 
[0m18:43:39.857419 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m18:43:39.858945 [debug] [MainThread]: Command end result
[0m18:43:39.868286 [info ] [MainThread]: 
[0m18:43:39.869942 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:43:39.870410 [info ] [MainThread]: 
[0m18:43:39.870928 [error] [MainThread]: [33mDatabase Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)[0m
[0m18:43:39.871335 [error] [MainThread]:   relation "aircrafts_data" does not exist
[0m18:43:39.871691 [error] [MainThread]:   LINE 19: from aircrafts_data as ad 
[0m18:43:39.872025 [error] [MainThread]:                 ^
[0m18:43:39.872348 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:43:39.872794 [info ] [MainThread]: 
[0m18:43:39.873319 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:43:39.874383 [debug] [MainThread]: Command `dbt run` failed at 18:43:39.874225 after 1.25 seconds
[0m18:43:39.874854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108958550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a44410>]}
[0m18:43:39.875306 [debug] [MainThread]: Flushing usage events
[0m18:47:40.449591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128a9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e5b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b6cb10>]}


============================== 18:47:40.469418 | c918791f-4930-4a8b-a38c-685ff7839270 ==============================
[0m18:47:40.469418 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:47:40.470770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:47:40.656325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c918791f-4930-4a8b-a38c-685ff7839270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128a95d0>]}
[0m18:47:40.676047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c918791f-4930-4a8b-a38c-685ff7839270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350bfd0>]}
[0m18:47:40.678402 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:47:40.719204 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:47:40.829789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:47:40.830887 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/dim_aircraft.sql
[0m18:47:40.876164 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_aircraft.sql
[0m18:47:40.896487 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_aircraft.sql
[0m18:47:40.911835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c918791f-4930-4a8b-a38c-685ff7839270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e75f90>]}
[0m18:47:40.921221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c918791f-4930-4a8b-a38c-685ff7839270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11364fad0>]}
[0m18:47:40.921814 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:47:40.922242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c918791f-4930-4a8b-a38c-685ff7839270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f53d0>]}
[0m18:47:40.924192 [info ] [MainThread]: 
[0m18:47:40.925334 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:47:40.927071 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:47:40.943463 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:47:40.944019 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:47:40.944424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:41.178916 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:47:41.181072 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:47:41.183404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m18:47:41.189584 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:47:41.190125 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:47:41.190457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:41.203393 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:47:41.203850 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:47:41.204190 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:47:41.212630 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:47:41.214207 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:47:41.214908 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:47:41.219939 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:41.220481 [debug] [MainThread]: On master: BEGIN
[0m18:47:41.220757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:47:41.233399 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:47:41.233840 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:41.234278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:47:41.265154 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:47:41.267883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c918791f-4930-4a8b-a38c-685ff7839270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112886950>]}
[0m18:47:41.268608 [debug] [MainThread]: On master: ROLLBACK
[0m18:47:41.269430 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:41.269782 [debug] [MainThread]: On master: BEGIN
[0m18:47:41.270720 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:47:41.271539 [debug] [MainThread]: On master: COMMIT
[0m18:47:41.271935 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:41.272208 [debug] [MainThread]: On master: COMMIT
[0m18:47:41.272624 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:47:41.273046 [debug] [MainThread]: On master: Close
[0m18:47:41.273815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:47:41.274271 [info ] [MainThread]: 
[0m18:47:41.302531 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m18:47:41.303155 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m18:47:41.303895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m18:47:41.304417 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m18:47:41.306931 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m18:47:41.308139 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 18:47:41.304655 => 18:47:41.307832
[0m18:47:41.308534 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m18:47:41.362222 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m18:47:41.363842 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:47:41.365061 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m18:47:41.365837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:41.384304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:47:41.384758 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:47:41.385112 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select *,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 15:47:40' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m18:47:41.430927 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "aircraft_code" specified more than once

[0m18:47:41.431764 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: ROLLBACK
[0m18:47:41.432810 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 18:47:41.308750 => 18:47:41.432490
[0m18:47:41.433458 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m18:47:41.498198 [debug] [Thread-1 (]: Database Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)
  column "aircraft_code" specified more than once
  compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:47:41.499141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c918791f-4930-4a8b-a38c-685ff7839270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113627050>]}
[0m18:47:41.500625 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model flights_wh.dim_aircraft .................. [[31mERROR[0m in 0.20s]
[0m18:47:41.501573 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m18:47:41.502293 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:47:41.503400 [info ] [Thread-1 (]: 2 of 3 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:47:41.504392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m18:47:41.504977 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:47:41.508172 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:47:41.511275 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:47:41.505254 => 18:47:41.509309
[0m18:47:41.512010 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:47:41.518207 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:47:41.519323 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:47:41.519845 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:47:41.520786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:41.576079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:47:41.576617 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:47:41.577074 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:47:41.586870 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:47:41.598565 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:47:41.599092 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:47:41.599866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:47:41.603233 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:47:41.603626 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:47:41.604394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:47:41.630097 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:47:41.631296 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:47:41.631921 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:47:41.633523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:47:41.640930 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:47:41.641460 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:47:41.646847 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:47:41.648477 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:47:41.512558 => 18:47:41.648285
[0m18:47:41.648811 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:47:41.649537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c918791f-4930-4a8b-a38c-685ff7839270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129592d0>]}
[0m18:47:41.650247 [info ] [Thread-1 (]: 2 of 3 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.15s]
[0m18:47:41.651335 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:47:41.653407 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:47:41.654313 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:47:41.655426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:47:41.656168 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:47:41.659574 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:47:41.662511 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:47:41.656538 => 18:47:41.661191
[0m18:47:41.663191 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:47:41.692326 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:47:41.693858 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:47:41.694470 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:47:41.695121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:41.722497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:47:41.722923 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:47:41.723310 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:47:41.728419 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:47:41.733331 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:47:41.733739 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:47:41.734470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:47:41.737757 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:47:41.738218 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:47:41.738531 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:47:41.740476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:47:41.742684 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:47:41.743112 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:47:41.744094 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:47:41.746024 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:47:41.663647 => 18:47:41.745816
[0m18:47:41.746394 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:47:41.747075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c918791f-4930-4a8b-a38c-685ff7839270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135b8f90>]}
[0m18:47:41.747728 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m18:47:41.749527 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:47:41.752688 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:41.753178 [debug] [MainThread]: On master: BEGIN
[0m18:47:41.753448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:47:41.769580 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:47:41.770084 [debug] [MainThread]: On master: COMMIT
[0m18:47:41.770501 [debug] [MainThread]: Using postgres connection "master"
[0m18:47:41.770895 [debug] [MainThread]: On master: COMMIT
[0m18:47:41.771424 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:47:41.771770 [debug] [MainThread]: On master: Close
[0m18:47:41.772456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:41.772738 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:47:41.773085 [info ] [MainThread]: 
[0m18:47:41.773501 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m18:47:41.774512 [debug] [MainThread]: Command end result
[0m18:47:41.782753 [info ] [MainThread]: 
[0m18:47:41.783410 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:47:41.783984 [info ] [MainThread]: 
[0m18:47:41.784498 [error] [MainThread]: [33mDatabase Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)[0m
[0m18:47:41.784974 [error] [MainThread]:   column "aircraft_code" specified more than once
[0m18:47:41.785602 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:47:41.786068 [info ] [MainThread]: 
[0m18:47:41.786498 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:47:41.787306 [debug] [MainThread]: Command `dbt run` failed at 18:47:41.787173 after 1.37 seconds
[0m18:47:41.787847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b7e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112acc390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c067d0>]}
[0m18:47:41.788673 [debug] [MainThread]: Flushing usage events
[0m18:56:44.662487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e532510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7f8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e833790>]}


============================== 18:56:44.673229 | 1e142769-409f-4378-9f96-702be674237c ==============================
[0m18:56:44.673229 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:56:44.674754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:56:44.851857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e142769-409f-4378-9f96-702be674237c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e545f10>]}
[0m18:56:44.871800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e142769-409f-4378-9f96-702be674237c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e2790>]}
[0m18:56:44.873271 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:56:44.904964 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:56:44.980623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:56:44.981456 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/dim_aircraft.sql
[0m18:56:45.015366 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_aircraft.sql
[0m18:56:45.033638 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_aircraft.sql
[0m18:56:45.047066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e142769-409f-4378-9f96-702be674237c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebdd850>]}
[0m18:56:45.057936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e142769-409f-4378-9f96-702be674237c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2a5290>]}
[0m18:56:45.058577 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:56:45.059031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e142769-409f-4378-9f96-702be674237c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e2710>]}
[0m18:56:45.061187 [info ] [MainThread]: 
[0m18:56:45.062171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:56:45.064175 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:56:45.079360 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:56:45.079854 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:56:45.080250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:45.231923 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:56:45.234133 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:56:45.236053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m18:56:45.243380 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:56:45.243826 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:56:45.244110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:56:45.254867 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:56:45.255306 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:56:45.255698 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:56:45.260536 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:56:45.262015 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:56:45.262738 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:56:45.268589 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:45.268971 [debug] [MainThread]: On master: BEGIN
[0m18:56:45.269249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:56:45.284980 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:56:45.285471 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:45.285871 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:56:45.330939 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:56:45.333042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e142769-409f-4378-9f96-702be674237c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc68510>]}
[0m18:56:45.333901 [debug] [MainThread]: On master: ROLLBACK
[0m18:56:45.334574 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:45.334897 [debug] [MainThread]: On master: BEGIN
[0m18:56:45.335708 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:56:45.336306 [debug] [MainThread]: On master: COMMIT
[0m18:56:45.336794 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:45.337138 [debug] [MainThread]: On master: COMMIT
[0m18:56:45.337628 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:56:45.337926 [debug] [MainThread]: On master: Close
[0m18:56:45.338656 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:56:45.339234 [info ] [MainThread]: 
[0m18:56:45.345630 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m18:56:45.346196 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m18:56:45.347063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m18:56:45.347630 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m18:56:45.350947 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m18:56:45.352762 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 18:56:45.347983 => 18:56:45.352038
[0m18:56:45.353856 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m18:56:45.405550 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m18:56:45.406341 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:56:45.406760 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m18:56:45.407180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:45.418009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:56:45.418418 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:56:45.418804 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.aircraft_code, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 15:56:44' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m18:56:45.453124 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "aircraft_code" specified more than once

[0m18:56:45.453883 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: ROLLBACK
[0m18:56:45.454557 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 18:56:45.354460 => 18:56:45.454342
[0m18:56:45.454903 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m18:56:45.491764 [debug] [Thread-1 (]: Database Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)
  column "aircraft_code" specified more than once
  compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:56:45.492310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e142769-409f-4378-9f96-702be674237c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4e2f10>]}
[0m18:56:45.493088 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model flights_wh.dim_aircraft .................. [[31mERROR[0m in 0.15s]
[0m18:56:45.493975 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m18:56:45.494643 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:56:45.495542 [info ] [Thread-1 (]: 2 of 3 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:56:45.496493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m18:56:45.496955 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:56:45.500312 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:56:45.502041 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:56:45.497198 => 18:56:45.501511
[0m18:56:45.503243 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:56:45.508542 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:56:45.509277 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:56:45.509692 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:56:45.510007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:45.521477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:56:45.521936 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:56:45.522296 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:56:45.545797 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:56:45.555584 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:56:45.556077 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:56:45.557006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:56:45.560167 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:56:45.560542 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:56:45.561234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:56:45.586417 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:56:45.586899 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:56:45.587227 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:56:45.588430 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:56:45.594159 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:56:45.594595 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:56:45.598303 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:56:45.600340 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:56:45.503650 => 18:56:45.600136
[0m18:56:45.600761 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:56:45.601505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e142769-409f-4378-9f96-702be674237c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5b3e90>]}
[0m18:56:45.602260 [info ] [Thread-1 (]: 2 of 3 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.11s]
[0m18:56:45.603108 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:56:45.604382 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:56:45.605032 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:56:45.605927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:56:45.606349 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:56:45.609319 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:56:45.610417 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:56:45.606648 => 18:56:45.610139
[0m18:56:45.610879 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:56:45.636365 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:56:45.637541 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:56:45.638158 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:56:45.638529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:45.652806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:56:45.653697 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:56:45.654280 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:56:45.656629 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:56:45.659534 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:56:45.659908 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:56:45.660601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:56:45.662409 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:56:45.662851 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:56:45.663226 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:56:45.665146 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:56:45.668933 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:56:45.669649 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:56:45.670484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:56:45.672880 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:56:45.611223 => 18:56:45.672468
[0m18:56:45.673516 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:56:45.675058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e142769-409f-4378-9f96-702be674237c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2c0710>]}
[0m18:56:45.675723 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.07s]
[0m18:56:45.676449 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:56:45.678324 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:45.679109 [debug] [MainThread]: On master: BEGIN
[0m18:56:45.679722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:56:45.692671 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:56:45.693391 [debug] [MainThread]: On master: COMMIT
[0m18:56:45.693819 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:45.694127 [debug] [MainThread]: On master: COMMIT
[0m18:56:45.694650 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:56:45.695053 [debug] [MainThread]: On master: Close
[0m18:56:45.695890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:45.696596 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:56:45.697236 [info ] [MainThread]: 
[0m18:56:45.698041 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m18:56:45.699500 [debug] [MainThread]: Command end result
[0m18:56:45.706916 [info ] [MainThread]: 
[0m18:56:45.707916 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:56:45.708619 [info ] [MainThread]: 
[0m18:56:45.709220 [error] [MainThread]: [33mDatabase Error in model dim_aircraft (models/dimensions/dim_aircraft.sql)[0m
[0m18:56:45.709862 [error] [MainThread]:   column "aircraft_code" specified more than once
[0m18:56:45.710375 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/dimensions/dim_aircraft.sql
[0m18:56:45.710909 [info ] [MainThread]: 
[0m18:56:45.711421 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:56:45.712267 [debug] [MainThread]: Command `dbt run` failed at 18:56:45.712092 after 1.08 seconds
[0m18:56:45.712886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9d0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3ca090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9dc650>]}
[0m18:56:45.713471 [debug] [MainThread]: Flushing usage events
[0m18:57:54.684959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108417410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108699310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086aafd0>]}


============================== 18:57:54.729621 | 56c46b5e-17fd-46ce-b030-f8029d97a6dc ==============================
[0m18:57:54.729621 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:57:54.730461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:57:54.916591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56c46b5e-17fd-46ce-b030-f8029d97a6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f665d0>]}
[0m18:57:54.938946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56c46b5e-17fd-46ce-b030-f8029d97a6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f665d0>]}
[0m18:57:54.941917 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:57:54.972080 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:57:55.132217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:57:55.133437 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/dim_aircraft.sql
[0m18:57:55.167397 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_aircraft.sql
[0m18:57:55.191690 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_aircraft.sql
[0m18:57:55.203221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56c46b5e-17fd-46ce-b030-f8029d97a6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871a9d0>]}
[0m18:57:55.212781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56c46b5e-17fd-46ce-b030-f8029d97a6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ec510>]}
[0m18:57:55.214291 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:57:55.214776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56c46b5e-17fd-46ce-b030-f8029d97a6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877bd50>]}
[0m18:57:55.216612 [info ] [MainThread]: 
[0m18:57:55.217463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:55.218982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:57:55.234207 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:57:55.234922 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:57:55.235607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:55.362943 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:57:55.365387 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:57:55.368587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m18:57:55.378109 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:57:55.378768 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:57:55.379283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:55.398122 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:57:55.398523 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:57:55.398818 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:57:55.417295 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:57:55.419327 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:57:55.420292 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:57:55.426517 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:55.427388 [debug] [MainThread]: On master: BEGIN
[0m18:57:55.427696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:55.441401 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:55.442074 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:55.442621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:55.478410 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:57:55.480990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56c46b5e-17fd-46ce-b030-f8029d97a6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108470c10>]}
[0m18:57:55.481457 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:55.481916 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:55.482341 [debug] [MainThread]: On master: BEGIN
[0m18:57:55.484271 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:55.484810 [debug] [MainThread]: On master: COMMIT
[0m18:57:55.485311 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:55.485713 [debug] [MainThread]: On master: COMMIT
[0m18:57:55.490035 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:57:55.490854 [debug] [MainThread]: On master: Close
[0m18:57:55.492240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:55.492893 [info ] [MainThread]: 
[0m18:57:55.499621 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m18:57:55.500482 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m18:57:55.501430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m18:57:55.502020 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m18:57:55.505888 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m18:57:55.507626 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 18:57:55.502412 => 18:57:55.506900
[0m18:57:55.508382 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m18:57:55.567934 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m18:57:55.569286 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:57:55.570198 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m18:57:55.570772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:55.586750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:55.587377 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:57:55.588124 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 15:57:54' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m18:57:55.646438 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:57:55.652629 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:57:55.653461 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m18:57:55.654689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:57:55.678194 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m18:57:55.678623 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:57:55.679020 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m18:57:55.682302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:55.688311 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:57:55.689041 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m18:57:55.689768 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:57:55.691423 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 18:57:55.508997 => 18:57:55.691138
[0m18:57:55.691788 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m18:57:55.692597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56c46b5e-17fd-46ce-b030-f8029d97a6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921c750>]}
[0m18:57:55.693424 [info ] [Thread-1 (]: 1 of 3 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.19s]
[0m18:57:55.694737 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m18:57:55.695398 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:57:55.695980 [info ] [Thread-1 (]: 2 of 3 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:57:55.697234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m18:57:55.697644 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:57:55.701672 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:57:55.702833 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:57:55.698040 => 18:57:55.702554
[0m18:57:55.703771 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:57:55.709803 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:57:55.710861 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:55.711422 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:57:55.711743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:55.726125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:55.726748 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:55.727355 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:57:55.731104 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:57:55.737820 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:55.738812 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:57:55.740537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:57:55.743518 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:55.743909 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:57:55.744613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:57:55.749367 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:57:55.749775 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:55.750091 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:57:55.751395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:55.754984 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:55.755505 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:57:55.759592 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:57:55.761743 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:57:55.704446 => 18:57:55.761515
[0m18:57:55.762419 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:57:55.764335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56c46b5e-17fd-46ce-b030-f8029d97a6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108978e10>]}
[0m18:57:55.765054 [info ] [Thread-1 (]: 2 of 3 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.07s]
[0m18:57:55.766245 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:57:55.767427 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:57:55.768002 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:57:55.770336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:57:55.771488 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:57:55.776268 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:57:55.777372 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:57:55.773707 => 18:57:55.777147
[0m18:57:55.778165 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:57:55.805070 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:57:55.807734 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:57:55.808390 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:57:55.808798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:55.824628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:55.825445 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:57:55.825961 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:57:55.830412 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:57:55.834462 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:57:55.835045 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:57:55.838397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:57:55.840669 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:57:55.841165 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:57:55.841478 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:57:55.843378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:55.845985 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:57:55.846413 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:57:55.846969 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:57:55.848307 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:57:55.778405 => 18:57:55.848117
[0m18:57:55.848650 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:57:55.849364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56c46b5e-17fd-46ce-b030-f8029d97a6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109218fd0>]}
[0m18:57:55.850107 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m18:57:55.850842 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:57:55.852542 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:55.852993 [debug] [MainThread]: On master: BEGIN
[0m18:57:55.853705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:55.868584 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:55.869266 [debug] [MainThread]: On master: COMMIT
[0m18:57:55.869853 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:55.870435 [debug] [MainThread]: On master: COMMIT
[0m18:57:55.871433 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:57:55.872112 [debug] [MainThread]: On master: Close
[0m18:57:55.873106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:55.873871 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:57:55.874931 [info ] [MainThread]: 
[0m18:57:55.875399 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m18:57:55.876794 [debug] [MainThread]: Command end result
[0m18:57:55.883488 [info ] [MainThread]: 
[0m18:57:55.884102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:55.884592 [info ] [MainThread]: 
[0m18:57:55.885096 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:57:55.886175 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:55.885917 after 1.23 seconds
[0m18:57:55.886856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108713dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836b9d0>]}
[0m18:57:55.887366 [debug] [MainThread]: Flushing usage events
[0m18:58:50.412043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114095a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b5ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113db82d0>]}


============================== 18:58:50.421632 | 597c898e-405e-4bae-8ff3-fae278735069 ==============================
[0m18:58:50.421632 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:58:50.422778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:58:50.548176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '597c898e-405e-4bae-8ff3-fae278735069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139ffad0>]}
[0m18:58:50.566411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '597c898e-405e-4bae-8ff3-fae278735069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d90b10>]}
[0m18:58:50.567552 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:58:50.608177 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:58:50.692327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:58:50.693002 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/schema.yml
[0m18:58:50.762252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '597c898e-405e-4bae-8ff3-fae278735069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e897d0>]}
[0m18:58:50.770798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '597c898e-405e-4bae-8ff3-fae278735069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11480da90>]}
[0m18:58:50.771562 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:58:50.772119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '597c898e-405e-4bae-8ff3-fae278735069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118cd750>]}
[0m18:58:50.775641 [info ] [MainThread]: 
[0m18:58:50.776921 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:50.778858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:58:50.793092 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:58:50.794158 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:58:50.794710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:50.870978 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:58:50.873185 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:58:50.876042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m18:58:50.883034 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:58:50.883719 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:58:50.884069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:50.894472 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:58:50.894982 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:58:50.895286 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:58:50.899065 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:58:50.900742 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:58:50.901986 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:58:50.909090 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:50.909515 [debug] [MainThread]: On master: BEGIN
[0m18:58:50.909818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:50.919730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:58:50.920084 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:50.920468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:50.941067 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:58:50.943245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '597c898e-405e-4bae-8ff3-fae278735069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11417ff90>]}
[0m18:58:50.943802 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:50.944276 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:50.944568 [debug] [MainThread]: On master: BEGIN
[0m18:58:50.945111 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:58:50.945406 [debug] [MainThread]: On master: COMMIT
[0m18:58:50.945675 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:50.945928 [debug] [MainThread]: On master: COMMIT
[0m18:58:50.946536 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:58:50.946842 [debug] [MainThread]: On master: Close
[0m18:58:50.947524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:50.947929 [info ] [MainThread]: 
[0m18:58:50.955337 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m18:58:50.956070 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m18:58:50.957368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m18:58:50.958055 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m18:58:50.961646 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m18:58:50.962499 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 18:58:50.958640 => 18:58:50.962231
[0m18:58:50.962931 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m18:58:51.014557 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m18:58:51.015635 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:58:51.016206 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m18:58:51.016571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:51.027355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:58:51.027748 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:58:51.028084 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 15:58:50' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m18:58:51.053639 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:58:51.060296 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:58:51.060729 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m18:58:51.061453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:58:51.065499 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:58:51.065994 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m18:58:51.067484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:58:51.093013 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m18:58:51.093678 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:58:51.094271 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m18:58:51.097890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:58:51.104287 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m18:58:51.104929 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m18:58:51.109425 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:58:51.111229 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 18:58:50.963184 => 18:58:51.110965
[0m18:58:51.112077 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m18:58:51.114008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '597c898e-405e-4bae-8ff3-fae278735069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140a7590>]}
[0m18:58:51.115108 [info ] [Thread-1 (]: 1 of 3 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.16s]
[0m18:58:51.116503 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m18:58:51.117793 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:58:51.118461 [info ] [Thread-1 (]: 2 of 3 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:58:51.119831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m18:58:51.120364 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:58:51.127133 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:58:51.128957 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:58:51.120906 => 18:58:51.128429
[0m18:58:51.129428 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:58:51.134743 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:58:51.135687 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:51.136378 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:58:51.137046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:51.151293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:58:51.151701 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:51.152043 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:58:51.159327 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:58:51.162768 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:51.164092 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:58:51.165470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:58:51.176357 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:51.177055 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:58:51.178107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:58:51.184546 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:58:51.185183 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:51.185728 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:58:51.187666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:58:51.192068 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:51.192623 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:58:51.196585 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:58:51.199770 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:58:51.129753 => 18:58:51.199423
[0m18:58:51.200559 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:58:51.201991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '597c898e-405e-4bae-8ff3-fae278735069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141a1ed0>]}
[0m18:58:51.202829 [info ] [Thread-1 (]: 2 of 3 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.08s]
[0m18:58:51.207860 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:58:51.215911 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:58:51.218677 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:58:51.223049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:58:51.224450 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:58:51.227976 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:58:51.228808 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:58:51.225411 => 18:58:51.228562
[0m18:58:51.229692 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:58:51.258884 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:58:51.259692 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:58:51.260183 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:58:51.260548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:51.279086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:58:51.279643 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:58:51.280123 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:58:51.282793 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:58:51.286702 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:58:51.287240 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:58:51.288299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:58:51.290505 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:58:51.291071 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:58:51.291595 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:58:51.293421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:58:51.296574 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:58:51.297185 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:58:51.297827 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:58:51.299235 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:58:51.230286 => 18:58:51.299047
[0m18:58:51.299607 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:58:51.300313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '597c898e-405e-4bae-8ff3-fae278735069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149820d0>]}
[0m18:58:51.300867 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m18:58:51.301536 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:58:51.303428 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:51.303855 [debug] [MainThread]: On master: BEGIN
[0m18:58:51.304376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:51.316699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:58:51.317229 [debug] [MainThread]: On master: COMMIT
[0m18:58:51.317643 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:51.317938 [debug] [MainThread]: On master: COMMIT
[0m18:58:51.318472 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:58:51.318849 [debug] [MainThread]: On master: Close
[0m18:58:51.319797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:51.320228 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:58:51.320719 [info ] [MainThread]: 
[0m18:58:51.321440 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m18:58:51.322661 [debug] [MainThread]: Command end result
[0m18:58:51.333173 [info ] [MainThread]: 
[0m18:58:51.334346 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:51.335093 [info ] [MainThread]: 
[0m18:58:51.335709 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:58:51.336655 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:51.336449 after 0.95 seconds
[0m18:58:51.337265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e8a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff6fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fed9710>]}
[0m18:58:51.337912 [debug] [MainThread]: Flushing usage events
[0m19:01:09.291932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089651d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ab590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088aaa90>]}


============================== 19:01:09.302366 | 12378b90-d6b3-4f51-a9ce-96aadc06f080 ==============================
[0m19:01:09.302366 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:01:09.303211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/moranshorashi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:01:09.425324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12378b90-d6b3-4f51-a9ce-96aadc06f080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3fa90>]}
[0m19:01:09.444822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12378b90-d6b3-4f51-a9ce-96aadc06f080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea8f10>]}
[0m19:01:09.446997 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:01:09.471538 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:01:09.577021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:01:09.577703 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/dim_airport.sql
[0m19:01:09.606773 [debug] [MainThread]: 1603: static parser failed on dimensions/dim_airport.sql
[0m19:01:09.626281 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimensions/dim_airport.sql
[0m19:01:09.676500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12378b90-d6b3-4f51-a9ce-96aadc06f080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3f910>]}
[0m19:01:09.687319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12378b90-d6b3-4f51-a9ce-96aadc06f080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097349d0>]}
[0m19:01:09.687830 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:01:09.688265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12378b90-d6b3-4f51-a9ce-96aadc06f080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a9650>]}
[0m19:01:09.690699 [info ] [MainThread]: 
[0m19:01:09.691738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:01:09.693376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:01:09.708508 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:01:09.708946 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:01:09.709281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:09.789685 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:01:09.791406 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:01:09.793165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:01:09.799855 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:01:09.800506 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:01:09.800842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:09.811958 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:01:09.812566 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:01:09.813077 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:01:09.819615 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:01:09.821096 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:01:09.821676 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:01:09.827262 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:09.827635 [debug] [MainThread]: On master: BEGIN
[0m19:01:09.827929 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:09.839336 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:09.839830 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:09.840389 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:01:09.862521 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:01:09.864520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12378b90-d6b3-4f51-a9ce-96aadc06f080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107356d50>]}
[0m19:01:09.865026 [debug] [MainThread]: On master: ROLLBACK
[0m19:01:09.865624 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:09.866136 [debug] [MainThread]: On master: BEGIN
[0m19:01:09.866850 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:09.867159 [debug] [MainThread]: On master: COMMIT
[0m19:01:09.867433 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:09.867692 [debug] [MainThread]: On master: COMMIT
[0m19:01:09.868056 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:01:09.868336 [debug] [MainThread]: On master: Close
[0m19:01:09.869044 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:09.869442 [info ] [MainThread]: 
[0m19:01:09.874840 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:01:09.875688 [info ] [Thread-1 (]: 1 of 4 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:01:09.876713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:01:09.877240 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:01:09.881416 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:01:09.882618 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:01:09.877555 => 19:01:09.882313
[0m19:01:09.887392 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:01:09.940096 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:01:09.941455 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:09.942193 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:01:09.942659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:09.953511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:09.954158 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:09.954737 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:01:09' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:01:09.980255 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:01:09.986610 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:09.987033 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:01:09.987724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:09.990851 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:09.991486 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:01:09.992296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:10.018401 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:01:10.018830 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:10.019190 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:01:10.021491 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:10.027668 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:10.028130 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:01:10.031994 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:01:10.034372 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:01:09.887756 => 19:01:10.034016
[0m19:01:10.035090 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:01:10.036005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12378b90-d6b3-4f51-a9ce-96aadc06f080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f6490>]}
[0m19:01:10.036706 [info ] [Thread-1 (]: 1 of 4 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.16s]
[0m19:01:10.037588 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:01:10.038110 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:01:10.038595 [info ] [Thread-1 (]: 2 of 4 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:01:10.039734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:01:10.040240 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:01:10.043232 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:01:10.044369 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:01:10.040512 => 19:01:10.044057
[0m19:01:10.045078 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:01:10.050851 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:01:10.051780 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:10.052190 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:01:10.052509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:10.063896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:10.064554 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:10.065230 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:01:09' as dbt_time
from stg.airports_data
  );
  
[0m19:01:10.080291 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:01:10.084388 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:10.085026 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:01:10.086173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:10.088009 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:01:10.088353 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:10.088657 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:01:10.089794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:10.093110 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:10.093615 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:01:10.096980 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:01:10.099805 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:01:10.045595 => 19:01:10.099461
[0m19:01:10.100542 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:01:10.102053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12378b90-d6b3-4f51-a9ce-96aadc06f080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976bf10>]}
[0m19:01:10.103110 [info ] [Thread-1 (]: 2 of 4 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.06s]
[0m19:01:10.104281 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:01:10.104983 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m19:01:10.105564 [info ] [Thread-1 (]: 3 of 4 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m19:01:10.106718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.my_first_dbt_model)
[0m19:01:10.107129 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m19:01:10.110380 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m19:01:10.112341 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 19:01:10.107356 => 19:01:10.111500
[0m19:01:10.113032 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m19:01:10.120208 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m19:01:10.121082 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:10.121487 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m19:01:10.121854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:10.131633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:10.132152 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:10.132638 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:01:10.135848 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m19:01:10.140175 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:10.140772 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:01:10.141520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:10.144951 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:10.145446 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:01:10.146651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:10.148986 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:01:10.149416 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:10.150009 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:01:10.151368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:10.153800 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:10.154455 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:01:10.157539 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:01:10.158983 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 19:01:10.113396 => 19:01:10.158757
[0m19:01:10.159520 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m19:01:10.160424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12378b90-d6b3-4f51-a9ce-96aadc06f080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a4b90>]}
[0m19:01:10.161174 [info ] [Thread-1 (]: 3 of 4 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.05s]
[0m19:01:10.161951 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m19:01:10.163511 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m19:01:10.164465 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:01:10.165595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m19:01:10.166294 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m19:01:10.170201 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m19:01:10.171272 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 19:01:10.166745 => 19:01:10.170977
[0m19:01:10.171773 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m19:01:10.198466 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m19:01:10.200024 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:01:10.200605 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m19:01:10.201350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:10.214744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:10.215425 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:01:10.215797 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:01:10.218866 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:01:10.221416 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:01:10.221764 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:01:10.222360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:10.224115 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:01:10.224581 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:01:10.225249 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:01:10.227374 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:10.229920 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:01:10.230274 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:01:10.230809 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:01:10.232424 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 19:01:10.172069 => 19:01:10.232218
[0m19:01:10.233121 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m19:01:10.234277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12378b90-d6b3-4f51-a9ce-96aadc06f080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a9190>]}
[0m19:01:10.235179 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.07s]
[0m19:01:10.236047 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m19:01:10.237702 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:10.238203 [debug] [MainThread]: On master: BEGIN
[0m19:01:10.238597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:01:10.250554 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:10.251192 [debug] [MainThread]: On master: COMMIT
[0m19:01:10.251485 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:10.251745 [debug] [MainThread]: On master: COMMIT
[0m19:01:10.252166 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:01:10.252563 [debug] [MainThread]: On master: Close
[0m19:01:10.253334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:10.253624 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m19:01:10.254114 [info ] [MainThread]: 
[0m19:01:10.254615 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m19:01:10.255938 [debug] [MainThread]: Command end result
[0m19:01:10.264246 [info ] [MainThread]: 
[0m19:01:10.265013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:10.265598 [info ] [MainThread]: 
[0m19:01:10.266182 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:01:10.267234 [debug] [MainThread]: Command `dbt run` succeeded at 19:01:10.267003 after 1.00 seconds
[0m19:01:10.267868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d47bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893f550>]}
[0m19:01:10.268426 [debug] [MainThread]: Flushing usage events
[0m19:01:52.961814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b84a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b29e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b29ee90>]}


============================== 19:01:52.973003 | ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f ==============================
[0m19:01:52.973003 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:01:52.974434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:01:53.077008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b666310>]}
[0m19:01:53.097965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b666310>]}
[0m19:01:53.099123 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:01:53.125582 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:01:53.210539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:01:53.211468 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/dimensions/schema.yml
[0m19:01:53.285120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b332c90>]}
[0m19:01:53.293662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf78050>]}
[0m19:01:53.294212 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:01:53.294637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b28af90>]}
[0m19:01:53.297843 [info ] [MainThread]: 
[0m19:01:53.299191 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:01:53.300718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:01:53.314664 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:01:53.315306 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:01:53.315885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:53.401701 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:01:53.403200 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:01:53.405103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:01:53.412950 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:01:53.413327 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:01:53.413598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:53.425772 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:01:53.426213 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:01:53.426541 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:01:53.430552 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:01:53.433349 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:01:53.434287 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:01:53.440322 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:53.440761 [debug] [MainThread]: On master: BEGIN
[0m19:01:53.441067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:53.452156 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:53.452677 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:53.453091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:01:53.479954 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:01:53.482521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e02d0>]}
[0m19:01:53.483114 [debug] [MainThread]: On master: ROLLBACK
[0m19:01:53.483599 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:53.483892 [debug] [MainThread]: On master: BEGIN
[0m19:01:53.484413 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:53.484740 [debug] [MainThread]: On master: COMMIT
[0m19:01:53.485026 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:53.485290 [debug] [MainThread]: On master: COMMIT
[0m19:01:53.485695 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:01:53.485977 [debug] [MainThread]: On master: Close
[0m19:01:53.486760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:53.487238 [info ] [MainThread]: 
[0m19:01:53.494552 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:01:53.495934 [info ] [Thread-1 (]: 1 of 4 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:01:53.497036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:01:53.497613 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:01:53.501692 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:01:53.502563 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:01:53.497953 => 19:01:53.502288
[0m19:01:53.503111 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:01:53.563827 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:01:53.565236 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:53.565842 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:01:53.566449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.583568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:53.584124 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:53.585148 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:01:52' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:01:53.607081 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:01:53.617099 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:53.618098 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:01:53.619432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:53.624469 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:53.626214 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:01:53.634068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:53.664346 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:01:53.665430 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:53.665885 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:01:53.668999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:53.675831 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:01:53.677037 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:01:53.685273 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:01:53.687025 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:01:53.503375 => 19:01:53.686765
[0m19:01:53.687404 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:01:53.688306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf2af90>]}
[0m19:01:53.689126 [info ] [Thread-1 (]: 1 of 4 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.19s]
[0m19:01:53.690074 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:01:53.690715 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:01:53.691316 [info ] [Thread-1 (]: 2 of 4 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:01:53.692608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:01:53.693255 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:01:53.696767 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:01:53.698260 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:01:53.693597 => 19:01:53.697898
[0m19:01:53.699023 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:01:53.704914 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:01:53.706092 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:53.706614 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:01:53.706985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.725802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:53.726616 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:53.727398 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:01:52' as dbt_time
from stg.airports_data
  );
  
[0m19:01:53.774168 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:01:53.777663 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:53.778112 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m19:01:53.778847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:53.782729 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:53.783119 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:01:53.854933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:53.858133 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:01:53.858760 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:53.859344 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:01:53.862382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:53.866339 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:01:53.866927 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:01:53.870111 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:01:53.872882 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:01:53.699483 => 19:01:53.872597
[0m19:01:53.873442 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:01:53.875880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf703d0>]}
[0m19:01:53.876844 [info ] [Thread-1 (]: 2 of 4 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.18s]
[0m19:01:53.878451 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:01:53.879118 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m19:01:53.879920 [info ] [Thread-1 (]: 3 of 4 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m19:01:53.886592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.my_first_dbt_model)
[0m19:01:53.900735 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m19:01:53.908421 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m19:01:53.909815 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 19:01:53.901200 => 19:01:53.909404
[0m19:01:53.910301 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m19:01:53.919175 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m19:01:53.920862 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:53.922422 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m19:01:53.923043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.936174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:53.936806 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:53.937678 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:01:53.941399 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m19:01:53.944914 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:53.945524 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:01:53.946422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:53.951833 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:53.952604 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:01:53.953535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:53.957410 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:01:53.958233 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:53.959058 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:01:53.961149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:53.964958 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:01:53.965562 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:01:53.967996 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:01:53.969346 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 19:01:53.910561 => 19:01:53.969157
[0m19:01:53.969745 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m19:01:53.970443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c09f950>]}
[0m19:01:53.971167 [info ] [Thread-1 (]: 3 of 4 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.08s]
[0m19:01:53.973254 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m19:01:53.976012 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m19:01:53.977088 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:01:53.978354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m19:01:53.979908 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m19:01:53.986858 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m19:01:53.987688 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 19:01:53.980736 => 19:01:53.987475
[0m19:01:53.988155 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m19:01:54.012753 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m19:01:54.014305 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:01:54.015432 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m19:01:54.016106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:54.032189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:54.032624 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:01:54.032990 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:01:54.036534 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:01:54.041016 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:01:54.041571 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:01:54.042747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:54.046078 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:01:54.046837 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:01:54.047176 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:01:54.048580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:54.051889 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:01:54.052298 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:01:54.052856 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:01:54.054894 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 19:01:53.988390 => 19:01:54.054410
[0m19:01:54.055647 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m19:01:54.056618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad20ae39-7cf3-4d8a-a9c4-ee829ba73f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1580d0>]}
[0m19:01:54.057405 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m19:01:54.058271 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m19:01:54.060426 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:54.060961 [debug] [MainThread]: On master: BEGIN
[0m19:01:54.061484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:01:54.073251 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:54.073698 [debug] [MainThread]: On master: COMMIT
[0m19:01:54.074005 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:54.074418 [debug] [MainThread]: On master: COMMIT
[0m19:01:54.078508 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:01:54.079215 [debug] [MainThread]: On master: Close
[0m19:01:54.080381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:54.081557 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m19:01:54.082511 [info ] [MainThread]: 
[0m19:01:54.083257 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m19:01:54.084921 [debug] [MainThread]: Command end result
[0m19:01:54.095993 [info ] [MainThread]: 
[0m19:01:54.096935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:54.097637 [info ] [MainThread]: 
[0m19:01:54.098175 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:01:54.099350 [debug] [MainThread]: Command `dbt run` succeeded at 19:01:54.099175 after 1.17 seconds
[0m19:01:54.099947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b666210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777fd90>]}
[0m19:01:54.100712 [debug] [MainThread]: Flushing usage events
[0m19:35:20.173578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa57c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa549d0>]}


============================== 19:35:20.185745 | 4a47a978-a075-4492-8c8e-0bb468398a96 ==============================
[0m19:35:20.185745 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:35:20.186786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:35:20.315885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad27810>]}
[0m19:35:20.332768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac9210>]}
[0m19:35:20.334822 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:35:20.364429 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:35:20.491910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:35:20.492969 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_flights.sql
[0m19:35:20.529315 [debug] [MainThread]: 1603: static parser failed on facts/fact_flights.sql
[0m19:35:20.547686 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_flights.sql
[0m19:35:20.560442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adeedd0>]}
[0m19:35:20.571167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b496250>]}
[0m19:35:20.571640 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:35:20.572028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108555690>]}
[0m19:35:20.575402 [info ] [MainThread]: 
[0m19:35:20.576460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:20.578364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:35:20.590909 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:35:20.591371 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:35:20.592238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:20.774449 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:35:20.776663 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:35:20.778585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:35:20.783796 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:35:20.784243 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:35:20.784632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:20.795004 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:35:20.795619 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:35:20.795999 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:35:20.800913 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:35:20.802239 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:35:20.802691 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:35:20.808783 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:20.809652 [debug] [MainThread]: On master: BEGIN
[0m19:35:20.809970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:20.819477 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:20.819839 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:20.820217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:35:20.843693 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:35:20.845658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e8c390>]}
[0m19:35:20.846439 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:20.846917 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:20.847257 [debug] [MainThread]: On master: BEGIN
[0m19:35:20.847787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:20.848091 [debug] [MainThread]: On master: COMMIT
[0m19:35:20.848367 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:20.848629 [debug] [MainThread]: On master: COMMIT
[0m19:35:20.848988 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:35:20.849271 [debug] [MainThread]: On master: Close
[0m19:35:20.849904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:20.850526 [info ] [MainThread]: 
[0m19:35:20.855729 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:35:20.856565 [info ] [Thread-1 (]: 1 of 5 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:35:20.857537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:35:20.858228 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:35:20.862243 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:35:20.864302 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:35:20.858771 => 19:35:20.863567
[0m19:35:20.865095 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:35:20.914434 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:35:20.915256 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:35:20.915671 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:35:20.916004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:20.929347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:20.930003 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:35:20.930670 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:35:20' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:35:20.993589 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:35:21.000748 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:35:21.001219 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:35:21.002209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:21.006812 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:35:21.007389 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:35:21.008416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:21.030935 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:35:21.031370 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:35:21.031690 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:35:21.034560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:21.039607 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:35:21.040057 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:35:21.046591 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:35:21.048084 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:35:20.865581 => 19:35:21.047887
[0m19:35:21.048435 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:35:21.049164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adf9f90>]}
[0m19:35:21.049867 [info ] [Thread-1 (]: 1 of 5 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.19s]
[0m19:35:21.050652 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:35:21.051261 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:35:21.051767 [info ] [Thread-1 (]: 2 of 5 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:35:21.052861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:35:21.053483 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:35:21.056500 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:35:21.057803 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:35:21.053807 => 19:35:21.057456
[0m19:35:21.058509 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:35:21.066028 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:35:21.067149 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:35:21.067707 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:35:21.068049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:21.082265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:21.082673 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:35:21.083013 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:35:20' as dbt_time
from stg.airports_data
  );
  
[0m19:35:21.131553 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:35:21.134763 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:35:21.135797 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m19:35:21.137398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:21.140634 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:35:21.141089 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:35:21.142360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:21.145280 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:35:21.146029 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:35:21.146387 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:35:21.147705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:21.150366 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:35:21.151217 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:35:21.153965 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:35:21.155686 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:35:21.058895 => 19:35:21.155444
[0m19:35:21.156079 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:35:21.156782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae08390>]}
[0m19:35:21.157397 [info ] [Thread-1 (]: 2 of 5 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.10s]
[0m19:35:21.158261 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:35:21.159278 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m19:35:21.160317 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m19:35:21.161479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_flights)
[0m19:35:21.162004 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m19:35:21.164525 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m19:35:21.165598 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 19:35:21.162284 => 19:35:21.165274
[0m19:35:21.166356 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m19:35:21.170635 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m19:35:21.171313 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:35:21.171645 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m19:35:21.172030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:21.184552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:21.185158 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:35:21.185846 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 16:35:20' as dbt_time
from time_flight
  );
  
[0m19:35:21.435358 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m19:35:21.438164 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:35:21.438569 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m19:35:21.442181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:21.445118 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m19:35:21.445677 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:35:21.446280 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m19:35:21.449015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:21.451877 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:35:21.452399 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m19:35:21.453090 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:35:21.454498 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 19:35:21.166752 => 19:35:21.454307
[0m19:35:21.454850 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m19:35:21.455676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4bff10>]}
[0m19:35:21.456399 [info ] [Thread-1 (]: 3 of 5 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.29s]
[0m19:35:21.457163 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m19:35:21.457714 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m19:35:21.458403 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m19:35:21.459317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m19:35:21.460095 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m19:35:21.463265 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m19:35:21.464593 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 19:35:21.460503 => 19:35:21.464224
[0m19:35:21.465430 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m19:35:21.472296 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m19:35:21.473220 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:35:21.473618 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m19:35:21.473938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:21.488852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:21.489529 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:35:21.490027 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:35:21.496763 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m19:35:21.500565 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:35:21.501200 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:35:21.502117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:21.504719 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:35:21.505312 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:35:21.507227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:21.511442 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:35:21.511900 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:35:21.512241 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:35:21.513462 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:21.515817 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:35:21.516378 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:35:21.519414 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:35:21.520879 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 19:35:21.465871 => 19:35:21.520675
[0m19:35:21.521289 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m19:35:21.522062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b617390>]}
[0m19:35:21.522664 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.06s]
[0m19:35:21.523385 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m19:35:21.524173 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m19:35:21.525071 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:35:21.526369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m19:35:21.526970 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m19:35:21.530518 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m19:35:21.532175 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 19:35:21.527604 => 19:35:21.531525
[0m19:35:21.532724 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m19:35:21.555676 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m19:35:21.556877 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:35:21.557571 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m19:35:21.558152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:21.570807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:21.571218 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:35:21.571558 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:35:21.613738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:35:21.617618 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:35:21.618623 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:35:21.619647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:21.622312 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:35:21.622846 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:35:21.623525 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:35:21.626063 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:21.628761 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:35:21.629123 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:35:21.629930 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:35:21.632476 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 19:35:21.533186 => 19:35:21.632230
[0m19:35:21.632965 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m19:35:21.633785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a47a978-a075-4492-8c8e-0bb468398a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b57cb10>]}
[0m19:35:21.634918 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.11s]
[0m19:35:21.636276 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m19:35:21.638022 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:21.638420 [debug] [MainThread]: On master: BEGIN
[0m19:35:21.638727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:21.652644 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:21.653015 [debug] [MainThread]: On master: COMMIT
[0m19:35:21.653288 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:21.653548 [debug] [MainThread]: On master: COMMIT
[0m19:35:21.653900 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:35:21.654178 [debug] [MainThread]: On master: Close
[0m19:35:21.654768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:21.655092 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m19:35:21.655503 [info ] [MainThread]: 
[0m19:35:21.655943 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m19:35:21.657556 [debug] [MainThread]: Command end result
[0m19:35:21.666601 [info ] [MainThread]: 
[0m19:35:21.667494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:35:21.668107 [info ] [MainThread]: 
[0m19:35:21.668818 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:35:21.669644 [debug] [MainThread]: Command `dbt run` succeeded at 19:35:21.669510 after 1.53 seconds
[0m19:35:21.670035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a807810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c00410>]}
[0m19:35:21.670384 [debug] [MainThread]: Flushing usage events
[0m19:36:13.709631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107deb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107deaa90>]}


============================== 19:36:13.717998 | d58036fa-6d53-4492-81ac-adff273b2344 ==============================
[0m19:36:13.717998 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:36:13.718705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:36:13.814110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd58036fa-6d53-4492-81ac-adff273b2344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e66f10>]}
[0m19:36:13.834563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd58036fa-6d53-4492-81ac-adff273b2344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e027d0>]}
[0m19:36:13.835844 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:36:13.862480 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:36:13.893306 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading flights_dbt: facts/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  |   - name: fact_flights
    4  |     description: "fact_flights"
    5  |     columns:
    6  |       - name: fligth_id
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 9
[0m19:36:13.894593 [debug] [MainThread]: Command `dbt run` failed at 19:36:13.894397 after 0.22 seconds
[0m19:36:13.895256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e01350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a6590>]}
[0m19:36:13.896563 [debug] [MainThread]: Flushing usage events
[0m19:40:30.419973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100fb510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103fbe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e0c50>]}


============================== 19:40:30.435750 | 90ec3685-1354-4d67-8f22-2cfb6136bc59 ==============================
[0m19:40:30.435750 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:40:30.436596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:40:30.574592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106cbc50>]}
[0m19:40:30.593868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e5190>]}
[0m19:40:30.596066 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:40:30.628856 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:40:30.717217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:40:30.717880 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/schema.yml
[0m19:40:30.788232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d6210>]}
[0m19:40:30.799366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f46190>]}
[0m19:40:30.799910 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:40:30.800568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10def9750>]}
[0m19:40:30.803842 [info ] [MainThread]: 
[0m19:40:30.805209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:30.806798 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:40:30.818589 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:40:30.819205 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:40:30.819570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:30.920788 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:40:30.923134 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:40:30.925930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:40:30.932302 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:40:30.932705 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:40:30.933126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:30.944277 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:40:30.944639 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:40:30.944931 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:40:30.950993 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:40:30.952685 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:40:30.953159 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:40:30.958148 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:30.958612 [debug] [MainThread]: On master: BEGIN
[0m19:40:30.958895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:30.968417 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:40:30.968769 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:30.969125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:40:30.992409 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:40:30.995543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e11e50>]}
[0m19:40:30.996036 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:30.996598 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:30.996898 [debug] [MainThread]: On master: BEGIN
[0m19:40:30.997656 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:40:30.997960 [debug] [MainThread]: On master: COMMIT
[0m19:40:30.998236 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:30.998496 [debug] [MainThread]: On master: COMMIT
[0m19:40:30.998844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:40:30.999121 [debug] [MainThread]: On master: Close
[0m19:40:30.999815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:31.000449 [info ] [MainThread]: 
[0m19:40:31.009000 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:40:31.009831 [info ] [Thread-1 (]: 1 of 5 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:40:31.010909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:40:31.011469 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:40:31.015670 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:40:31.017111 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:40:31.011810 => 19:40:31.016787
[0m19:40:31.018059 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:40:31.084869 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:40:31.086035 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:40:31.086517 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:40:31.086872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:31.097752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:31.098203 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:40:31.098547 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:40:30' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:40:31.154102 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:40:31.160409 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:40:31.161925 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:40:31.162993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:31.177279 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:40:31.178851 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:40:31.180131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:31.209808 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:40:31.210310 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:40:31.210698 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:40:31.213261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:31.219788 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:40:31.220229 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:40:31.225224 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:40:31.226709 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:40:31.018715 => 19:40:31.226519
[0m19:40:31.227053 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:40:31.227923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e30090>]}
[0m19:40:31.229142 [info ] [Thread-1 (]: 1 of 5 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.22s]
[0m19:40:31.230099 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:40:31.230670 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:40:31.231154 [info ] [Thread-1 (]: 2 of 5 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:40:31.232096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:40:31.232610 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:40:31.235190 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:40:31.236002 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:40:31.232837 => 19:40:31.235789
[0m19:40:31.236408 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:40:31.242763 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:40:31.243525 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:40:31.243893 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:40:31.244197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:31.256420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:31.256914 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:40:31.257493 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:40:30' as dbt_time
from stg.airports_data
  );
  
[0m19:40:31.306568 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:40:31.310214 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:40:31.310657 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m19:40:31.311897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:31.314672 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:40:31.315023 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:40:31.316016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:31.321081 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:40:31.322099 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:40:31.322621 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:40:31.324042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:31.328006 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:40:31.328784 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:40:31.334137 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:40:31.335838 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:40:31.236642 => 19:40:31.335638
[0m19:40:31.336241 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:40:31.336971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d4290>]}
[0m19:40:31.337535 [info ] [Thread-1 (]: 2 of 5 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.11s]
[0m19:40:31.338367 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:40:31.338815 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m19:40:31.339309 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m19:40:31.340166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_flights)
[0m19:40:31.340864 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m19:40:31.345214 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m19:40:31.346463 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 19:40:31.342560 => 19:40:31.346139
[0m19:40:31.346959 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m19:40:31.354756 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m19:40:31.355794 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:40:31.356609 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m19:40:31.356995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:31.368136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:31.368556 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:40:31.369295 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 16:40:30' as dbt_time
from time_flight
  );
  
[0m19:40:31.566706 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m19:40:31.569980 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:40:31.570453 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m19:40:31.571386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:31.574165 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:40:31.574549 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m19:40:31.578255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:31.580915 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m19:40:31.581518 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:40:31.582171 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m19:40:31.594793 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:31.598181 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:40:31.598652 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m19:40:31.602199 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:40:31.603594 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 19:40:31.347186 => 19:40:31.603404
[0m19:40:31.603929 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m19:40:31.604701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f98490>]}
[0m19:40:31.605263 [info ] [Thread-1 (]: 3 of 5 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.26s]
[0m19:40:31.606024 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m19:40:31.606659 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m19:40:31.607387 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m19:40:31.608587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m19:40:31.609403 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m19:40:31.613842 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m19:40:31.614645 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 19:40:31.609807 => 19:40:31.614430
[0m19:40:31.615011 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m19:40:31.621693 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m19:40:31.622474 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:40:31.622843 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m19:40:31.623144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:31.634194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:31.634642 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:40:31.635009 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:40:31.638285 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m19:40:31.641383 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:40:31.642138 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:40:31.642881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:31.646858 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:40:31.647404 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:40:31.649126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:31.652821 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:40:31.653490 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:40:31.654037 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:40:31.655518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:31.658387 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:40:31.658986 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:40:31.664321 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:40:31.665880 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 19:40:31.615244 => 19:40:31.665683
[0m19:40:31.666234 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m19:40:31.667153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd0510>]}
[0m19:40:31.667853 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.06s]
[0m19:40:31.668522 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m19:40:31.669554 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m19:40:31.670096 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:40:31.670961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m19:40:31.671449 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m19:40:31.674575 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m19:40:31.675966 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 19:40:31.671693 => 19:40:31.675383
[0m19:40:31.676664 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m19:40:31.699517 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m19:40:31.700666 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:40:31.701951 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m19:40:31.702365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:31.713770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:31.714514 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:40:31.715090 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:40:31.735830 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:40:31.738741 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:40:31.739088 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:40:31.739850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:31.742371 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:40:31.743131 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:40:31.743551 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:40:31.744772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:31.747218 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:40:31.747628 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:40:31.748167 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:40:31.749487 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 19:40:31.677001 => 19:40:31.749287
[0m19:40:31.749903 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m19:40:31.750696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90ec3685-1354-4d67-8f22-2cfb6136bc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb0290>]}
[0m19:40:31.751616 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m19:40:31.752429 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m19:40:31.753971 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:31.754347 [debug] [MainThread]: On master: BEGIN
[0m19:40:31.754604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:31.765238 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:40:31.765606 [debug] [MainThread]: On master: COMMIT
[0m19:40:31.765881 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:31.766141 [debug] [MainThread]: On master: COMMIT
[0m19:40:31.766876 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:40:31.767362 [debug] [MainThread]: On master: Close
[0m19:40:31.768199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:31.769356 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m19:40:31.769761 [info ] [MainThread]: 
[0m19:40:31.770560 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m19:40:31.772813 [debug] [MainThread]: Command end result
[0m19:40:31.781992 [info ] [MainThread]: 
[0m19:40:31.782802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:31.783439 [info ] [MainThread]: 
[0m19:40:31.784155 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:40:31.785183 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:31.785018 after 1.40 seconds
[0m19:40:31.785676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c64ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c59be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5a8850>]}
[0m19:40:31.786531 [debug] [MainThread]: Flushing usage events
[0m19:44:53.853833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d67710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121a5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112116950>]}


============================== 19:44:53.872702 | 524e09ea-7381-4302-be59-6fda568eaec1 ==============================
[0m19:44:53.872702 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:44:53.873510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:44:53.996445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e1eed0>]}
[0m19:44:54.014535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b57d0>]}
[0m19:44:54.016383 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:44:54.043051 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:44:54.113742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:44:54.114404 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/schema.yml
[0m19:44:54.114795 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m19:44:54.141577 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m19:44:54.157784 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m19:44:54.206471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f13d0>]}
[0m19:44:54.214941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112122210>]}
[0m19:44:54.215588 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:44:54.215983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11219f410>]}
[0m19:44:54.218574 [info ] [MainThread]: 
[0m19:44:54.219816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:44:54.221157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:44:54.236739 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:44:54.237566 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:44:54.238093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:54.286628 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:44:54.288394 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:44:54.290618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:44:54.299032 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:44:54.299420 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:44:54.299729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:54.310071 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:44:54.310444 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:44:54.310736 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:44:54.314429 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:44:54.315879 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:44:54.316637 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:44:54.323132 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:54.323577 [debug] [MainThread]: On master: BEGIN
[0m19:44:54.323855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:54.333573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:44:54.333931 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:54.334291 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:44:54.354651 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:44:54.356776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ec0490>]}
[0m19:44:54.357776 [debug] [MainThread]: On master: ROLLBACK
[0m19:44:54.358647 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:54.359069 [debug] [MainThread]: On master: BEGIN
[0m19:44:54.359955 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:44:54.360528 [debug] [MainThread]: On master: COMMIT
[0m19:44:54.360927 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:54.361236 [debug] [MainThread]: On master: COMMIT
[0m19:44:54.362129 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:44:54.362723 [debug] [MainThread]: On master: Close
[0m19:44:54.363722 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:44:54.364358 [info ] [MainThread]: 
[0m19:44:54.370643 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:44:54.371539 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:44:54.373312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:44:54.373990 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:44:54.377948 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:44:54.379210 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:44:54.374440 => 19:44:54.378955
[0m19:44:54.379704 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:44:54.425041 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:44:54.426028 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:44:54.426433 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:44:54.426845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:54.435776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:44:54.436361 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:44:54.436966 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:44:53' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:44:54.463190 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:44:54.470294 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:44:54.470864 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:44:54.471757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:44:54.474688 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:44:54.475049 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:44:54.475798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:44:54.497565 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:44:54.498141 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:44:54.498592 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:44:54.500918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:44:54.505981 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:44:54.506387 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:44:54.510613 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:44:54.512747 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:44:54.380033 => 19:44:54.512289
[0m19:44:54.513323 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:44:54.514108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125128d0>]}
[0m19:44:54.514783 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.14s]
[0m19:44:54.515488 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:44:54.516132 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:44:54.516918 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:44:54.517860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:44:54.518348 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:44:54.521572 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:44:54.523131 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:44:54.518615 => 19:44:54.522736
[0m19:44:54.523852 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:44:54.530091 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:44:54.531362 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:44:54.532129 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:44:54.532827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:54.545565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:44:54.546041 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:44:54.546473 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:44:53' as dbt_time
from stg.airports_data
  );
  
[0m19:44:54.560839 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:44:54.564382 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:44:54.564918 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m19:44:54.565668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:44:54.568491 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:44:54.568856 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:44:54.569634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:44:54.572239 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:44:54.572657 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:44:54.572975 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:44:54.574367 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:44:54.578609 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:44:54.579059 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:44:54.582158 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:44:54.583683 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:44:54.524297 => 19:44:54.583442
[0m19:44:54.584020 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:44:54.584768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d30ad0>]}
[0m19:44:54.585376 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.07s]
[0m19:44:54.586215 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:44:54.587097 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m19:44:54.587950 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:44:54.589157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m19:44:54.589712 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m19:44:54.593006 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m19:44:54.594811 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 19:44:54.590030 => 19:44:54.594238
[0m19:44:54.595392 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m19:44:54.601658 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m19:44:54.602596 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:44:54.603103 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m19:44:54.603687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:54.615987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:44:54.616754 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:44:54.617288 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select *,
'2023-08-16 16:44:53' as dbt_time
from stg.boarding_passes as bp
inner join stg.ticket_flights as tf on bp.flight_id =tf.flight_id
  );
  
[0m19:44:54.644521 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "ticket_no" specified more than once

[0m19:44:54.645017 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: ROLLBACK
[0m19:44:54.645894 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 19:44:54.595951 => 19:44:54.645630
[0m19:44:54.646286 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m19:44:54.659684 [debug] [Thread-1 (]: Database Error in model fact_boarding_passes (models/facts/fact_boarding_passes.sql)
  column "ticket_no" specified more than once
  compiled Code at target/run/flights_dbt/models/facts/fact_boarding_passes.sql
[0m19:44:54.660451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d111d0>]}
[0m19:44:54.661357 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model flights_wh.fact_boarding_passes .......... [[31mERROR[0m in 0.07s]
[0m19:44:54.662048 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m19:44:54.662756 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m19:44:54.663615 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m19:44:54.664860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m19:44:54.665368 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m19:44:54.668370 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m19:44:54.669648 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 19:44:54.665626 => 19:44:54.669381
[0m19:44:54.670412 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m19:44:54.674875 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m19:44:54.675816 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:44:54.676298 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m19:44:54.676970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:54.688782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:44:54.689186 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:44:54.689635 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 16:44:53' as dbt_time
from time_flight
  );
  
[0m19:44:54.904495 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m19:44:54.907419 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:44:54.907873 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m19:44:54.908845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:44:54.911871 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:44:54.912289 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m19:44:54.915853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:44:54.918769 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m19:44:54.919465 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:44:54.919935 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m19:44:54.926964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:44:54.929651 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:44:54.930318 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m19:44:55.118840 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:44:55.120467 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 19:44:54.670776 => 19:44:55.120267
[0m19:44:55.120851 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m19:44:55.121520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce9110>]}
[0m19:44:55.122093 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.46s]
[0m19:44:55.122896 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m19:44:55.123510 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m19:44:55.124068 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m19:44:55.124989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m19:44:55.125433 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m19:44:55.128347 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m19:44:55.129794 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 19:44:55.125802 => 19:44:55.129312
[0m19:44:55.130563 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m19:44:55.136905 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m19:44:55.137930 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:44:55.138313 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m19:44:55.138614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:55.150502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:44:55.151035 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:44:55.151579 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:44:55.154930 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m19:44:55.158310 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:44:55.158860 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:44:55.160686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:44:55.165324 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:44:55.165809 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:44:55.166735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:44:55.168783 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:44:55.169126 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:44:55.169439 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:44:55.170742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:44:55.173024 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:44:55.173392 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:44:55.176786 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:44:55.178839 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 19:44:55.130924 => 19:44:55.178640
[0m19:44:55.179316 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m19:44:55.180416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bd3f90>]}
[0m19:44:55.181326 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.06s]
[0m19:44:55.182012 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m19:44:55.182890 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m19:44:55.183418 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:44:55.184216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m19:44:55.184595 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m19:44:55.187240 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m19:44:55.188168 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 19:44:55.184820 => 19:44:55.187939
[0m19:44:55.188537 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m19:44:55.210213 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m19:44:55.211303 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:44:55.211759 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m19:44:55.212277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:55.224431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:44:55.224975 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:44:55.225336 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:44:55.230672 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:44:55.234322 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:44:55.234719 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:44:55.235444 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:44:55.237728 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:44:55.238352 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:44:55.238745 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:44:55.240606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:44:55.243153 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:44:55.243653 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:44:55.244403 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:44:55.246339 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 19:44:55.188757 => 19:44:55.246059
[0m19:44:55.246889 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m19:44:55.247680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524e09ea-7381-4302-be59-6fda568eaec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bf0810>]}
[0m19:44:55.248350 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.06s]
[0m19:44:55.249161 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m19:44:55.250954 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:55.251325 [debug] [MainThread]: On master: BEGIN
[0m19:44:55.251741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:44:55.262867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:44:55.263276 [debug] [MainThread]: On master: COMMIT
[0m19:44:55.263809 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:55.264284 [debug] [MainThread]: On master: COMMIT
[0m19:44:55.264820 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:44:55.265121 [debug] [MainThread]: On master: Close
[0m19:44:55.265823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:55.266212 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m19:44:55.266668 [info ] [MainThread]: 
[0m19:44:55.267067 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m19:44:55.268572 [debug] [MainThread]: Command end result
[0m19:44:55.276076 [info ] [MainThread]: 
[0m19:44:55.276876 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:44:55.277721 [info ] [MainThread]: 
[0m19:44:55.278232 [error] [MainThread]: [33mDatabase Error in model fact_boarding_passes (models/facts/fact_boarding_passes.sql)[0m
[0m19:44:55.278646 [error] [MainThread]:   column "ticket_no" specified more than once
[0m19:44:55.279071 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/facts/fact_boarding_passes.sql
[0m19:44:55.279491 [info ] [MainThread]: 
[0m19:44:55.280051 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:44:55.280974 [debug] [MainThread]: Command `dbt run` failed at 19:44:55.280798 after 1.45 seconds
[0m19:44:55.281678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112207d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e23d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2e0410>]}
[0m19:44:55.282480 [debug] [MainThread]: Flushing usage events
[0m19:50:05.628769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb74b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a941d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a5db90>]}


============================== 19:50:05.649395 | 5c5eabd0-f0d1-4d72-98df-985c07ceac41 ==============================
[0m19:50:05.649395 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:50:05.650292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:50:05.789170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c5eabd0-f0d1-4d72-98df-985c07ceac41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137aded0>]}
[0m19:50:05.807877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c5eabd0-f0d1-4d72-98df-985c07ceac41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b70550>]}
[0m19:50:05.810016 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:50:05.839525 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:50:05.911158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:50:05.911846 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m19:50:05.942229 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m19:50:05.962114 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m19:50:06.014303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c5eabd0-f0d1-4d72-98df-985c07ceac41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144cf3d0>]}
[0m19:50:06.026950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c5eabd0-f0d1-4d72-98df-985c07ceac41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11453d050>]}
[0m19:50:06.027584 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:50:06.030305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c5eabd0-f0d1-4d72-98df-985c07ceac41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111599750>]}
[0m19:50:06.032902 [info ] [MainThread]: 
[0m19:50:06.035082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:50:06.040105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:50:06.052816 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:50:06.053621 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:50:06.054577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:06.223938 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:50:06.225519 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:50:06.227919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:50:06.234606 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:50:06.235083 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:50:06.235377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:06.244922 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:50:06.245364 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:50:06.245662 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:50:06.250110 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:50:06.251413 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:50:06.251938 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:50:06.258451 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:06.258824 [debug] [MainThread]: On master: BEGIN
[0m19:50:06.259087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:06.268537 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:50:06.268963 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:06.269510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:50:06.295086 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:50:06.297198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c5eabd0-f0d1-4d72-98df-985c07ceac41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e2c410>]}
[0m19:50:06.297657 [debug] [MainThread]: On master: ROLLBACK
[0m19:50:06.298134 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:06.298408 [debug] [MainThread]: On master: BEGIN
[0m19:50:06.298982 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:50:06.299275 [debug] [MainThread]: On master: COMMIT
[0m19:50:06.299547 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:06.299801 [debug] [MainThread]: On master: COMMIT
[0m19:50:06.300300 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:50:06.300606 [debug] [MainThread]: On master: Close
[0m19:50:06.301276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:50:06.301717 [info ] [MainThread]: 
[0m19:50:06.306985 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:50:06.307560 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:50:06.308857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:50:06.309491 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:50:06.312872 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:50:06.314625 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:50:06.309878 => 19:50:06.314286
[0m19:50:06.315067 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:50:06.361605 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:50:06.362365 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:50:06.362732 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:50:06.363035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:06.372910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:50:06.373696 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:50:06.374276 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:50:05' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:50:06.397701 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:50:06.405084 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:50:06.405620 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:50:06.406825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:50:06.410607 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:50:06.411014 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:50:06.411741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:50:06.436189 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:50:06.436641 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:50:06.436952 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:50:06.439421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:50:06.444577 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:50:06.444993 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:50:06.449380 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:50:06.450857 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:50:06.315289 => 19:50:06.450661
[0m19:50:06.451234 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:50:06.452139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5eabd0-f0d1-4d72-98df-985c07ceac41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137adfd0>]}
[0m19:50:06.452919 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.14s]
[0m19:50:06.454242 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:50:06.455051 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:50:06.455701 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:50:06.456514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:50:06.456900 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:50:06.459840 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:50:06.460828 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:50:06.457163 => 19:50:06.460573
[0m19:50:06.461263 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:50:06.466751 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:50:06.467971 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:50:06.468680 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:50:06.469194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:06.485929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:50:06.486421 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:50:06.487060 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:50:05' as dbt_time
from stg.airports_data
  );
  
[0m19:50:06.497898 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:50:06.500708 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:50:06.501179 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m19:50:06.502116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:50:06.506182 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:50:06.506702 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:50:06.508085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:50:06.510710 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:50:06.511091 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:50:06.511398 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:50:06.512779 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:50:06.516718 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:50:06.517175 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:50:06.519871 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:50:06.521494 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:50:06.461478 => 19:50:06.521296
[0m19:50:06.522192 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:50:06.522987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5eabd0-f0d1-4d72-98df-985c07ceac41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11467c9d0>]}
[0m19:50:06.523672 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.07s]
[0m19:50:06.524477 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:50:06.524968 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m19:50:06.525533 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:50:06.526415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m19:50:06.526871 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m19:50:06.529709 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m19:50:06.531207 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 19:50:06.527159 => 19:50:06.530856
[0m19:50:06.532060 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m19:50:06.537718 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m19:50:06.538713 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:50:06.539289 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m19:50:06.539794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:06.550469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:50:06.551019 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:50:06.551413 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select bp.*, tf.fare_conditions, tf.amount,
'2023-08-16 16:50:05' as dbt_time
from stg.boarding_passes as bp
inner join stg.ticket_flights as tf on bp.flight_id =tf.flight_id
  );
  
[0m19:51:17.651051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d056d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ba710>]}


============================== 19:51:17.660907 | be90b725-46b7-4a60-9709-5fa70d15a1c7 ==============================
[0m19:51:17.660907 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:51:17.662660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:51:17.825907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be90b725-46b7-4a60-9709-5fa70d15a1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706a110>]}
[0m19:51:17.842416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be90b725-46b7-4a60-9709-5fa70d15a1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c1690>]}
[0m19:51:17.843968 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:51:17.872249 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:51:17.957192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:17.957583 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:17.966487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be90b725-46b7-4a60-9709-5fa70d15a1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a69a10>]}
[0m19:51:17.976021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be90b725-46b7-4a60-9709-5fa70d15a1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700c950>]}
[0m19:51:17.976582 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:51:17.977214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be90b725-46b7-4a60-9709-5fa70d15a1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b513d0>]}
[0m19:51:17.981357 [info ] [MainThread]: 
[0m19:51:17.985849 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:51:17.987805 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:51:18.002632 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:51:18.003084 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:51:18.003403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:18.349892 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:51:18.351729 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:51:18.353955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:51:18.361234 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:51:18.361741 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:51:18.362341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:18.379312 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:51:18.379814 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:51:18.380394 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:51:18.386216 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:51:18.388335 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:51:18.390388 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:51:18.400703 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:18.401359 [debug] [MainThread]: On master: BEGIN
[0m19:51:18.401811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:18.413260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:51:18.413860 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:18.414485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:51:18.441704 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:51:18.444855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be90b725-46b7-4a60-9709-5fa70d15a1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db0e10>]}
[0m19:51:18.446161 [debug] [MainThread]: On master: ROLLBACK
[0m19:51:18.447282 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:18.447788 [debug] [MainThread]: On master: BEGIN
[0m19:51:18.448708 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:51:18.449320 [debug] [MainThread]: On master: COMMIT
[0m19:51:18.449763 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:18.450051 [debug] [MainThread]: On master: COMMIT
[0m19:51:18.450519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:51:18.450894 [debug] [MainThread]: On master: Close
[0m19:51:18.451711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:18.454355 [info ] [MainThread]: 
[0m19:51:18.463485 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:51:18.464259 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:51:18.465035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:51:18.465470 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:51:18.468262 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:51:18.469683 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:51:18.465707 => 19:51:18.469420
[0m19:51:18.470156 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:51:18.519289 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:51:18.520675 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:51:18.521127 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:51:18.521452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:18.530710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:51:18.531123 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:51:18.531472 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:51:17' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:51:18.599073 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:51:18.606919 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:51:18.607546 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:51:18.609177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:51:18.613720 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:51:18.614468 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:51:18.616041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:51:18.645089 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:51:18.645623 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:51:18.646074 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:51:18.682331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:51:18.687764 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:51:18.688220 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:51:18.720606 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:51:18.722325 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:51:18.470449 => 19:51:18.722037
[0m19:51:18.722774 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:51:18.723556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be90b725-46b7-4a60-9709-5fa70d15a1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079eb350>]}
[0m19:51:18.724284 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.26s]
[0m19:51:18.725062 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:51:18.725687 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:51:18.726436 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:51:18.727279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:51:18.727713 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:51:18.730474 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:51:18.731427 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:51:18.727982 => 19:51:18.731106
[0m19:51:18.731879 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:51:18.738469 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:51:18.739307 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:51:18.739679 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:51:18.740128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:18.752369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:51:18.753011 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:51:18.753438 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:51:17' as dbt_time
from stg.airports_data
  );
  
[0m19:51:18.812049 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:51:18.815934 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:51:18.816611 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m19:51:18.818281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:51:18.822171 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:51:18.822684 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:51:18.824233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:51:18.826911 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:51:18.827516 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:51:18.827977 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:51:18.851514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:51:18.855221 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:51:18.855650 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:51:18.861406 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:51:18.862993 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:51:18.733290 => 19:51:18.862787
[0m19:51:18.863372 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:51:18.864095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be90b725-46b7-4a60-9709-5fa70d15a1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb4590>]}
[0m19:51:18.864727 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.14s]
[0m19:51:18.865452 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:51:18.865939 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m19:51:18.866498 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:51:18.867455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m19:51:18.867894 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m19:51:18.870456 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m19:51:18.871266 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 19:51:18.868190 => 19:51:18.871036
[0m19:51:18.871862 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m19:51:18.877132 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m19:51:18.878058 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:51:18.878582 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m19:51:18.879032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:18.889574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:51:18.890127 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:51:18.890701 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select bp.*, tf.fare_conditions, tf.amount,
'2023-08-16 16:51:17' as dbt_time
from stg.boarding_passes as bp
inner join stg.ticket_flights as tf on bp.flight_id =tf.flight_id
  );
  
[0m19:56:08.758563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f4f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f63110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c83c10>]}


============================== 19:56:08.777033 | 8b7c4887-073c-46b0-b6c7-444784be7392 ==============================
[0m19:56:08.777033 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:56:08.778334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:56:08.913746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b7c4887-073c-46b0-b6c7-444784be7392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e275d0>]}
[0m19:56:08.930719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b7c4887-073c-46b0-b6c7-444784be7392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0d190>]}
[0m19:56:08.932086 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:56:08.981592 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:56:09.107633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:09.108231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:09.115932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b7c4887-073c-46b0-b6c7-444784be7392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105704110>]}
[0m19:56:09.124148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b7c4887-073c-46b0-b6c7-444784be7392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9f8d0>]}
[0m19:56:09.124666 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:56:09.125070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b7c4887-073c-46b0-b6c7-444784be7392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10253d8d0>]}
[0m19:56:09.127731 [info ] [MainThread]: 
[0m19:56:09.129204 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:56:09.131070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:56:09.144551 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:56:09.145076 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:56:09.145615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:09.382174 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:56:09.384076 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:56:09.386003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:56:09.393603 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:56:09.394096 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:56:09.394493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:09.406635 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:56:09.407013 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:56:09.407349 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:56:09.413446 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:56:09.414898 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:56:09.415396 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:56:09.420765 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:09.421261 [debug] [MainThread]: On master: BEGIN
[0m19:56:09.421527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:09.431545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:56:09.431905 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:09.432304 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:56:09.454609 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:56:09.456211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b7c4887-073c-46b0-b6c7-444784be7392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a562d0>]}
[0m19:56:09.456622 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:09.457182 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:09.457504 [debug] [MainThread]: On master: BEGIN
[0m19:56:09.458114 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:56:09.458469 [debug] [MainThread]: On master: COMMIT
[0m19:56:09.458799 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:09.459064 [debug] [MainThread]: On master: COMMIT
[0m19:56:09.459535 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:56:09.459860 [debug] [MainThread]: On master: Close
[0m19:56:09.460600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:09.461114 [info ] [MainThread]: 
[0m19:56:09.467302 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:56:09.468842 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:56:09.470212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:56:09.470905 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:56:09.473807 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:56:09.474624 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:56:09.471240 => 19:56:09.474399
[0m19:56:09.475021 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:56:09.521664 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:56:09.523002 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:56:09.523438 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:56:09.523808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:09.534964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:56:09.535422 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:56:09.535790 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:56:08' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:56:11.356050 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 2.0 seconds
[0m19:56:11.363617 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:56:11.364168 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:56:11.365945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:56:11.369364 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:56:11.369798 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:56:11.370607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:56:11.393049 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:56:11.393459 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:56:11.393786 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:56:11.422146 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:56:11.427447 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:56:11.427961 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:56:11.432238 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:56:11.433730 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:56:09.475367 => 19:56:11.433529
[0m19:56:11.434153 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:56:11.434924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7c4887-073c-46b0-b6c7-444784be7392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057997d0>]}
[0m19:56:11.435858 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 1.97s]
[0m19:56:11.436556 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:56:11.437128 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:56:11.438149 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:56:11.439094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:56:11.439533 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:56:11.442086 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:56:11.443058 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:56:11.439853 => 19:56:11.442718
[0m19:56:11.443548 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:56:11.448714 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:56:11.449522 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:56:11.449864 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:56:11.450205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:11.459944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:56:11.460345 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:56:11.460683 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:56:08' as dbt_time
from stg.airports_data
  );
  
[0m19:56:11.554393 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:56:11.557150 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:56:11.557652 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m19:56:11.558561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:56:11.561534 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:56:11.561926 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:56:11.562848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:56:11.565011 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:56:11.565363 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:56:11.565674 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:56:11.757215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:56:11.765693 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:56:11.766097 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:56:11.808651 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:56:11.810717 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:56:11.443865 => 19:56:11.810381
[0m19:56:11.811361 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:56:11.812206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b7c4887-073c-46b0-b6c7-444784be7392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105849810>]}
[0m19:56:11.812863 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.37s]
[0m19:56:11.813744 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:56:11.814283 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m19:56:11.814954 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:56:11.815806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m19:56:11.816315 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m19:56:11.819814 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m19:56:11.821048 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 19:56:11.816728 => 19:56:11.820522
[0m19:56:11.821581 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m19:56:11.826805 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m19:56:11.827809 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:56:11.828434 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m19:56:11.828905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:11.840125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:56:11.840539 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:56:11.840907 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select bp.*, tf.fare_conditions, tf.amount,
'2023-08-16 16:56:08' as dbt_time
from stg.boarding_passes as bp
inner join stg.ticket_flights as tf on bp.flight_id =tf.flight_id
  );
  
[0m19:57:27.892919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105119e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051baa10>]}


============================== 19:57:27.926464 | 1f1a342c-58a3-46bb-9022-65b9ab3e23fd ==============================
[0m19:57:27.926464 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:57:27.928267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:57:28.140771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f1a342c-58a3-46bb-9022-65b9ab3e23fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb3e50>]}
[0m19:57:28.159291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f1a342c-58a3-46bb-9022-65b9ab3e23fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eee5d0>]}
[0m19:57:28.161203 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:57:28.213238 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:57:28.425845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:57:28.426823 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/schema.yml
[0m19:57:28.552207 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m19:57:28.576424 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m19:57:28.592966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f1a342c-58a3-46bb-9022-65b9ab3e23fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bb7d0>]}
[0m19:57:28.602923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f1a342c-58a3-46bb-9022-65b9ab3e23fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0e750>]}
[0m19:57:28.603575 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:57:28.604049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f1a342c-58a3-46bb-9022-65b9ab3e23fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cd5750>]}
[0m19:57:28.606265 [info ] [MainThread]: 
[0m19:57:28.607503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:57:28.608876 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:57:28.620182 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:57:28.620812 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:57:28.621109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:28.893203 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:57:28.895596 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:57:28.898753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:57:28.905538 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:57:28.906219 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:57:28.906826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:28.920887 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:57:28.921568 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:57:28.921943 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:57:28.926592 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:57:28.928545 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:57:28.929100 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:57:28.935192 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:28.935605 [debug] [MainThread]: On master: BEGIN
[0m19:57:28.935922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:28.948883 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:57:28.949463 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:28.949980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:57:28.979286 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:57:28.981208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f1a342c-58a3-46bb-9022-65b9ab3e23fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed6010>]}
[0m19:57:28.981888 [debug] [MainThread]: On master: ROLLBACK
[0m19:57:28.982607 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:28.983036 [debug] [MainThread]: On master: BEGIN
[0m19:57:28.983871 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:57:28.984176 [debug] [MainThread]: On master: COMMIT
[0m19:57:28.984454 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:28.984741 [debug] [MainThread]: On master: COMMIT
[0m19:57:28.985100 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:57:28.985380 [debug] [MainThread]: On master: Close
[0m19:57:28.986018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:28.986413 [info ] [MainThread]: 
[0m19:57:28.993757 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:57:28.994459 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:57:28.996859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:57:28.997461 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:57:29.001159 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:57:29.002248 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:57:28.997900 => 19:57:29.001919
[0m19:57:29.003057 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:57:29.056130 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:57:29.057424 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:57:29.058047 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:57:29.058471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:29.070439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:57:29.071132 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:57:29.071601 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:57:27' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:57:29.170268 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:57:29.176891 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:57:29.177369 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:57:29.178665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:57:29.182001 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:57:29.182436 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:57:29.183252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:57:29.208902 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:57:29.209436 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:57:29.209987 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:57:29.382858 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:57:29.389723 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:57:29.390353 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:57:29.410059 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:57:29.411966 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:57:29.003614 => 19:57:29.411671
[0m19:57:29.412542 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:57:29.413467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f1a342c-58a3-46bb-9022-65b9ab3e23fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c648d0>]}
[0m19:57:29.414153 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.42s]
[0m19:57:29.415004 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:57:29.415639 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:57:29.416260 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:57:29.417163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:57:29.417708 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:57:29.421156 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:57:29.422295 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:57:29.418103 => 19:57:29.422058
[0m19:57:29.422696 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:57:29.428753 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:57:29.429569 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:57:29.429978 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:57:29.430287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:29.440861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:57:29.441259 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:57:29.441733 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:57:27' as dbt_time
from stg.airports_data
  );
  
[0m19:57:29.488315 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:57:29.491465 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:57:29.491936 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m19:57:29.492793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:57:29.495673 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:57:29.496039 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:57:29.496910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:57:29.499363 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:57:29.499800 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:57:29.500201 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:57:29.551983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:57:29.555058 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:57:29.555468 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:57:29.625944 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:57:29.627779 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:57:29.422967 => 19:57:29.627531
[0m19:57:29.628158 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:57:29.628993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f1a342c-58a3-46bb-9022-65b9ab3e23fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d96d10>]}
[0m19:57:29.629739 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.21s]
[0m19:57:29.630772 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:57:29.631452 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m19:57:29.632246 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:57:29.633184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m19:57:29.633724 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m19:57:29.637449 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m19:57:29.638455 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 19:57:29.634091 => 19:57:29.638113
[0m19:57:29.639021 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m19:57:29.645645 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m19:57:29.646485 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:57:29.647036 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m19:57:29.647689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:29.661228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:57:29.661641 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:57:29.661975 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select bp.*, tf.fare_conditions, tf.amount,
'2023-08-16 16:57:27' as dbt_time
from stg.boarding_passes as bp
inner join stg.ticket_flights as tf on bp.flight_id =tf.flight_id
  );
  
[0m19:58:23.080548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11320a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f8f990>]}


============================== 19:58:23.108271 | a94d0b45-0d49-4b02-975d-129152cae913 ==============================
[0m19:58:23.108271 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:58:23.109249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:58:23.231801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fa8f90>]}
[0m19:58:23.250268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ca5d0>]}
[0m19:58:23.252001 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:58:23.317966 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:58:23.457639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:58:23.458311 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m19:58:23.504505 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_boarding_passes.sql
[0m19:58:23.533096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a695d0>]}
[0m19:58:23.542733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bb1b50>]}
[0m19:58:23.543492 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:58:23.543941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d653d0>]}
[0m19:58:23.546726 [info ] [MainThread]: 
[0m19:58:23.547935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:58:23.549670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:58:23.561012 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:58:23.561407 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:58:23.561704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:23.806643 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:58:23.808776 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:58:23.810983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:58:23.816520 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:58:23.816958 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:58:23.817380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:58:23.827969 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:58:23.828365 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:58:23.828660 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:58:23.832653 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:58:23.834311 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:58:23.835124 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:58:23.842605 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:23.843137 [debug] [MainThread]: On master: BEGIN
[0m19:58:23.843416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:58:23.854830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:58:23.855445 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:23.856236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:58:23.880479 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:58:23.882212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112647e90>]}
[0m19:58:23.882679 [debug] [MainThread]: On master: ROLLBACK
[0m19:58:23.883272 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:23.883574 [debug] [MainThread]: On master: BEGIN
[0m19:58:23.884318 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:58:23.884749 [debug] [MainThread]: On master: COMMIT
[0m19:58:23.885144 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:23.885906 [debug] [MainThread]: On master: COMMIT
[0m19:58:23.886729 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:58:23.887277 [debug] [MainThread]: On master: Close
[0m19:58:23.888123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:58:23.888641 [info ] [MainThread]: 
[0m19:58:23.896564 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:58:23.897228 [info ] [Thread-1 (]: 1 of 5 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:58:23.898385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:58:23.898951 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:58:23.902334 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:58:23.904051 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:58:23.899286 => 19:58:23.903675
[0m19:58:23.904553 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:58:23.954627 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:58:23.957416 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:58:23.958059 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:58:23.958501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:23.974607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:58:23.975452 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:58:23.976380 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:58:22' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:58:23.994014 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:58:24.000675 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:58:24.001259 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:58:24.002459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:58:24.006577 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:58:24.007192 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:58:24.008086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:58:24.031358 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:58:24.031850 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:58:24.032274 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:58:24.063265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:58:24.070216 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:58:24.070748 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:58:24.081188 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:58:24.082988 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:58:23.904863 => 19:58:24.082707
[0m19:58:24.083382 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:58:24.084249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f0a410>]}
[0m19:58:24.085851 [info ] [Thread-1 (]: 1 of 5 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.19s]
[0m19:58:24.086874 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:58:24.087452 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:58:24.088155 [info ] [Thread-1 (]: 2 of 5 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:58:24.089069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:58:24.089613 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:58:24.092637 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:58:24.093814 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:58:24.089915 => 19:58:24.093516
[0m19:58:24.094270 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:58:24.100515 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:58:24.101552 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:58:24.102184 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:58:24.102805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:24.117680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:58:24.118206 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:58:24.118609 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:58:22' as dbt_time
from stg.airports_data
  );
  
[0m19:58:24.127998 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:58:24.130724 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:58:24.131297 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m19:58:24.132261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:58:24.135388 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:58:24.136379 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:58:24.137567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:58:24.139696 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:58:24.140129 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:58:24.140471 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:58:24.152744 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:58:24.155120 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:58:24.155514 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:58:24.158681 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:58:24.160434 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:58:24.094561 => 19:58:24.160041
[0m19:58:24.160906 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:58:24.161688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f96d0>]}
[0m19:58:24.162320 [info ] [Thread-1 (]: 2 of 5 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.07s]
[0m19:58:24.163092 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:58:24.163651 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m19:58:24.164249 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m19:58:24.165141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_flights)
[0m19:58:24.165774 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m19:58:24.169280 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m19:58:24.172133 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 19:58:24.166250 => 19:58:24.171626
[0m19:58:24.172906 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m19:58:24.178654 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m19:58:24.179477 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:58:24.179899 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m19:58:24.180226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:24.195010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:58:24.195420 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:58:24.195773 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 16:58:22' as dbt_time
from time_flight
  );
  
[0m19:58:24.670386 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m19:58:24.672940 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:58:24.673299 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m19:58:24.674082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:58:24.677335 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:58:24.677854 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m19:58:24.691093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:58:24.693548 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m19:58:24.694207 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:58:24.694735 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m19:58:24.860634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:58:24.863032 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m19:58:24.863385 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m19:58:24.870312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:58:24.871758 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 19:58:24.173480 => 19:58:24.871563
[0m19:58:24.872103 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m19:58:24.873061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d3a410>]}
[0m19:58:24.873675 [info ] [Thread-1 (]: 3 of 5 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.71s]
[0m19:58:24.874425 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m19:58:24.875069 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m19:58:24.875868 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m19:58:24.876939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m19:58:24.877435 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m19:58:24.882507 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m19:58:24.883889 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 19:58:24.877805 => 19:58:24.883556
[0m19:58:24.884441 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m19:58:24.889666 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m19:58:24.890666 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:58:24.891039 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m19:58:24.891401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:24.903827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:58:24.904446 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:58:24.906891 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:58:24.911418 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m19:58:24.914026 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:58:24.914598 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:58:24.915675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:58:24.919074 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:58:24.919673 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:58:24.920875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:58:24.923219 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:58:24.923664 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:58:24.924004 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m19:58:24.925103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:58:24.928024 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m19:58:24.928450 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:58:24.931400 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:58:24.933195 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 19:58:24.884682 => 19:58:24.932949
[0m19:58:24.933633 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m19:58:24.934517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ac4d0>]}
[0m19:58:24.935291 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.06s]
[0m19:58:24.936131 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m19:58:24.937492 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m19:58:24.938034 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:58:24.938782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m19:58:24.939218 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m19:58:24.941923 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m19:58:24.942690 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 19:58:24.939567 => 19:58:24.942466
[0m19:58:24.943234 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m19:58:24.964686 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m19:58:24.967039 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:58:24.967472 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m19:58:24.967790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:58:24.979576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:58:24.979989 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:58:24.980332 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:58:24.982881 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:58:24.986630 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:58:24.987372 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:58:24.988337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:58:24.990559 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:58:24.990967 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:58:24.991295 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m19:58:24.992580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:58:24.994901 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m19:58:24.995259 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:58:24.995783 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:58:24.997506 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 19:58:24.943496 => 19:58:24.997029
[0m19:58:24.997936 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m19:58:24.998640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94d0b45-0d49-4b02-975d-129152cae913', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bdf410>]}
[0m19:58:24.999283 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.06s]
[0m19:58:25.000119 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m19:58:25.001849 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:25.002217 [debug] [MainThread]: On master: BEGIN
[0m19:58:25.002530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:58:25.011571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:58:25.011945 [debug] [MainThread]: On master: COMMIT
[0m19:58:25.012226 [debug] [MainThread]: Using postgres connection "master"
[0m19:58:25.012494 [debug] [MainThread]: On master: COMMIT
[0m19:58:25.012927 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:58:25.013229 [debug] [MainThread]: On master: Close
[0m19:58:25.013938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:25.014301 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m19:58:25.014725 [info ] [MainThread]: 
[0m19:58:25.015176 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m19:58:25.017056 [debug] [MainThread]: Command end result
[0m19:58:25.025805 [info ] [MainThread]: 
[0m19:58:25.026993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:58:25.027712 [info ] [MainThread]: 
[0m19:58:25.028469 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:58:25.029517 [debug] [MainThread]: Command `dbt run` succeeded at 19:58:25.029301 after 2.07 seconds
[0m19:58:25.030116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f403c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d133d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b4c50>]}
[0m19:58:25.030616 [debug] [MainThread]: Flushing usage events
[0m19:59:37.475256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cec11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd65690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e27ff90>]}


============================== 19:59:37.497642 | 9375decd-7f76-4618-a826-9cf189937d9d ==============================
[0m19:59:37.497642 [info ] [MainThread]: Running with dbt=1.5.3
[0m19:59:37.498872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:59:37.659389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9375decd-7f76-4618-a826-9cf189937d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbdf810>]}
[0m19:59:37.678221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9375decd-7f76-4618-a826-9cf189937d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e316610>]}
[0m19:59:37.689299 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m19:59:37.736687 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m19:59:37.886903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:59:37.887986 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m19:59:37.945210 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m19:59:37.964588 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m19:59:37.977015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9375decd-7f76-4618-a826-9cf189937d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea3edd0>]}
[0m19:59:37.985505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9375decd-7f76-4618-a826-9cf189937d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb0df90>]}
[0m19:59:37.986264 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:59:37.986741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9375decd-7f76-4618-a826-9cf189937d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baad6d0>]}
[0m19:59:37.989881 [info ] [MainThread]: 
[0m19:59:37.991198 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:59:37.993283 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:59:38.006083 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:59:38.006640 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:59:38.007035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:38.224498 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:59:38.227941 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:59:38.229760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m19:59:38.236210 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:59:38.236582 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:59:38.236850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:38.246824 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:59:38.247255 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:59:38.247553 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:59:38.251805 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:59:38.253271 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:59:38.253828 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:59:38.259787 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:38.260176 [debug] [MainThread]: On master: BEGIN
[0m19:59:38.260442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:38.270690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:59:38.271172 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:38.271583 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:59:38.310184 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:59:38.312520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9375decd-7f76-4618-a826-9cf189937d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e07fb50>]}
[0m19:59:38.313133 [debug] [MainThread]: On master: ROLLBACK
[0m19:59:38.313757 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:38.314219 [debug] [MainThread]: On master: BEGIN
[0m19:59:38.314904 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:59:38.315275 [debug] [MainThread]: On master: COMMIT
[0m19:59:38.315804 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:38.316190 [debug] [MainThread]: On master: COMMIT
[0m19:59:38.316788 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:59:38.317179 [debug] [MainThread]: On master: Close
[0m19:59:38.318035 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:59:38.318563 [info ] [MainThread]: 
[0m19:59:38.323140 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m19:59:38.323915 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m19:59:38.325850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m19:59:38.326569 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m19:59:38.329522 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m19:59:38.331174 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 19:59:38.327025 => 19:59:38.330678
[0m19:59:38.332041 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m19:59:38.387152 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m19:59:38.388161 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:59:38.388569 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m19:59:38.388877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:38.398473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:59:38.398896 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:59:38.399241 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 16:59:37' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m19:59:38.452082 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:59:38.458785 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:59:38.459278 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m19:59:38.507361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:59:38.511121 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:59:38.511496 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m19:59:38.513050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:59:38.537945 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:59:38.538455 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:59:38.538900 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m19:59:38.580529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:59:38.586517 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m19:59:38.587021 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m19:59:38.648519 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:59:38.650170 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 19:59:38.332390 => 19:59:38.649942
[0m19:59:38.650644 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m19:59:38.651538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9375decd-7f76-4618-a826-9cf189937d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcacb90>]}
[0m19:59:38.652345 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.33s]
[0m19:59:38.653221 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m19:59:38.653735 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m19:59:38.654430 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m19:59:38.655247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m19:59:38.655751 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m19:59:38.658613 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m19:59:38.660171 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 19:59:38.656049 => 19:59:38.659670
[0m19:59:38.660765 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m19:59:38.671004 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m19:59:38.672153 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:59:38.672606 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m19:59:38.673029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:38.686915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:59:38.687398 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:59:38.687944 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 16:59:37' as dbt_time
from stg.airports_data
  );
  
[0m19:59:38.700960 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:59:38.703852 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:59:38.704350 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m19:59:38.706211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:59:38.710031 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:59:38.710438 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m19:59:38.711282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:59:38.713378 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:59:38.713727 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:59:38.714039 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m19:59:38.755851 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:59:38.759492 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m19:59:38.759939 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m19:59:38.771405 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:59:38.773011 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 19:59:38.661323 => 19:59:38.772808
[0m19:59:38.773432 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m19:59:38.774476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9375decd-7f76-4618-a826-9cf189937d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcae850>]}
[0m19:59:38.775225 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.12s]
[0m19:59:38.776044 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m19:59:38.776584 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m19:59:38.777252 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:59:38.778163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m19:59:38.778601 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m19:59:38.781173 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m19:59:38.784357 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 19:59:38.778871 => 19:59:38.783797
[0m19:59:38.785057 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m19:59:38.790523 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m19:59:38.791410 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:59:38.792057 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m19:59:38.792633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:38.803361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:59:38.803902 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m19:59:38.804402 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select bp.*, tf.fare_conditions, tf.amount,
'2023-08-16 16:59:37' as dbt_time
from stg.boarding_passes as bp
inner join stg.ticket_flights as tf on bp.flight_id =tf.flight_id
  );
  
[0m20:15:51.038413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d52590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e46250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a87fd0>]}


============================== 20:15:51.050091 | ef36f816-547a-4daf-a3c3-1e18ea303c6d ==============================
[0m20:15:51.050091 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:15:51.051205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:15:51.244256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b25550>]}
[0m20:15:51.263035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a26e10>]}
[0m20:15:51.264630 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:15:51.301873 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:15:51.448218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:15:51.449070 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m20:15:51.496811 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m20:15:51.519400 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m20:15:51.531566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11413c490>]}
[0m20:15:51.556488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d71990>]}
[0m20:15:51.557035 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:15:51.557428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118716d0>]}
[0m20:15:51.560136 [info ] [MainThread]: 
[0m20:15:51.561816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:15:51.564151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:15:51.579010 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:15:51.579583 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:15:51.580033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:51.752322 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:15:51.754752 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:15:51.756887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:15:51.764713 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:15:51.765175 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:15:51.765489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:51.776213 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:15:51.776635 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:15:51.777027 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:15:51.781847 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:15:51.783619 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:15:51.784410 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:15:51.790635 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:51.791049 [debug] [MainThread]: On master: BEGIN
[0m20:15:51.791308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:51.801963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:15:51.802468 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:51.803243 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:15:51.832585 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:15:51.835682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a8110>]}
[0m20:15:51.836477 [debug] [MainThread]: On master: ROLLBACK
[0m20:15:51.837286 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:51.837848 [debug] [MainThread]: On master: BEGIN
[0m20:15:51.838595 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:15:51.839089 [debug] [MainThread]: On master: COMMIT
[0m20:15:51.839538 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:51.839894 [debug] [MainThread]: On master: COMMIT
[0m20:15:51.840416 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:15:51.840996 [debug] [MainThread]: On master: Close
[0m20:15:51.841931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:51.842642 [info ] [MainThread]: 
[0m20:15:51.848197 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:15:51.848952 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:15:51.850313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:15:51.850823 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:15:51.854251 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:15:51.855419 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:15:51.851139 => 20:15:51.855128
[0m20:15:51.855844 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:15:51.908233 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:15:51.909510 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:15:51.909974 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:15:51.910321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:51.921724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:51.922216 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:15:51.922572 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:15:50' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:15:52.095357 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:15:52.104164 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:15:52.104746 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:15:52.106697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:52.110745 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:15:52.111227 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:15:52.112398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:52.136541 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:15:52.136981 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:15:52.137334 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:15:52.161387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:52.168810 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:15:52.169448 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:15:52.181034 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:15:52.183348 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:15:51.856064 => 20:15:52.182615
[0m20:15:52.183987 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:15:52.185173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141165d0>]}
[0m20:15:52.186203 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.34s]
[0m20:15:52.187165 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:15:52.187763 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:15:52.188499 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:15:52.189417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:15:52.189845 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:15:52.192758 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:15:52.194375 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:15:52.190123 => 20:15:52.193970
[0m20:15:52.194808 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:15:52.200601 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:15:52.201801 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:15:52.202511 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:15:52.203061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:52.214615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:52.215070 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:15:52.215406 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:15:50' as dbt_time
from stg.airports_data
  );
  
[0m20:15:52.254200 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:15:52.257417 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:15:52.257824 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:15:52.258779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:52.261976 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:15:52.262473 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:15:52.263476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:52.265698 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:15:52.266103 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:15:52.266546 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:15:52.301578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:52.304823 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:15:52.305330 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:15:52.309077 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:15:52.311061 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:15:52.195080 => 20:15:52.310767
[0m20:15:52.311587 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:15:52.312457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147b2050>]}
[0m20:15:52.313208 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.12s]
[0m20:15:52.314150 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:15:52.314729 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:15:52.315437 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:15:52.316305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:15:52.316786 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:15:52.319759 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:15:52.321327 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:15:52.317237 => 20:15:52.320868
[0m20:15:52.321914 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:15:52.327197 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:15:52.328137 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:15:52.328594 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:15:52.328986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:52.342049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:52.342487 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:15:52.342823 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select bp.*, tf.fare_conditions, tf.amount,
'2023-08-16 17:15:50' as dbt_time
from stg.boarding_passes as bp
inner join stg.ticket_flights as tf on bp.flight_id =tf.flight_id  
and bp.ticket_no on tf.ticket_no
  );
  
[0m20:15:52.343611 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "on"
LINE 16: and bp.ticket_no on tf.ticket_no
                          ^

[0m20:15:52.343976 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: ROLLBACK
[0m20:15:52.344644 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 20:15:52.322311 => 20:15:52.344439
[0m20:15:52.345086 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m20:15:52.358665 [debug] [Thread-1 (]: Database Error in model fact_boarding_passes (models/facts/fact_boarding_passes.sql)
  syntax error at or near "on"
  LINE 16: and bp.ticket_no on tf.ticket_no
                            ^
  compiled Code at target/run/flights_dbt/models/facts/fact_boarding_passes.sql
[0m20:15:52.359536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11491ddd0>]}
[0m20:15:52.360283 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model flights_wh.fact_boarding_passes .......... [[31mERROR[0m in 0.04s]
[0m20:15:52.361148 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m20:15:52.361784 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:15:52.362267 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:15:52.363705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m20:15:52.364407 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:15:52.368432 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:15:52.374566 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:15:52.364752 => 20:15:52.373124
[0m20:15:52.375207 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:15:52.380425 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:15:52.381394 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:15:52.381931 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:15:52.382583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:52.401662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:52.402201 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:15:52.403034 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:15:50' as dbt_time
from time_flight
  );
  
[0m20:15:52.951475 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 1.0 seconds
[0m20:15:52.958289 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:15:52.959043 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:15:52.961590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:52.965688 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:15:52.966184 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:15:52.976344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:52.980088 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:15:52.980844 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:15:52.981410 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:15:53.005846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:53.008592 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:15:53.008997 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:15:53.022418 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:15:53.024791 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:15:52.375586 => 20:15:53.024587
[0m20:15:53.025419 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:15:53.026226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149b8c90>]}
[0m20:15:53.026796 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.66s]
[0m20:15:53.027566 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:15:53.028161 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:15:53.028790 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:15:53.029819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m20:15:53.030315 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:15:53.033703 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:15:53.035139 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:15:53.030564 => 20:15:53.034610
[0m20:15:53.035679 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:15:53.042604 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:15:53.043786 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:15:53.044439 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:15:53.044871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:53.077436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:53.077837 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:15:53.078181 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:15:53.084916 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:15:53.088810 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:15:53.089270 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:15:53.092517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:53.096458 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:15:53.096937 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:15:53.099301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:53.102922 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:15:53.103636 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:15:53.104935 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:15:53.199366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:53.202574 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:15:53.203918 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:15:53.229259 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:15:53.230811 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:15:53.036081 => 20:15:53.230619
[0m20:15:53.231197 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:15:53.231913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149c0a90>]}
[0m20:15:53.232503 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.20s]
[0m20:15:53.234239 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:15:53.236835 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:15:53.237827 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:15:53.238848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:15:53.239367 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:15:53.242635 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:15:53.260730 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:15:53.239682 => 20:15:53.260300
[0m20:15:53.261329 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:15:53.287042 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:15:53.288188 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:15:53.288729 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:15:53.289039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:53.301089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:15:53.301574 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:15:53.302044 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:15:53.365602 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:15:53.370126 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:15:53.370934 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:15:53.374263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:15:53.377294 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:15:53.378060 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:15:53.378595 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:15:53.424088 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:15:53.426506 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:15:53.426901 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:15:53.427519 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:15:53.429702 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:15:53.261597 => 20:15:53.429495
[0m20:15:53.430082 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:15:53.430814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef36f816-547a-4daf-a3c3-1e18ea303c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148d2450>]}
[0m20:15:53.431414 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.19s]
[0m20:15:53.432243 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:15:53.434200 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:53.434642 [debug] [MainThread]: On master: BEGIN
[0m20:15:53.434994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:53.446257 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:15:53.446837 [debug] [MainThread]: On master: COMMIT
[0m20:15:53.447232 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:53.447578 [debug] [MainThread]: On master: COMMIT
[0m20:15:53.448118 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:15:53.448499 [debug] [MainThread]: On master: Close
[0m20:15:53.449216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:53.450012 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:15:53.450680 [info ] [MainThread]: 
[0m20:15:53.451291 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m20:15:53.454232 [debug] [MainThread]: Command end result
[0m20:15:53.467158 [info ] [MainThread]: 
[0m20:15:53.467732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:15:53.468396 [info ] [MainThread]: 
[0m20:15:53.469531 [error] [MainThread]: [33mDatabase Error in model fact_boarding_passes (models/facts/fact_boarding_passes.sql)[0m
[0m20:15:53.470124 [error] [MainThread]:   syntax error at or near "on"
[0m20:15:53.470670 [error] [MainThread]:   LINE 16: and bp.ticket_no on tf.ticket_no
[0m20:15:53.471329 [error] [MainThread]:                             ^
[0m20:15:53.472113 [error] [MainThread]:   compiled Code at target/run/flights_dbt/models/facts/fact_boarding_passes.sql
[0m20:15:53.472767 [info ] [MainThread]: 
[0m20:15:53.474475 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:15:53.475617 [debug] [MainThread]: Command `dbt run` failed at 20:15:53.475448 after 2.51 seconds
[0m20:15:53.476260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112740490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff1c510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffc2890>]}
[0m20:15:53.476741 [debug] [MainThread]: Flushing usage events
[0m20:16:19.373933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d08750>]}


============================== 20:16:19.383868 | ac9a2269-f121-4117-a6c6-cbe7e026b1d7 ==============================
[0m20:16:19.383868 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:16:19.384647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:16:19.554785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac9a2269-f121-4117-a6c6-cbe7e026b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce7a50>]}
[0m20:16:19.574681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac9a2269-f121-4117-a6c6-cbe7e026b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108984d10>]}
[0m20:16:19.577429 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:16:19.624628 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:16:19.767113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:16:19.767844 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m20:16:19.846367 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m20:16:19.865442 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m20:16:19.878118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac9a2269-f121-4117-a6c6-cbe7e026b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0225d0>]}
[0m20:16:19.886833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac9a2269-f121-4117-a6c6-cbe7e026b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c5310>]}
[0m20:16:19.887340 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:16:19.887769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac9a2269-f121-4117-a6c6-cbe7e026b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b09690>]}
[0m20:16:19.890456 [info ] [MainThread]: 
[0m20:16:19.891912 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:16:19.894448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:16:19.907771 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:16:19.908399 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:16:19.908953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:20.114847 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:16:20.117018 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:16:20.119594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:16:20.127786 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:16:20.128343 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:16:20.128665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:20.140496 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:16:20.140871 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:16:20.141236 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:16:20.146113 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:16:20.147734 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:16:20.148270 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:16:20.154533 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:20.154909 [debug] [MainThread]: On master: BEGIN
[0m20:16:20.155167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:20.166367 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:16:20.166868 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:20.167423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:16:20.197610 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:16:20.199465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac9a2269-f121-4117-a6c6-cbe7e026b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab34e50>]}
[0m20:16:20.200125 [debug] [MainThread]: On master: ROLLBACK
[0m20:16:20.200654 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:20.200971 [debug] [MainThread]: On master: BEGIN
[0m20:16:20.201458 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:16:20.201811 [debug] [MainThread]: On master: COMMIT
[0m20:16:20.202157 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:20.202456 [debug] [MainThread]: On master: COMMIT
[0m20:16:20.202987 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:16:20.203330 [debug] [MainThread]: On master: Close
[0m20:16:20.204058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:20.204542 [info ] [MainThread]: 
[0m20:16:20.210225 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:16:20.211015 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:16:20.212499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:16:20.213260 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:16:20.216482 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:16:20.217848 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:16:20.213867 => 20:16:20.217326
[0m20:16:20.218592 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:16:20.275182 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:16:20.276504 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:16:20.277140 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:16:20.278295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:20.295635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:16:20.296688 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:16:20.297094 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:16:19' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:16:20.344161 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:16:20.350559 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:16:20.350972 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:16:20.363387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:16:20.367485 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:16:20.368035 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:16:20.370183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:16:20.401089 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:16:20.401657 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:16:20.402158 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:16:20.456319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:16:20.462357 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:16:20.462906 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:16:20.475333 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:16:20.477116 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:16:20.218958 => 20:16:20.476905
[0m20:16:20.477764 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:16:20.478755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac9a2269-f121-4117-a6c6-cbe7e026b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3b5d0>]}
[0m20:16:20.479619 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.27s]
[0m20:16:20.480455 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:16:20.480998 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:16:20.481708 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:16:20.482562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:16:20.483208 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:16:20.486124 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:16:20.487141 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:16:20.483679 => 20:16:20.486842
[0m20:16:20.487621 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:16:20.494651 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:16:20.496107 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:16:20.496913 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:16:20.497384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:20.519109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:16:20.519933 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:16:20.520536 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:16:19' as dbt_time
from stg.airports_data
  );
  
[0m20:16:20.550957 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:16:20.554339 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:16:20.554810 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:16:20.555753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:16:20.558693 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:16:20.559105 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:16:20.559998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:16:20.562676 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:16:20.563198 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:16:20.563638 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:16:20.598120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:16:20.600574 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:16:20.601228 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:16:20.621396 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:16:20.623031 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:16:20.487896 => 20:16:20.622815
[0m20:16:20.623391 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:16:20.624189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac9a2269-f121-4117-a6c6-cbe7e026b1d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab460d0>]}
[0m20:16:20.624924 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.14s]
[0m20:16:20.625780 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:16:20.626454 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:16:20.627195 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:16:20.628284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:16:20.628818 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:16:20.631817 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:16:20.633869 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:16:20.629171 => 20:16:20.633337
[0m20:16:20.634584 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:16:20.640469 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:16:20.641439 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:16:20.642166 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:16:20.643155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:20.661081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:16:20.661656 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:16:20.662399 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select bp.*, tf.fare_conditions, tf.amount,
'2023-08-16 17:16:19' as dbt_time
from stg.boarding_passes as bp
inner join stg.ticket_flights as tf on bp.flight_id =tf.flight_id  
and bp.ticket_no = tf.ticket_no
  );
  
[0m20:19:26.549144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cebdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122ce790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d24d10>]}


============================== 20:19:26.571243 | adffedba-5c10-4142-9e91-1b15df1f9bfc ==============================
[0m20:19:26.571243 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:19:26.572401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:19:26.677386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adffedba-5c10-4142-9e91-1b15df1f9bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe6310>]}
[0m20:19:26.697407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adffedba-5c10-4142-9e91-1b15df1f9bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102ba710>]}
[0m20:19:26.716147 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:19:26.772744 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:19:26.894121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:19:26.894784 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m20:19:26.922923 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m20:19:26.942504 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m20:19:26.954300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adffedba-5c10-4142-9e91-1b15df1f9bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a25c50>]}
[0m20:19:26.963124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adffedba-5c10-4142-9e91-1b15df1f9bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b38a90>]}
[0m20:19:26.963597 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:19:26.964008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adffedba-5c10-4142-9e91-1b15df1f9bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb0d750>]}
[0m20:19:26.966692 [info ] [MainThread]: 
[0m20:19:26.967794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:19:26.969713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:19:26.981848 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:19:26.982339 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:19:26.982663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:27.117664 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:19:27.120556 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:19:27.123101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:19:27.130209 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:19:27.130779 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:19:27.131224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:27.143036 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:19:27.143585 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:19:27.144028 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:19:27.149040 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:19:27.150473 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:19:27.151000 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:19:27.158069 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:27.158533 [debug] [MainThread]: On master: BEGIN
[0m20:19:27.158798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:27.170143 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:19:27.170560 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:27.171106 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:19:27.210387 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:19:27.212215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adffedba-5c10-4142-9e91-1b15df1f9bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d0fb10>]}
[0m20:19:27.212636 [debug] [MainThread]: On master: ROLLBACK
[0m20:19:27.213168 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:27.213440 [debug] [MainThread]: On master: BEGIN
[0m20:19:27.214049 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:19:27.214381 [debug] [MainThread]: On master: COMMIT
[0m20:19:27.214655 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:27.215025 [debug] [MainThread]: On master: COMMIT
[0m20:19:27.215653 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:19:27.216153 [debug] [MainThread]: On master: Close
[0m20:19:27.217057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:27.217493 [info ] [MainThread]: 
[0m20:19:27.223282 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:19:27.224086 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:19:27.225420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:19:27.225908 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:19:27.228656 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:19:27.229770 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:19:27.226150 => 20:19:27.229542
[0m20:19:27.230244 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:19:27.288436 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:19:27.289618 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:19:27.290172 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:19:27.290578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:27.313931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:19:27.314473 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:19:27.315077 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:19:26' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:19:27.371349 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:19:27.378538 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:19:27.379026 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:19:27.422559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:27.426136 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:19:27.426544 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:19:27.427419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:27.450463 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:19:27.450887 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:19:27.451294 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:19:27.489844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:19:27.496439 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:19:27.496954 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:19:27.511124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:19:27.512703 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:19:27.230464 => 20:19:27.512511
[0m20:19:27.513160 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:19:27.513919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adffedba-5c10-4142-9e91-1b15df1f9bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123efc10>]}
[0m20:19:27.514633 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.29s]
[0m20:19:27.515877 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:19:27.516646 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:19:27.517345 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:19:27.518236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:19:27.518707 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:19:27.522196 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:19:27.523156 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:19:27.518989 => 20:19:27.522910
[0m20:19:27.523567 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:19:27.529074 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:19:27.530067 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:19:27.530433 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:19:27.530733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:27.554525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:19:27.555542 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:19:27.556525 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:19:26' as dbt_time
from stg.airports_data
  );
  
[0m20:19:27.611031 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:19:27.615372 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:19:27.616091 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:19:27.618066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:27.623276 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:19:27.623851 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:19:27.627220 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:27.630114 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:19:27.630546 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:19:27.630874 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:19:27.645042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:19:27.647919 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:19:27.648295 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:19:27.655891 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:19:27.657840 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:19:27.523837 => 20:19:27.657565
[0m20:19:27.658408 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:19:27.659757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adffedba-5c10-4142-9e91-1b15df1f9bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b83c90>]}
[0m20:19:27.660585 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.14s]
[0m20:19:27.661313 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:19:27.661937 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:19:27.662600 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:19:27.663439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:19:27.663908 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:19:27.667151 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:19:27.669453 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:19:27.664249 => 20:19:27.668953
[0m20:19:27.670182 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:19:27.676293 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:19:27.677328 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:19:27.677784 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:19:27.678137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:27.697789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:19:27.698256 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:19:27.698590 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select bp.*,
'2023-08-16 17:19:26' as dbt_time
from stg.boarding_passes as bp
inner join stg.ticket_flights as tf on bp.flight_id =tf.flight_id  
and bp.ticket_no = tf.ticket_no
  );
  
[0m20:20:55.975383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd71b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccdbe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccc4890>]}


============================== 20:20:55.995320 | 664a38e9-9907-49c7-b9b1-f6dc43b133e4 ==============================
[0m20:20:55.995320 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:20:55.996688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:20:56.146210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '664a38e9-9907-49c7-b9b1-f6dc43b133e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d054390>]}
[0m20:20:56.164764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '664a38e9-9907-49c7-b9b1-f6dc43b133e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd702d0>]}
[0m20:20:56.166589 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:20:56.199596 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:20:56.307980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:20:56.308627 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m20:20:56.363155 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_boarding_passes.sql
[0m20:20:56.396441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '664a38e9-9907-49c7-b9b1-f6dc43b133e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da9d950>]}
[0m20:20:56.406568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '664a38e9-9907-49c7-b9b1-f6dc43b133e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d996d90>]}
[0m20:20:56.407074 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:20:56.407458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '664a38e9-9907-49c7-b9b1-f6dc43b133e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab353d0>]}
[0m20:20:56.410100 [info ] [MainThread]: 
[0m20:20:56.411179 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:56.412855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:20:56.424791 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:20:56.425211 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:20:56.425614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:56.646434 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:20:56.648866 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:20:56.651154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:20:56.657958 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:20:56.658426 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:20:56.658838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:56.670769 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:20:56.671358 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:20:56.671662 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:20:56.676608 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:20:56.678622 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:20:56.679480 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:20:56.686777 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:56.687822 [debug] [MainThread]: On master: BEGIN
[0m20:20:56.688860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:56.702401 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:56.702763 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:56.703127 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:56.738332 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:20:56.740442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '664a38e9-9907-49c7-b9b1-f6dc43b133e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2a0850>]}
[0m20:20:56.741069 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:56.741621 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:56.742180 [debug] [MainThread]: On master: BEGIN
[0m20:20:56.742942 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:56.743361 [debug] [MainThread]: On master: COMMIT
[0m20:20:56.743790 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:56.744280 [debug] [MainThread]: On master: COMMIT
[0m20:20:56.744896 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:20:56.745514 [debug] [MainThread]: On master: Close
[0m20:20:56.746549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:56.747271 [info ] [MainThread]: 
[0m20:20:56.753483 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:20:56.754793 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:20:56.756357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:20:56.757104 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:20:56.759999 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:20:56.761702 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:20:56.757375 => 20:20:56.761237
[0m20:20:56.762600 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:20:56.812874 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:20:56.814689 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:20:56.815732 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:20:56.816390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:56.829431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:56.829946 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:20:56.830472 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:20:55' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:20:56.979166 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:20:56.985912 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:20:56.986370 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:20:56.987223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:56.990665 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:20:56.991071 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:20:56.991934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:57.023689 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:20:57.024379 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:20:57.024931 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:20:57.042056 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:20:57.047580 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:20:57.048234 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:20:57.105779 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:20:57.108344 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:20:56.763037 => 20:20:57.107901
[0m20:20:57.109019 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:20:57.110300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '664a38e9-9907-49c7-b9b1-f6dc43b133e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da9d910>]}
[0m20:20:57.111810 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.35s]
[0m20:20:57.113026 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:20:57.113817 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:20:57.114952 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:20:57.116480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:20:57.117129 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:20:57.120435 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:20:57.121605 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:20:57.117438 => 20:20:57.121323
[0m20:20:57.122261 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:20:57.129504 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:20:57.130514 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:20:57.131395 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:20:57.131903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:57.144834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:57.145481 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:20:57.145868 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:20:55' as dbt_time
from stg.airports_data
  );
  
[0m20:20:57.234952 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:20:57.238084 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:20:57.238552 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:20:57.239585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:57.243432 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:20:57.244143 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:20:57.245788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:57.248648 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:20:57.249064 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:20:57.249380 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:20:57.276892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:20:57.279567 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:20:57.280153 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:20:57.323919 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:20:57.325651 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:20:57.122734 => 20:20:57.325428
[0m20:20:57.326177 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:20:57.327107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '664a38e9-9907-49c7-b9b1-f6dc43b133e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dae7210>]}
[0m20:20:57.328116 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.21s]
[0m20:20:57.329082 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:20:57.329658 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:20:57.330444 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:20:57.331534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:20:57.332139 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:20:57.334501 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:20:57.337916 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:20:57.332536 => 20:20:57.336879
[0m20:20:57.338677 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:20:57.344859 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:20:57.345746 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:20:57.346380 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:20:57.346857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:57.358366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:57.358767 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:20:57.359138 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select bp.*
from stg.boarding_passes as bp
inner join stg.ticket_flights as tf on bp.flight_id =tf.flight_id  
and bp.ticket_no = tf.ticket_no
  );
  
[0m20:25:01.957678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c63d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3d3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0ec5d0>]}


============================== 20:25:01.975960 | 9596958c-ac11-437d-bb76-00a423f11c1d ==============================
[0m20:25:01.975960 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:25:01.976756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:25:02.112682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0ec050>]}
[0m20:25:02.134191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40fa50>]}
[0m20:25:02.143107 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:25:02.187281 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:25:02.481078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:25:02.481851 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/schema.yml
[0m20:25:02.482347 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m20:25:02.533723 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_boarding_passes.sql
[0m20:25:02.603470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e748810>]}
[0m20:25:02.642208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7298d0>]}
[0m20:25:02.642714 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:25:02.643235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be61750>]}
[0m20:25:02.646117 [info ] [MainThread]: 
[0m20:25:02.647079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:25:02.648772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:25:02.662715 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:25:02.663167 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:25:02.663477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:03.008995 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:25:03.011141 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:25:03.014035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:25:03.021122 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:25:03.021897 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:25:03.022408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:03.034804 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:25:03.035248 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:25:03.035728 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:25:03.049678 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:25:03.051421 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:25:03.053075 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:25:03.060449 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:03.061029 [debug] [MainThread]: On master: BEGIN
[0m20:25:03.061637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:03.072946 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:25:03.073410 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:03.073890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:25:03.114568 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:25:03.116140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be61890>]}
[0m20:25:03.116576 [debug] [MainThread]: On master: ROLLBACK
[0m20:25:03.117259 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:03.117657 [debug] [MainThread]: On master: BEGIN
[0m20:25:03.118258 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:25:03.118683 [debug] [MainThread]: On master: COMMIT
[0m20:25:03.119194 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:03.119524 [debug] [MainThread]: On master: COMMIT
[0m20:25:03.120142 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:25:03.120732 [debug] [MainThread]: On master: Close
[0m20:25:03.121486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:03.122520 [info ] [MainThread]: 
[0m20:25:03.128650 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:25:03.129378 [info ] [Thread-1 (]: 1 of 5 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:25:03.130325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:25:03.130858 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:25:03.134517 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:25:03.136150 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:25:03.131103 => 20:25:03.135785
[0m20:25:03.136798 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:25:03.191472 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:25:03.192877 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:25:03.193300 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:25:03.193624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:03.213786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:25:03.214456 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:25:03.214923 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:25:01' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:25:03.399653 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:25:03.405980 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:25:03.406401 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:25:03.407316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:25:03.410240 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:25:03.410635 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:25:03.411855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:25:03.442006 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:25:03.442578 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:25:03.443016 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:25:03.494628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:25:03.499973 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:25:03.500381 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:25:03.509343 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:25:03.510948 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:25:03.137179 => 20:25:03.510751
[0m20:25:03.511773 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:25:03.512796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e71d550>]}
[0m20:25:03.513649 [info ] [Thread-1 (]: 1 of 5 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.38s]
[0m20:25:03.514616 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:25:03.515253 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:25:03.515981 [info ] [Thread-1 (]: 2 of 5 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:25:03.517014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:25:03.517650 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:25:03.522499 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:25:03.618399 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:25:03.517952 => 20:25:03.618116
[0m20:25:03.618891 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:25:03.624722 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:25:03.625523 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:25:03.625864 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:25:03.626176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:03.636520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:25:03.636960 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:25:03.637575 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:25:01' as dbt_time
from stg.airports_data
  );
  
[0m20:25:03.697141 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:25:03.700273 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:25:03.700717 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:25:03.701598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:25:03.705516 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:25:03.706199 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:25:03.708944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:25:03.712351 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:25:03.713364 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:25:03.713826 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:25:03.768159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:25:03.771224 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:25:03.771934 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:25:03.786571 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:25:03.788895 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:25:03.619437 => 20:25:03.788531
[0m20:25:03.789363 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:25:03.790242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edd0b10>]}
[0m20:25:03.790929 [info ] [Thread-1 (]: 2 of 5 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.27s]
[0m20:25:03.791944 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:25:03.793285 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:25:03.793964 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:25:03.795669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_flights)
[0m20:25:03.796434 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:25:03.799510 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:25:03.801014 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:25:03.796856 => 20:25:03.800702
[0m20:25:03.801998 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:25:03.810171 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:25:03.811181 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:25:03.812056 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:25:03.812718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:03.824529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:25:03.825109 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:25:03.825562 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:25:01' as dbt_time
from time_flight
  );
  
[0m20:25:04.506486 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 1.0 seconds
[0m20:25:04.510457 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:25:04.510950 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:25:04.512185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:25:04.515619 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:25:04.516094 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:25:04.562239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:25:04.564945 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:25:04.565496 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:25:04.565940 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:25:04.733529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:25:04.736092 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:25:04.736590 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:25:04.749062 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:25:04.750580 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:25:03.802676 => 20:25:04.750389
[0m20:25:04.750929 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:25:04.751746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee1f350>]}
[0m20:25:04.752523 [info ] [Thread-1 (]: 3 of 5 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.96s]
[0m20:25:04.753822 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:25:04.754500 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:25:04.755175 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:25:04.756012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m20:25:04.756485 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:25:04.760127 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:25:04.761519 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:25:04.756941 => 20:25:04.761145
[0m20:25:04.762251 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:25:04.767332 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:25:04.768186 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:25:04.768652 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:25:04.769054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:04.784022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:25:04.784620 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:25:04.785399 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:25:04.823314 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:25:04.826778 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:25:04.827407 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:25:04.829957 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:25:04.833836 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:25:04.834454 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:25:04.836694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:25:04.840503 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:25:04.841189 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:25:04.841905 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:25:04.871948 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:25:04.875071 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:25:04.875692 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:25:04.952657 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:25:04.954867 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:25:04.762580 => 20:25:04.954622
[0m20:25:04.955369 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:25:04.956482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef36750>]}
[0m20:25:04.957282 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.20s]
[0m20:25:04.958122 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:25:04.960311 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:25:04.961164 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:25:04.962541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:25:04.963143 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:25:04.966972 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:25:04.968550 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:25:04.963550 => 20:25:04.968143
[0m20:25:04.969283 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:25:05.001695 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:25:05.003370 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:25:05.004067 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:25:05.004713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:05.021576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:25:05.022311 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:25:05.022897 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:25:05.039176 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:25:05.043636 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:25:05.044232 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:25:05.046788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:25:05.049316 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:25:05.049965 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:25:05.050611 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:25:05.086746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:25:05.089849 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:25:05.090268 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:25:05.090929 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:25:05.092786 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:25:04.969614 => 20:25:05.092522
[0m20:25:05.093278 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:25:05.094225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9596958c-ac11-437d-bb76-00a423f11c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef40350>]}
[0m20:25:05.094898 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.13s]
[0m20:25:05.095815 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:25:05.097664 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:05.098086 [debug] [MainThread]: On master: BEGIN
[0m20:25:05.098429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:05.116517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:25:05.117110 [debug] [MainThread]: On master: COMMIT
[0m20:25:05.117565 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:05.117903 [debug] [MainThread]: On master: COMMIT
[0m20:25:05.118528 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:25:05.118945 [debug] [MainThread]: On master: Close
[0m20:25:05.119700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:05.120066 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:25:05.120451 [info ] [MainThread]: 
[0m20:25:05.120917 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m20:25:05.123136 [debug] [MainThread]: Command end result
[0m20:25:05.133723 [info ] [MainThread]: 
[0m20:25:05.134415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:25:05.135004 [info ] [MainThread]: 
[0m20:25:05.135590 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:25:05.136785 [debug] [MainThread]: Command `dbt run` succeeded at 20:25:05.136563 after 3.29 seconds
[0m20:25:05.137498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c63d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a503e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df93b50>]}
[0m20:25:05.138240 [debug] [MainThread]: Flushing usage events
[0m20:26:37.977074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a45a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11149a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11146e150>]}


============================== 20:26:37.984477 | 39e0cf78-30f8-4727-b916-21256f30bf3f ==============================
[0m20:26:37.984477 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:26:37.985239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:26:38.119912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111474790>]}
[0m20:26:38.140970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b1b590>]}
[0m20:26:38.142661 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:26:38.172953 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:26:38.254253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:26:38.255001 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m20:26:38.284732 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_boarding_passes.sql
[0m20:26:38.352182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111487350>]}
[0m20:26:38.360746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121bb390>]}
[0m20:26:38.361386 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:26:38.361816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f285650>]}
[0m20:26:38.364297 [info ] [MainThread]: 
[0m20:26:38.365489 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:26:38.367429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:26:38.381251 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:26:38.381903 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:26:38.382229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:38.483271 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:26:38.486117 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:26:38.488462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:26:38.495119 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:26:38.495499 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:26:38.495792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:38.506292 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:26:38.506773 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:26:38.507068 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:26:38.510297 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:26:38.512229 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:26:38.513022 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:26:38.519667 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:38.520073 [debug] [MainThread]: On master: BEGIN
[0m20:26:38.520396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:38.532434 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:26:38.532797 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:38.533177 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:26:38.555851 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:26:38.557722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f285650>]}
[0m20:26:38.558179 [debug] [MainThread]: On master: ROLLBACK
[0m20:26:38.558602 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:38.558875 [debug] [MainThread]: On master: BEGIN
[0m20:26:38.559370 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:26:38.559708 [debug] [MainThread]: On master: COMMIT
[0m20:26:38.559979 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:38.560233 [debug] [MainThread]: On master: COMMIT
[0m20:26:38.560595 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:26:38.560957 [debug] [MainThread]: On master: Close
[0m20:26:38.561707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:38.562180 [info ] [MainThread]: 
[0m20:26:38.569430 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:26:38.570352 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:26:38.571814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:26:38.572451 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:26:38.576396 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:26:38.577213 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:26:38.573080 => 20:26:38.576978
[0m20:26:38.577689 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:26:38.630496 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:26:38.632205 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:26:38.632696 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:26:38.633026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:38.654608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:38.655438 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:26:38.656069 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:26:37' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:26:38.667160 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:26:38.675441 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:26:38.676164 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:26:38.676846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:38.679621 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:26:38.680121 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:26:38.681080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:38.705664 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:26:38.706087 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:26:38.706401 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:26:38.709506 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:38.715380 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:26:38.716216 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:26:38.719600 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:38.721951 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:26:38.578093 => 20:26:38.721671
[0m20:26:38.722693 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:26:38.723970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122fc9d0>]}
[0m20:26:38.725001 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.15s]
[0m20:26:38.726023 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:26:38.726871 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:26:38.727844 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:26:38.728888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:26:38.729489 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:26:38.734340 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:26:38.735755 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:26:38.729820 => 20:26:38.735280
[0m20:26:38.736439 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:26:38.742897 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:26:38.743815 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:26:38.744354 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:26:38.744855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:38.756006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:38.756512 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:26:38.756929 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:26:37' as dbt_time
from stg.airports_data
  );
  
[0m20:26:38.808603 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:26:38.812287 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:26:38.812806 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:26:38.813484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:38.816997 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:26:38.817422 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:26:38.818229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:38.820184 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:26:38.820676 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:26:38.821276 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:26:38.822949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:38.825981 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:26:38.826399 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:26:38.828873 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:38.830434 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:26:38.737018 => 20:26:38.830066
[0m20:26:38.831175 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:26:38.832263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b19510>]}
[0m20:26:38.832963 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.10s]
[0m20:26:38.833735 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:26:38.834364 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:26:38.834945 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:26:38.836186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:26:38.836711 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:26:38.838172 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:26:38.839554 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:26:38.836963 => 20:26:38.839253
[0m20:26:38.840346 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:26:38.848676 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:26:38.849904 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:26:38.851707 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:26:38.852288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:38.868719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:38.869455 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:26:38.870062 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select *
from stg.ticket_flights
  );
  
[0m20:26:41.479799 [debug] [Thread-1 (]: SQL status: SELECT 1045726 in 3.0 seconds
[0m20:26:41.482576 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:26:41.482975 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m20:26:41.565713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:41.570114 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:26:41.571148 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:26:41.572632 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:26:41.581050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:41.583704 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:26:41.584107 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m20:26:41.584769 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:41.586205 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 20:26:38.840762 => 20:26:41.586009
[0m20:26:41.586653 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m20:26:41.587421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112248050>]}
[0m20:26:41.588020 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 1045726[0m in 2.75s]
[0m20:26:41.588828 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m20:26:41.589459 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:26:41.590125 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:26:41.591568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m20:26:41.592309 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:26:41.596125 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:26:41.597442 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:26:41.592864 => 20:26:41.597060
[0m20:26:41.598045 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:26:41.605143 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:26:41.606195 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:26:41.606833 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:26:41.607317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:41.622116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:41.622543 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:26:41.623000 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:26:37' as dbt_time
from time_flight
  );
  
[0m20:26:41.839240 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m20:26:41.842639 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:26:41.843171 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:26:41.843989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:41.847468 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:26:41.847880 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:26:41.851767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:41.854587 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:26:41.855139 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:26:41.855538 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:26:41.861512 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:41.865045 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:26:41.866256 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:26:41.893315 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:41.894881 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:26:41.598438 => 20:26:41.894676
[0m20:26:41.895295 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:26:41.896056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112359510>]}
[0m20:26:41.896900 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.30s]
[0m20:26:41.897833 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:26:41.898512 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:26:41.899308 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:26:41.903419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m20:26:41.904112 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:26:41.907327 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:26:41.908845 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:26:41.904694 => 20:26:41.908325
[0m20:26:41.909353 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:26:41.914622 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:26:41.915626 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:26:41.916232 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:26:41.916905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:41.936995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:41.937930 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:26:41.938655 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:26:41.947633 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:26:41.953363 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:26:41.953913 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:26:41.954906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:41.958335 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:26:41.958852 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:26:41.959825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:41.962513 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:26:41.965173 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:26:41.965744 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:26:41.967251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:41.970596 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:26:41.971251 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:26:42.008746 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:26:42.010238 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:26:41.909623 => 20:26:42.010046
[0m20:26:42.010807 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:26:42.011754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122d1050>]}
[0m20:26:42.012772 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.11s]
[0m20:26:42.013846 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:26:42.015024 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:26:42.016274 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:26:42.019395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:26:42.020191 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:26:42.023344 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:26:42.024661 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:26:42.020908 => 20:26:42.024398
[0m20:26:42.025070 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:26:42.059049 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:26:42.060556 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:26:42.061364 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:26:42.061849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:42.076295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:42.076704 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:26:42.077034 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:26:42.079363 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:26:42.082802 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:26:42.083376 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:26:42.086383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:26:42.088552 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:26:42.089078 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:26:42.089397 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:26:42.090903 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:26:42.093617 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:26:42.094018 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:26:42.094650 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:26:42.096089 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:26:42.025339 => 20:26:42.095899
[0m20:26:42.096432 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:26:42.097221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e0cf78-30f8-4727-b916-21256f30bf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111474950>]}
[0m20:26:42.097852 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m20:26:42.098498 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:26:42.100595 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:42.101098 [debug] [MainThread]: On master: BEGIN
[0m20:26:42.101403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:42.110578 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:26:42.111330 [debug] [MainThread]: On master: COMMIT
[0m20:26:42.111963 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:42.112398 [debug] [MainThread]: On master: COMMIT
[0m20:26:42.112972 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:26:42.113433 [debug] [MainThread]: On master: Close
[0m20:26:42.114191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:42.114619 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:26:42.115088 [info ] [MainThread]: 
[0m20:26:42.115509 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m20:26:42.117331 [debug] [MainThread]: Command end result
[0m20:26:42.128513 [info ] [MainThread]: 
[0m20:26:42.129222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:42.129739 [info ] [MainThread]: 
[0m20:26:42.130326 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:26:42.131802 [debug] [MainThread]: Command `dbt run` succeeded at 20:26:42.131505 after 4.18 seconds
[0m20:26:42.132361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111859790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d923bd0>]}
[0m20:26:42.132844 [debug] [MainThread]: Flushing usage events
[0m20:29:43.192449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120cd1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df8a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e74950>]}


============================== 20:29:43.198463 | 5f8fbceb-1a1d-4b47-920c-62b19caa2b05 ==============================
[0m20:29:43.198463 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:29:43.199300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:29:43.289995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b3810>]}
[0m20:29:43.310310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dca790>]}
[0m20:29:43.311110 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:29:43.334844 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:29:43.375410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:29:43.376070 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:29:43.384518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d13990>]}
[0m20:29:43.395262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11247ded0>]}
[0m20:29:43.396153 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:29:43.396583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbe16d0>]}
[0m20:29:43.398823 [info ] [MainThread]: 
[0m20:29:43.400951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:29:43.409867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:29:43.424626 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:29:43.425373 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:29:43.426249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:43.460270 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:29:43.462437 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:29:43.464656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:29:43.472896 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:29:43.473306 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:29:43.473607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:43.485614 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:29:43.486249 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:29:43.486920 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:29:43.495565 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:29:43.497241 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:29:43.497820 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:29:43.505689 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:43.506258 [debug] [MainThread]: On master: BEGIN
[0m20:29:43.506526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:43.517790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:29:43.518145 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:43.518498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:29:43.540848 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:29:43.542482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b77f50>]}
[0m20:29:43.542906 [debug] [MainThread]: On master: ROLLBACK
[0m20:29:43.543312 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:43.543584 [debug] [MainThread]: On master: BEGIN
[0m20:29:43.544224 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:29:43.544519 [debug] [MainThread]: On master: COMMIT
[0m20:29:43.544790 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:43.545045 [debug] [MainThread]: On master: COMMIT
[0m20:29:43.545485 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:29:43.546009 [debug] [MainThread]: On master: Close
[0m20:29:43.546975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:43.547503 [info ] [MainThread]: 
[0m20:29:43.552846 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:29:43.553642 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:29:43.554863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:29:43.555628 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:29:43.559590 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:29:43.561088 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:29:43.556083 => 20:29:43.560704
[0m20:29:43.561914 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:29:43.613765 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:29:43.614547 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:29:43.614976 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:29:43.615283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:43.628041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:29:43.628598 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:29:43.629246 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:29:43' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:29:43.680219 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:29:43.689086 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:29:43.689913 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:29:43.691052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:43.694677 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:29:43.695099 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:29:43.695996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:43.720127 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:29:43.720659 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:29:43.721321 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:29:43.726014 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:29:43.732049 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:29:43.732477 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:29:43.736251 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:29:43.738611 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:29:43.562576 => 20:29:43.738405
[0m20:29:43.739446 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:29:43.740397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b9ad0>]}
[0m20:29:43.741175 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.19s]
[0m20:29:43.742080 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:29:43.742683 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:29:43.743333 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:29:43.744128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:29:43.744571 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:29:43.747876 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:29:43.749056 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:29:43.744811 => 20:29:43.748587
[0m20:29:43.749666 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:29:43.756484 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:29:43.757697 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:29:43.758777 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:29:43.759350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:43.773544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:29:43.774104 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:29:43.774596 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:29:43' as dbt_time
from stg.airports_data
  );
  
[0m20:29:43.785755 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:29:43.789711 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:29:43.790438 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:29:43.793894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:43.798531 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:29:43.799020 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:29:43.800236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:43.803049 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:29:43.803996 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:29:43.804426 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:29:43.808893 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:29:43.813551 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:29:43.814761 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:29:43.819772 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:29:43.821945 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:29:43.750040 => 20:29:43.821554
[0m20:29:43.822605 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:29:43.823850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c987d0>]}
[0m20:29:43.824582 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.08s]
[0m20:29:43.825602 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:29:43.826820 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:29:43.827284 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:29:43.828421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:29:43.829091 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:29:43.831788 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:29:43.833145 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:29:43.829519 => 20:29:43.832863
[0m20:29:43.833969 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:29:43.840368 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:29:43.841855 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:29:43.842381 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:29:43.842861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:43.877533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:29:43.878062 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:29:43.878696 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select *
from stg.ticket_flights
  );
  
[0m20:29:47.010808 [debug] [Thread-1 (]: SQL status: SELECT 1045726 in 3.0 seconds
[0m20:29:47.013629 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:29:47.014146 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m20:29:47.015176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:47.019755 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:29:47.020534 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m20:29:47.022044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:47.026021 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:29:47.026635 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:29:47.027062 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:29:47.034407 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:29:47.037725 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:29:47.038283 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m20:29:47.050070 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:29:47.052108 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 20:29:43.834385 => 20:29:47.051782
[0m20:29:47.053147 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m20:29:47.054291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c9a990>]}
[0m20:29:47.055092 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 1045726[0m in 3.23s]
[0m20:29:47.056569 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m20:29:47.057378 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:29:47.058347 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:29:47.059530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m20:29:47.060178 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:29:47.062935 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:29:47.063967 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:29:47.060464 => 20:29:47.063672
[0m20:29:47.064386 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:29:47.068310 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:29:47.069386 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:29:47.070150 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:29:47.070669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:47.085436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:29:47.086020 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:29:47.086535 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:29:43' as dbt_time
from time_flight
  );
  
[0m20:29:47.194386 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m20:29:47.197897 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:29:47.198287 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:29:47.199025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:47.202776 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:29:47.203342 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:29:47.207241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:47.210550 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:29:47.211111 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:29:47.211539 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:29:47.221675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:29:47.225489 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:29:47.225942 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:29:47.231806 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:29:47.233739 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:29:47.064699 => 20:29:47.233497
[0m20:29:47.234253 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:29:47.235247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c52b50>]}
[0m20:29:47.236128 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.18s]
[0m20:29:47.236919 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:29:47.237476 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:29:47.238156 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:29:47.239583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m20:29:47.240349 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:29:47.243796 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:29:47.244952 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:29:47.240701 => 20:29:47.244513
[0m20:29:47.245531 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:29:47.251492 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:29:47.252356 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:29:47.252809 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:29:47.253136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:47.265898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:29:47.266297 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:29:47.266674 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:29:47.269830 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:29:47.273938 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:29:47.274597 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:29:47.275579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:47.278433 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:29:47.279070 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:29:47.280596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:47.286633 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:29:47.287317 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:29:47.287906 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:29:47.293292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:29:47.296909 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:29:47.297490 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:29:47.303022 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:29:47.304982 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:29:47.245904 => 20:29:47.304659
[0m20:29:47.305393 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:29:47.306279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cccc90>]}
[0m20:29:47.307340 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.07s]
[0m20:29:47.308217 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:29:47.310131 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:29:47.311030 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:29:47.311997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:29:47.312525 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:29:47.315705 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:29:47.316750 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:29:47.312756 => 20:29:47.316382
[0m20:29:47.317192 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:29:47.343345 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:29:47.344323 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:29:47.344784 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:29:47.345220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:47.359340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:29:47.360970 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:29:47.361805 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:29:47.369237 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:29:47.372687 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:29:47.373605 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:29:47.374577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:47.377709 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:29:47.378368 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:29:47.378799 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:29:47.379979 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:29:47.382325 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:29:47.382666 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:29:47.383225 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:29:47.384787 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:29:47.317412 => 20:29:47.384564
[0m20:29:47.385541 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:29:47.386614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f8fbceb-1a1d-4b47-920c-62b19caa2b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b7cf10>]}
[0m20:29:47.387487 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m20:29:47.388453 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:29:47.390984 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:47.391576 [debug] [MainThread]: On master: BEGIN
[0m20:29:47.392054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:29:47.406320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:29:47.406694 [debug] [MainThread]: On master: COMMIT
[0m20:29:47.407132 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:47.407422 [debug] [MainThread]: On master: COMMIT
[0m20:29:47.408529 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:29:47.409372 [debug] [MainThread]: On master: Close
[0m20:29:47.410734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:47.411201 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:29:47.411589 [info ] [MainThread]: 
[0m20:29:47.411994 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m20:29:47.414239 [debug] [MainThread]: Command end result
[0m20:29:47.424551 [info ] [MainThread]: 
[0m20:29:47.425340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:47.426230 [info ] [MainThread]: 
[0m20:29:47.426998 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:29:47.428330 [debug] [MainThread]: Command `dbt run` succeeded at 20:29:47.428085 after 4.26 seconds
[0m20:29:47.429003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e27fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e28ca50>]}
[0m20:29:47.429979 [debug] [MainThread]: Flushing usage events
[0m20:30:10.072298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109532590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109876ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b9bd0>]}


============================== 20:30:10.078147 | 1d6858e2-fb99-491f-bb58-187fea0ac79b ==============================
[0m20:30:10.078147 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:30:10.079681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:30:10.175739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109946350>]}
[0m20:30:10.193885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095329d0>]}
[0m20:30:10.195371 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:30:10.220275 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:30:10.260745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:30:10.261543 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m20:30:10.291297 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_boarding_passes.sql
[0m20:30:10.365466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27bf90>]}
[0m20:30:10.375008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a297d50>]}
[0m20:30:10.375567 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:30:10.375990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26e410>]}
[0m20:30:10.379166 [info ] [MainThread]: 
[0m20:30:10.380451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:30:10.382581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:30:10.394802 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:30:10.395314 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:30:10.395726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:10.444377 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:30:10.446174 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:30:10.449485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:30:10.456130 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:30:10.456592 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:30:10.456872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:10.466601 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:30:10.466966 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:30:10.467266 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:30:10.471586 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:30:10.472960 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:30:10.473367 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:30:10.480551 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:10.481397 [debug] [MainThread]: On master: BEGIN
[0m20:30:10.481853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:10.496107 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:30:10.496901 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:10.497696 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:30:10.528201 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:30:10.530524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956b6d0>]}
[0m20:30:10.531074 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:10.531656 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:10.531942 [debug] [MainThread]: On master: BEGIN
[0m20:30:10.532641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:30:10.533008 [debug] [MainThread]: On master: COMMIT
[0m20:30:10.533285 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:10.533543 [debug] [MainThread]: On master: COMMIT
[0m20:30:10.533902 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:30:10.534179 [debug] [MainThread]: On master: Close
[0m20:30:10.534858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:30:10.535273 [info ] [MainThread]: 
[0m20:30:10.539023 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:30:10.539854 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:30:10.540876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:30:10.541554 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:30:10.546235 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:30:10.547839 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:30:10.542029 => 20:30:10.547246
[0m20:30:10.548828 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:30:10.601183 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:30:10.602175 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:30:10.602781 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:30:10.603221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:10.616080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:10.616570 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:30:10.616998 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:30:10' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:30:10.667543 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:30:10.674212 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:30:10.674649 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:30:10.675297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:10.678989 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:30:10.680296 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:30:10.681420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:10.706813 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:30:10.707395 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:30:10.707743 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:30:10.710145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:10.716239 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:30:10.716681 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:30:10.790352 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:30:10.792024 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:30:10.549695 => 20:30:10.791791
[0m20:30:10.792432 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:30:10.793155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3287d0>]}
[0m20:30:10.793862 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.25s]
[0m20:30:10.794772 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:30:10.795425 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:30:10.796080 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:30:10.797105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:30:10.797552 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:30:10.800560 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:30:10.801512 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:30:10.797827 => 20:30:10.801223
[0m20:30:10.802145 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:30:10.807379 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:30:10.808212 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:30:10.808734 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:30:10.809414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:10.826942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:10.827544 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:30:10.828473 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:30:10' as dbt_time
from stg.airports_data
  );
  
[0m20:30:10.841264 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:30:10.844147 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:30:10.844992 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:30:10.846247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:10.850302 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:30:10.850878 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:30:10.851709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:10.854304 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:30:10.854796 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:30:10.855125 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:30:10.856650 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:10.859423 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:30:10.859910 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:30:10.862859 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:30:10.865086 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:30:10.802496 => 20:30:10.864840
[0m20:30:10.865753 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:30:10.866757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a410e10>]}
[0m20:30:10.867650 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.07s]
[0m20:30:10.868323 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:30:10.869027 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:30:10.870271 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:30:10.871955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:30:10.872766 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:30:10.874648 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:30:10.876022 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:30:10.873143 => 20:30:10.875493
[0m20:30:10.876969 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:30:10.887542 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:30:10.888621 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:30:10.889510 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:30:10.890092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:10.904639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:10.905383 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:30:10.905900 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select tf.*
from stg.ticket_flights as tf
inner join stg.boarding_passes as bp on tf.flight_id = bp.flight_id 
and bp.ticket_no =tf.ticket_no
  );
  
[0m20:30:13.574420 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 3.0 seconds
[0m20:30:13.576900 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:30:13.577249 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m20:30:13.580205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:13.583937 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:30:13.584358 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m20:30:13.631364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:13.633916 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:30:13.634311 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:30:13.634622 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:30:13.641180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:13.643603 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:30:13.643957 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m20:30:13.652721 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:30:13.654180 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 20:30:10.877588 => 20:30:13.653991
[0m20:30:13.654593 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m20:30:13.655373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a45cf50>]}
[0m20:30:13.655933 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 2.78s]
[0m20:30:13.656684 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m20:30:13.657370 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:30:13.658054 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:30:13.659104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m20:30:13.659642 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:30:13.663152 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:30:13.664327 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:30:13.659949 => 20:30:13.663879
[0m20:30:13.665066 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:30:13.671477 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:30:13.672193 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:30:13.672559 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:30:13.672862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:13.686168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:13.686664 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:30:13.687106 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:30:10' as dbt_time
from time_flight
  );
  
[0m20:30:13.884065 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m20:30:13.887729 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:30:13.888397 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:30:13.889786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:13.893385 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:30:13.893973 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:30:13.897868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:13.900569 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:30:13.900982 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:30:13.901295 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:30:13.902650 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:13.905635 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:30:13.906035 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:30:13.909881 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:30:13.911472 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:30:13.665892 => 20:30:13.911180
[0m20:30:13.911878 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:30:13.912721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4317d0>]}
[0m20:30:13.913748 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.25s]
[0m20:30:13.914785 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:30:13.915710 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:30:13.916564 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:30:13.917594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m20:30:13.918173 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:30:13.921986 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:30:13.923253 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:30:13.918450 => 20:30:13.922888
[0m20:30:13.923672 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:30:13.927948 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:30:13.929101 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:30:13.929827 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:30:13.930374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:13.941814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:13.942320 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:30:13.942775 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:30:13.947634 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:30:13.953120 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:30:13.953671 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:30:13.954976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:13.958122 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:30:13.958785 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:30:13.960790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:13.964327 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:30:13.964921 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:30:13.965518 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:30:13.970801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:13.974338 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:30:13.974778 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:30:13.977922 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:30:13.981635 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:30:13.923897 => 20:30:13.981421
[0m20:30:13.982238 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:30:13.983263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a300f90>]}
[0m20:30:13.984242 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.07s]
[0m20:30:13.985039 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:30:13.986175 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:30:13.986989 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:30:13.987876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:30:13.989845 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:30:13.993690 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:30:13.995151 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:30:13.990279 => 20:30:13.994749
[0m20:30:13.995756 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:30:14.023685 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:30:14.024976 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:30:14.025562 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:30:14.028163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:14.040368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:30:14.044372 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:30:14.050755 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:30:14.054080 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:30:14.057256 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:30:14.057795 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:30:14.058787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:30:14.060721 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:30:14.061075 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:30:14.061385 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:30:14.062839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:30:14.065427 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:30:14.065838 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:30:14.066429 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:30:14.067763 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:30:13.996180 => 20:30:14.067573
[0m20:30:14.068300 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:30:14.072390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6858e2-fb99-491f-bb58-187fea0ac79b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a36ff10>]}
[0m20:30:14.073098 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m20:30:14.074138 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:30:14.076081 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:14.076558 [debug] [MainThread]: On master: BEGIN
[0m20:30:14.077097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:30:14.099030 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:30:14.099872 [debug] [MainThread]: On master: COMMIT
[0m20:30:14.100419 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:14.100826 [debug] [MainThread]: On master: COMMIT
[0m20:30:14.101519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:30:14.102015 [debug] [MainThread]: On master: Close
[0m20:30:14.102981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:14.103471 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:30:14.103980 [info ] [MainThread]: 
[0m20:30:14.104495 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m20:30:14.106474 [debug] [MainThread]: Command end result
[0m20:30:14.115632 [info ] [MainThread]: 
[0m20:30:14.116407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:14.117162 [info ] [MainThread]: 
[0m20:30:14.117815 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:30:14.119068 [debug] [MainThread]: Command `dbt run` succeeded at 20:30:14.118828 after 4.07 seconds
[0m20:30:14.119740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099fb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095fe490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5fd90>]}
[0m20:30:14.120248 [debug] [MainThread]: Flushing usage events
[0m20:31:02.119934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a22b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a36c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a23150>]}


============================== 20:31:02.127494 | 7bc8592e-fe85-4c8e-94ce-a09269ddda4b ==============================
[0m20:31:02.127494 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:31:02.129543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:31:02.234252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140195d0>]}
[0m20:31:02.259113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c606d0>]}
[0m20:31:02.260609 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:31:02.294681 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:31:02.336029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:31:02.336743 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m20:31:02.365554 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_boarding_passes.sql
[0m20:31:02.432446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114754b90>]}
[0m20:31:02.441570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147b87d0>]}
[0m20:31:02.442132 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:31:02.442550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115cd890>]}
[0m20:31:02.445562 [info ] [MainThread]: 
[0m20:31:02.447129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:02.450035 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:31:02.464722 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:31:02.465403 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:31:02.465731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:02.505997 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:31:02.507853 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:31:02.510347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:31:02.517744 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:31:02.518479 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:31:02.518976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:02.533325 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:31:02.533765 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:31:02.534235 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:31:02.539486 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:31:02.541143 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:31:02.541869 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:31:02.547724 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:02.548273 [debug] [MainThread]: On master: BEGIN
[0m20:31:02.548632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:02.558921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:31:02.559411 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:02.559829 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:31:02.583826 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:31:02.585502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114869d90>]}
[0m20:31:02.586542 [debug] [MainThread]: On master: ROLLBACK
[0m20:31:02.587599 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:02.588192 [debug] [MainThread]: On master: BEGIN
[0m20:31:02.589142 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:31:02.589776 [debug] [MainThread]: On master: COMMIT
[0m20:31:02.590257 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:02.590556 [debug] [MainThread]: On master: COMMIT
[0m20:31:02.591116 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:31:02.591638 [debug] [MainThread]: On master: Close
[0m20:31:02.592458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:31:02.593118 [info ] [MainThread]: 
[0m20:31:02.597801 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:31:02.598488 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:31:02.599490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:31:02.600252 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:31:02.605016 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:31:02.605937 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:31:02.600809 => 20:31:02.605704
[0m20:31:02.606380 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:31:02.657526 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:31:02.658846 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:02.659707 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:31:02.660080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:02.671672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:02.672087 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:02.672433 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:31:02' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:31:02.690278 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:31:02.697466 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:02.698170 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:31:02.699175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:02.702264 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:02.702627 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:31:02.703612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:02.728719 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:31:02.729570 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:02.730311 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:31:02.732820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:02.738873 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:02.739313 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:31:02.742677 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:31:02.744653 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:31:02.606605 => 20:31:02.744432
[0m20:31:02.745420 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:31:02.746381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a14210>]}
[0m20:31:02.748260 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.15s]
[0m20:31:02.749541 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:31:02.750034 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:31:02.750770 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:31:02.751717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:31:02.752247 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:31:02.755185 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:31:02.756614 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:31:02.752668 => 20:31:02.755914
[0m20:31:02.757057 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:31:02.763307 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:31:02.764569 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:02.765062 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:31:02.765377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:02.778530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:02.778972 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:02.779380 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:31:02' as dbt_time
from stg.airports_data
  );
  
[0m20:31:02.799608 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:31:02.803940 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:02.804478 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:31:02.805383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:02.809062 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:02.809684 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:31:02.810892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:02.814150 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:31:02.815362 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:02.815846 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:31:02.817659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:02.821057 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:02.821606 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:31:02.826106 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:31:02.827866 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:31:02.757330 => 20:31:02.827646
[0m20:31:02.828868 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:31:02.830086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114774990>]}
[0m20:31:02.830762 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.08s]
[0m20:31:02.831543 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:31:02.831983 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:31:02.832513 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:31:02.833547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:31:02.834135 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:31:02.836790 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:31:02.837616 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:31:02.834621 => 20:31:02.837405
[0m20:31:02.838174 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:31:02.848883 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:31:02.849830 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:02.850368 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:31:02.850733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:02.877258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:02.878045 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:02.878867 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select  bp.*, tf.fare_conditions, tf.amount
from stg.ticket_flights as tf
inner join stg.boarding_passes as bp on tf.flight_id = bp.flight_id 
and bp.ticket_no =tf.ticket_no
limit 10
  );
  
[0m20:31:02.889320 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m20:31:02.893082 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:02.893689 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m20:31:02.894679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:02.897382 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:31:02.897859 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:02.898378 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:31:02.899997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:02.903961 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:02.904543 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m20:31:02.905362 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:31:02.907213 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 20:31:02.838509 => 20:31:02.906991
[0m20:31:02.907675 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m20:31:02.908502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114931e10>]}
[0m20:31:02.909380 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 10[0m in 0.08s]
[0m20:31:02.910163 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m20:31:02.911125 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:31:02.911771 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:31:02.912887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m20:31:02.913383 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:31:02.917613 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:31:02.919223 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:31:02.913848 => 20:31:02.918711
[0m20:31:02.920204 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:31:02.926829 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:31:02.928346 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:02.929260 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:31:02.929792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:02.944630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:02.945258 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:02.946093 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:31:02' as dbt_time
from time_flight
  );
  
[0m20:31:03.133457 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m20:31:03.136561 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:03.136983 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:31:03.138507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:03.141336 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:03.141807 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:31:03.145660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:03.151053 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:31:03.151846 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:03.152407 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:31:03.175896 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:03.179137 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:03.180023 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:31:03.183778 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:31:03.185253 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:31:02.920742 => 20:31:03.185051
[0m20:31:03.185593 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:31:03.187126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149147d0>]}
[0m20:31:03.188386 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.27s]
[0m20:31:03.190264 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:31:03.190893 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:31:03.191494 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:31:03.192697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m20:31:03.193112 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:31:03.198789 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:31:03.204495 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:31:03.193339 => 20:31:03.199608
[0m20:31:03.205143 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:31:03.218282 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:31:03.219559 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:03.220127 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:31:03.221154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:03.236480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:03.237051 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:03.237425 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:31:03.244675 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:31:03.250651 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:03.251154 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:31:03.252121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:03.255940 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:03.256343 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:31:03.257288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:03.260143 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:31:03.260945 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:03.261334 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:31:03.262607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:03.266253 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:03.266662 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:31:03.269227 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:31:03.270824 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:31:03.208257 => 20:31:03.270626
[0m20:31:03.271349 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:31:03.272311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11476c190>]}
[0m20:31:03.273188 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.08s]
[0m20:31:03.274299 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:31:03.275535 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:31:03.276243 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:31:03.277968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:31:03.288314 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:31:03.294043 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:31:03.295924 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:31:03.289783 => 20:31:03.295081
[0m20:31:03.296719 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:31:03.333816 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:31:03.334547 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:31:03.334912 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:31:03.335222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:03.346584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:03.347285 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:31:03.348031 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:31:03.352355 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:31:03.356087 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:31:03.356516 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:31:03.357493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:03.367220 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:31:03.367816 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:31:03.368425 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:31:03.373591 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:03.376721 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:31:03.377456 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:31:03.378277 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:31:03.380586 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:31:03.297120 => 20:31:03.380055
[0m20:31:03.381071 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:31:03.382133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bc8592e-fe85-4c8e-94ce-a09269ddda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114958210>]}
[0m20:31:03.383329 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.11s]
[0m20:31:03.384212 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:31:03.386022 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:03.386378 [debug] [MainThread]: On master: BEGIN
[0m20:31:03.386637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:03.400634 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:31:03.401130 [debug] [MainThread]: On master: COMMIT
[0m20:31:03.401484 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:03.401788 [debug] [MainThread]: On master: COMMIT
[0m20:31:03.403069 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:31:03.403792 [debug] [MainThread]: On master: Close
[0m20:31:03.404561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:03.404940 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:31:03.405428 [info ] [MainThread]: 
[0m20:31:03.405871 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m20:31:03.407453 [debug] [MainThread]: Command end result
[0m20:31:03.418728 [info ] [MainThread]: 
[0m20:31:03.420193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:31:03.421057 [info ] [MainThread]: 
[0m20:31:03.422068 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:31:03.423342 [debug] [MainThread]: Command `dbt run` succeeded at 20:31:03.423192 after 1.33 seconds
[0m20:31:03.423918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a1f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ffcf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c60550>]}
[0m20:31:03.424373 [debug] [MainThread]: Flushing usage events
[0m20:31:20.627221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c725850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c694a50>]}


============================== 20:31:20.635449 | 6f5dc5b4-ce6a-4dae-8605-a138542c45e8 ==============================
[0m20:31:20.635449 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:31:20.636495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:31:20.740102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc5fe90>]}
[0m20:31:20.766198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c986590>]}
[0m20:31:20.769825 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:31:20.809297 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:31:20.858381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:31:20.859141 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m20:31:20.889222 [debug] [MainThread]: 1699: static parser successfully parsed facts/fact_boarding_passes.sql
[0m20:31:20.970114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9b8d90>]}
[0m20:31:20.980576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4ee590>]}
[0m20:31:20.981674 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:31:20.982632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a5750>]}
[0m20:31:20.985887 [info ] [MainThread]: 
[0m20:31:20.986950 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:20.989314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:31:21.002393 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:31:21.003062 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:31:21.003867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:21.035185 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:31:21.038578 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:31:21.041286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:31:21.048306 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:31:21.049578 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:31:21.050069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:21.063716 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:31:21.064114 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:31:21.064436 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:31:21.071039 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:31:21.072821 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:31:21.073563 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:31:21.079739 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.080123 [debug] [MainThread]: On master: BEGIN
[0m20:31:21.080391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:21.090773 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:31:21.091129 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.091486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:31:21.120476 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:31:21.122057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d412790>]}
[0m20:31:21.122465 [debug] [MainThread]: On master: ROLLBACK
[0m20:31:21.122943 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.123232 [debug] [MainThread]: On master: BEGIN
[0m20:31:21.123844 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:31:21.124251 [debug] [MainThread]: On master: COMMIT
[0m20:31:21.124853 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.125245 [debug] [MainThread]: On master: COMMIT
[0m20:31:21.125635 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:31:21.125933 [debug] [MainThread]: On master: Close
[0m20:31:21.126576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:31:21.127140 [info ] [MainThread]: 
[0m20:31:21.131583 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:31:21.132149 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:31:21.133148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:31:21.133701 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:31:21.137129 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:31:21.138218 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:31:21.133956 => 20:31:21.137718
[0m20:31:21.139122 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:31:21.185452 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:31:21.186286 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:21.186632 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:31:21.186956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:21.197836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:21.198431 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:21.198826 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:31:20' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:31:21.249955 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:31:21.255751 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:21.256225 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:31:21.257076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:21.260601 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:21.260990 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:31:21.343531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:21.365872 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:31:21.366470 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:21.367016 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:31:21.534982 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:21.540938 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:31:21.541415 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:31:21.625617 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:31:21.627638 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:31:21.139474 => 20:31:21.627307
[0m20:31:21.628494 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:31:21.630128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3c3690>]}
[0m20:31:21.631089 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.50s]
[0m20:31:21.632101 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:31:21.632962 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:31:21.633787 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:31:21.634902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:31:21.635449 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:31:21.639168 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:31:21.640716 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:31:21.635773 => 20:31:21.640182
[0m20:31:21.641584 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:31:21.647787 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:31:21.648735 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:21.649397 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:31:21.650203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:21.660996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:21.661396 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:21.661819 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:31:20' as dbt_time
from stg.airports_data
  );
  
[0m20:31:21.708503 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:31:21.712072 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:21.712813 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:31:21.713690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:21.717324 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:21.718026 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:31:21.800094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:21.803670 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:31:21.804087 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:21.804411 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:31:21.886610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:21.889979 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:31:21.890529 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:31:21.974587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:31:21.976081 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:31:21.641995 => 20:31:21.975891
[0m20:31:21.976492 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:31:21.977434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4583d0>]}
[0m20:31:21.978100 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.34s]
[0m20:31:21.978932 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:31:21.979405 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:31:21.980063 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:31:21.980929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:31:21.981336 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:31:21.983616 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:31:21.984706 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:31:21.981561 => 20:31:21.984271
[0m20:31:21.985486 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:31:21.994461 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:31:21.995483 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:21.996024 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:31:21.996649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:22.010496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:22.010956 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:22.011392 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select  bp.*, tf.fare_conditions, tf.amount
from stg.ticket_flights as tf
inner join stg.boarding_passes as bp on tf.flight_id = bp.flight_id 
and bp.ticket_no =tf.ticket_no
  );
  
[0m20:31:25.549191 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 4.0 seconds
[0m20:31:25.552402 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:25.553050 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m20:31:25.553947 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:25.557251 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:25.557667 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m20:31:25.610919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:25.613188 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:31:25.613555 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:25.613899 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:31:25.655964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:25.659372 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:31:25.660196 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m20:31:25.662464 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:31:25.663961 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 20:31:21.985822 => 20:31:25.663772
[0m20:31:25.664310 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m20:31:25.665036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5ae5d0>]}
[0m20:31:25.665768 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 3.68s]
[0m20:31:25.666947 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m20:31:25.669106 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:31:25.670029 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:31:25.671108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m20:31:25.671712 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:31:25.674587 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:31:25.675550 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:31:25.672038 => 20:31:25.675232
[0m20:31:25.676108 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:31:25.680938 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:31:25.681746 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:25.682340 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:31:25.682713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:25.696215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:25.696664 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:25.697234 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:31:20' as dbt_time
from time_flight
  );
  
[0m20:31:25.792471 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m20:31:25.795025 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:25.795387 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:31:25.796666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:25.801902 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:25.802491 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:31:25.806381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:25.810103 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:31:25.810593 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:25.810929 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:31:25.814460 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:25.817801 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:31:25.818442 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:31:25.824802 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:31:25.827098 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:31:25.676405 => 20:31:25.826869
[0m20:31:25.827838 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:31:25.829021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d599150>]}
[0m20:31:25.830555 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.16s]
[0m20:31:25.831532 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:31:25.832189 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:31:25.833004 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:31:25.834375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m20:31:25.834999 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:31:25.839099 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:31:25.839896 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:31:25.835444 => 20:31:25.839688
[0m20:31:25.840268 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:31:25.845306 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:31:25.846021 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:25.846389 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:31:25.846692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:25.859459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:25.859861 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:25.860207 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:31:25.862469 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:31:25.866257 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:25.866830 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:31:25.867712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:25.872014 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:25.872444 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:31:25.873221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:25.876464 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:31:25.876883 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:25.877199 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:31:25.878464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:25.880726 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:31:25.881076 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:31:25.884227 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:31:25.890460 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:31:25.840533 => 20:31:25.890223
[0m20:31:25.890935 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:31:25.892135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5dc110>]}
[0m20:31:25.893092 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.06s]
[0m20:31:25.893886 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:31:25.894968 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:31:25.895783 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:31:25.896708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:31:25.897229 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:31:25.901606 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:31:25.902743 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:31:25.898235 => 20:31:25.902409
[0m20:31:25.903586 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:31:25.927016 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:31:25.927927 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:31:25.928592 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:31:25.929118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:25.939968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:31:25.940373 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:31:25.940712 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:31:25.955905 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:31:25.959801 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:31:25.960231 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:31:25.960937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:31:25.963156 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:31:25.963832 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:31:25.964339 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:31:25.967426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:31:25.970585 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:31:25.971076 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:31:25.971646 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:31:25.972980 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:31:25.903938 => 20:31:25.972788
[0m20:31:25.973330 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:31:25.974025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5dc5b4-ce6a-4dae-8605-a138542c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3c1b10>]}
[0m20:31:25.974602 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m20:31:25.975574 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:31:25.977654 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:25.978129 [debug] [MainThread]: On master: BEGIN
[0m20:31:25.978427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:25.992593 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:31:25.992970 [debug] [MainThread]: On master: COMMIT
[0m20:31:25.993247 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:25.993547 [debug] [MainThread]: On master: COMMIT
[0m20:31:25.994174 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:31:25.994641 [debug] [MainThread]: On master: Close
[0m20:31:25.995353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:25.995681 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:31:25.996122 [info ] [MainThread]: 
[0m20:31:25.996561 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m20:31:25.998285 [debug] [MainThread]: Command end result
[0m20:31:26.008918 [info ] [MainThread]: 
[0m20:31:26.009662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:31:26.010564 [info ] [MainThread]: 
[0m20:31:26.011200 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:31:26.011983 [debug] [MainThread]: Command `dbt run` succeeded at 20:31:26.011853 after 5.41 seconds
[0m20:31:26.012510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc5ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b47e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab1710>]}
[0m20:31:26.012960 [debug] [MainThread]: Flushing usage events
[0m20:33:06.802809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108088390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809c650>]}


============================== 20:33:06.812371 | 233760be-7870-4df5-9a29-bab68e6ed7ae ==============================
[0m20:33:06.812371 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:33:06.813163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:33:06.950213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108720b50>]}
[0m20:33:06.976500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e0fd0>]}
[0m20:33:06.977399 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:33:07.009425 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:33:07.061223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:33:07.061980 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/fact_boarding_passes.sql
[0m20:33:07.120738 [debug] [MainThread]: 1603: static parser failed on facts/fact_boarding_passes.sql
[0m20:33:07.149520 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_boarding_passes.sql
[0m20:33:07.213526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da3dd0>]}
[0m20:33:07.223384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da3dd0>]}
[0m20:33:07.224066 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:33:07.224478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e89790>]}
[0m20:33:07.227503 [info ] [MainThread]: 
[0m20:33:07.228641 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:33:07.230192 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:33:07.245079 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:33:07.245997 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:33:07.246737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:07.419576 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:33:07.421243 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:33:07.423455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:33:07.431177 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:33:07.431529 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:33:07.431811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:07.443714 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:33:07.444242 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:33:07.444644 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:33:07.544472 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:33:07.546106 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:33:07.546887 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:33:07.554452 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:07.555084 [debug] [MainThread]: On master: BEGIN
[0m20:33:07.555622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:07.568281 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:07.568902 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:07.569389 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:33:07.598490 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:33:07.600260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e89790>]}
[0m20:33:07.600890 [debug] [MainThread]: On master: ROLLBACK
[0m20:33:07.601773 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:07.602218 [debug] [MainThread]: On master: BEGIN
[0m20:33:07.602880 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:07.603210 [debug] [MainThread]: On master: COMMIT
[0m20:33:07.603557 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:07.604107 [debug] [MainThread]: On master: COMMIT
[0m20:33:07.605230 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:33:07.606302 [debug] [MainThread]: On master: Close
[0m20:33:07.607497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:33:07.608087 [info ] [MainThread]: 
[0m20:33:07.612129 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:33:07.612840 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:33:07.614258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:33:07.614915 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:33:07.618651 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:33:07.619732 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:33:07.615405 => 20:33:07.619417
[0m20:33:07.620130 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:33:07.672873 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:33:07.674375 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:07.675256 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:33:07.675906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:07.694121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:07.694599 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:07.695066 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:33:06' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:33:08.116465 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:33:08.124168 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:08.124764 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:33:08.125558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:08.129050 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:08.129511 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:33:08.235010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:08.267305 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:33:08.267881 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:08.268620 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:33:08.352054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:08.358922 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:08.359650 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:33:08.443318 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:08.444803 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:33:07.620459 => 20:33:08.444602
[0m20:33:08.445148 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:33:08.446261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108772290>]}
[0m20:33:08.447781 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.83s]
[0m20:33:08.448894 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:33:08.449804 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:33:08.450553 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:33:08.451567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:33:08.452136 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:33:08.455462 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:33:08.457271 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:33:08.452822 => 20:33:08.456903
[0m20:33:08.457829 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:33:08.463760 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:33:08.464724 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:08.465207 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:33:08.465551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:08.490059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:08.490706 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:08.491078 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:33:06' as dbt_time
from stg.airports_data
  );
  
[0m20:33:08.536674 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:33:08.540949 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:08.541531 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:33:08.542401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:08.545123 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:08.545584 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:33:08.587535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:08.590555 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:33:08.591236 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:08.591816 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:33:08.708393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:08.714015 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:08.714658 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:33:08.801591 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:08.803992 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:33:08.458188 => 20:33:08.803702
[0m20:33:08.804829 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:33:08.806564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8abd0>]}
[0m20:33:08.807947 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.36s]
[0m20:33:08.809380 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:33:08.810092 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:33:08.810791 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:33:08.812883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:33:08.813429 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:33:08.818386 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:33:08.820503 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:33:08.813961 => 20:33:08.819972
[0m20:33:08.821788 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:33:08.829409 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:33:08.830325 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:08.830772 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:33:08.831178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:08.853647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:08.854695 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:08.855528 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select  bp.*, tf.fare_conditions, tf.amount,
	   '2023-08-16 17:33:06' as dbt_time
from stg.ticket_flights as tf
inner join stg.boarding_passes as bp on tf.flight_id = bp.flight_id 
and bp.ticket_no =tf.ticket_no
  );
  
[0m20:33:18.403084 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 10.0 seconds
[0m20:33:18.408305 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:18.409158 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m20:33:18.451163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:18.455082 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:18.455630 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m20:33:18.456814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:18.459568 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:33:18.460006 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:18.460348 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:33:18.474750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:18.477744 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:18.478162 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m20:33:18.486008 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:18.488666 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 20:33:08.822292 => 20:33:18.488192
[0m20:33:18.489120 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m20:33:18.490027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f660d0>]}
[0m20:33:18.490862 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 9.68s]
[0m20:33:18.491708 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m20:33:18.492397 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:33:18.493078 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:33:18.494098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m20:33:18.494798 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:33:18.499424 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:33:18.500950 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:33:18.495105 => 20:33:18.500539
[0m20:33:18.501489 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:33:18.509456 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:33:18.510420 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:18.510877 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:33:18.511200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:18.563253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:18.564040 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:18.564808 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:33:06' as dbt_time
from time_flight
  );
  
[0m20:33:18.757951 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m20:33:18.760871 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:18.761266 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:33:18.762283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:18.765625 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:18.766300 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:33:18.770275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:18.772796 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:33:18.773276 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:18.773592 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:33:18.778838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:18.781893 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:18.782271 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:33:18.785332 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:18.787259 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:33:18.501851 => 20:33:18.786954
[0m20:33:18.787908 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:33:18.788716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbc550>]}
[0m20:33:18.789592 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.30s]
[0m20:33:18.790475 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:33:18.791101 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:33:18.792024 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:33:18.793132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m20:33:18.793806 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:33:18.798028 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:33:18.799373 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:33:18.794262 => 20:33:18.799143
[0m20:33:18.799993 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:33:18.805093 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:33:18.806702 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:18.807473 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:33:18.808001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:18.818807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:18.819448 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:18.819986 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:33:18.824115 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:33:18.827457 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:18.827993 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:33:18.829712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:18.834371 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:18.835134 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:33:18.839817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:18.845349 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:33:18.846099 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:18.846926 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:33:18.848742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:18.851389 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:18.851919 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:33:18.854597 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:18.857022 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:33:18.800252 => 20:33:18.856657
[0m20:33:18.857522 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:33:18.858285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc6790>]}
[0m20:33:18.858850 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.07s]
[0m20:33:18.859632 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:33:18.860583 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:33:18.861267 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:33:18.862101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:33:18.862717 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:33:18.866006 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:33:18.867442 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:33:18.863238 => 20:33:18.867007
[0m20:33:18.868028 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:33:18.892690 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:33:18.893608 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:33:18.894052 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:33:18.894529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:18.914493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:18.914907 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:33:18.915243 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:33:18.917631 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:33:18.920724 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:33:18.921216 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:33:18.922041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:18.925713 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:33:18.926399 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:33:18.926912 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:33:18.928414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:18.931020 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:33:18.931401 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:33:18.932017 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:33:18.933373 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:33:18.868350 => 20:33:18.933181
[0m20:33:18.933712 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:33:18.934743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233760be-7870-4df5-9a29-bab68e6ed7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f0ed50>]}
[0m20:33:18.936034 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.07s]
[0m20:33:18.937310 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:33:18.939101 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:18.939453 [debug] [MainThread]: On master: BEGIN
[0m20:33:18.939820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:18.951069 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:18.951495 [debug] [MainThread]: On master: COMMIT
[0m20:33:18.951798 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:18.952099 [debug] [MainThread]: On master: COMMIT
[0m20:33:18.952599 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:33:18.953061 [debug] [MainThread]: On master: Close
[0m20:33:18.953799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:18.954201 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:33:18.954543 [info ] [MainThread]: 
[0m20:33:18.954995 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 11.73 seconds (11.73s).
[0m20:33:18.956707 [debug] [MainThread]: Command end result
[0m20:33:18.968356 [info ] [MainThread]: 
[0m20:33:18.969657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:18.970198 [info ] [MainThread]: 
[0m20:33:18.970696 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:33:18.976069 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:18.975745 after 12.20 seconds
[0m20:33:18.976682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c36810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104527bd0>]}
[0m20:33:18.977166 [debug] [MainThread]: Flushing usage events
[0m20:33:32.746508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f20e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c50a90>]}


============================== 20:33:32.755187 | 31e6f37f-02cc-40a2-8277-2661f284ed51 ==============================
[0m20:33:32.755187 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:33:32.755975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:33:32.862136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a09510>]}
[0m20:33:32.882388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d4950>]}
[0m20:33:32.884571 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:33:32.919667 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:33:33.004639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:33.005077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:33.013881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d235d0>]}
[0m20:33:33.022675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793fa90>]}
[0m20:33:33.023187 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:33:33.023571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ad3d0>]}
[0m20:33:33.027036 [info ] [MainThread]: 
[0m20:33:33.028535 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:33:33.030305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:33:33.045082 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:33:33.046035 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:33:33.046986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:33.063292 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:33:33.064860 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:33:33.067348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:33:33.074476 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:33:33.075214 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:33:33.075770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:33.090570 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:33:33.091120 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:33:33.091776 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:33:33.099379 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:33:33.102082 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:33:33.102685 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:33:33.108948 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:33.109569 [debug] [MainThread]: On master: BEGIN
[0m20:33:33.110177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:33.120319 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:33.120675 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:33.121100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:33:33.147980 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:33:33.150109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108652b50>]}
[0m20:33:33.151169 [debug] [MainThread]: On master: ROLLBACK
[0m20:33:33.151919 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:33.152346 [debug] [MainThread]: On master: BEGIN
[0m20:33:33.153185 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:33.153795 [debug] [MainThread]: On master: COMMIT
[0m20:33:33.154179 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:33.154483 [debug] [MainThread]: On master: COMMIT
[0m20:33:33.155673 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:33:33.157178 [debug] [MainThread]: On master: Close
[0m20:33:33.158264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:33:33.158850 [info ] [MainThread]: 
[0m20:33:33.164586 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:33:33.165162 [info ] [Thread-1 (]: 1 of 6 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:33:33.166143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:33:33.168064 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:33:33.171725 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:33:33.172869 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:33:33.168620 => 20:33:33.172483
[0m20:33:33.173354 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:33:33.233065 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:33:33.234135 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:33.235347 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:33:33.235707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:33.246671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:33.247624 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:33.248472 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:33:32' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:33:33.266609 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:33:33.273709 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:33.274153 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:33:33.275043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:33.278915 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:33.280882 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:33:33.282743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:33.315707 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:33:33.316307 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:33.316756 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:33:33.318840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:33.324530 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:33:33.326206 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:33:33.330824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:33.333557 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:33:33.173631 => 20:33:33.333186
[0m20:33:33.334169 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:33:33.335828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108651f90>]}
[0m20:33:33.337326 [info ] [Thread-1 (]: 1 of 6 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.17s]
[0m20:33:33.338340 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:33:33.339066 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:33:33.339813 [info ] [Thread-1 (]: 2 of 6 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:33:33.340821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:33:33.341392 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:33:33.344604 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:33:33.346086 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:33:33.341827 => 20:33:33.345606
[0m20:33:33.348087 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:33:33.354085 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:33:33.355324 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:33.356004 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:33:33.356972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:33.370956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:33.371364 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:33.371704 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:33:32' as dbt_time
from stg.airports_data
  );
  
[0m20:33:33.417972 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:33:33.421407 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:33.421895 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:33:33.423176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:33.427365 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:33.427902 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:33:33.429092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:33.431527 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:33:33.432042 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:33.432448 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:33:33.434296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:33.440649 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:33:33.441080 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:33:33.444119 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:33.445671 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:33:33.348447 => 20:33:33.445474
[0m20:33:33.446144 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:33:33.447165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f2610>]}
[0m20:33:33.448184 [info ] [Thread-1 (]: 2 of 6 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.11s]
[0m20:33:33.449111 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:33:33.449708 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:33:33.450394 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:33:33.451580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:33:33.452131 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:33:33.455917 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:33:33.457828 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:33:33.452366 => 20:33:33.457528
[0m20:33:33.458419 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:33:33.464884 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:33:33.466257 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:33.467694 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:33:33.468276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:33.479355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:33.479890 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:33.480444 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select  bp.*, tf.fare_conditions, tf.amount,
	   '2023-08-16 17:33:32' as dbt_time
from stg.ticket_flights as tf
inner join stg.boarding_passes as bp on tf.flight_id = bp.flight_id 
and bp.ticket_no =tf.ticket_no
  );
  
[0m20:33:37.374852 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 4.0 seconds
[0m20:33:37.378353 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:37.378781 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m20:33:37.379603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:37.382519 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:37.382886 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m20:33:37.462955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:37.465194 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:33:37.465598 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:37.465937 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:33:37.470103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:37.472567 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:33:37.473170 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m20:33:37.481930 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:37.483414 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 20:33:33.459704 => 20:33:37.483219
[0m20:33:37.483762 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m20:33:37.484593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f72d0>]}
[0m20:33:37.485602 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 4.03s]
[0m20:33:37.487178 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m20:33:37.487839 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:33:37.488620 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:33:37.489485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m20:33:37.490080 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:33:37.494087 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:33:37.495329 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:33:37.490427 => 20:33:37.494943
[0m20:33:37.495933 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:33:37.502829 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:33:37.503715 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:37.504127 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:33:37.504521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:37.517230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:37.517692 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:37.518113 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:33:32' as dbt_time
from time_flight
  );
  
[0m20:33:37.635872 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m20:33:37.639709 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:37.640663 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:33:37.642054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:37.647226 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:37.647794 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:33:37.652070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:37.655574 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:33:37.656235 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:37.656655 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:33:37.669328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:37.672032 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:33:37.672432 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:33:37.675053 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:37.676691 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:33:37.496916 => 20:33:37.676464
[0m20:33:37.677211 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:33:37.678167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ed7d0>]}
[0m20:33:37.678991 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.19s]
[0m20:33:37.679735 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:33:37.680437 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:33:37.680905 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:33:37.681934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m20:33:37.682362 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:33:37.685620 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:33:37.687152 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:33:37.682593 => 20:33:37.686520
[0m20:33:37.687778 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:33:37.692954 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:33:37.694341 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:37.695111 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:33:37.695508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:37.711282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:37.711909 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:37.712378 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:33:37.715317 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:33:37.719548 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:37.720150 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:33:37.720912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:37.723774 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:37.724472 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:33:37.725567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:37.730494 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:33:37.730914 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:37.731232 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:33:37.732521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:37.734755 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:33:37.735240 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:33:37.738303 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:37.740576 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:33:37.688156 => 20:33:37.740304
[0m20:33:37.741089 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:33:37.742217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108844bd0>]}
[0m20:33:37.743604 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.06s]
[0m20:33:37.744627 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:33:37.746001 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:33:37.746826 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:33:37.748077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:33:37.748685 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:33:37.752097 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:33:37.753361 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:33:37.749023 => 20:33:37.753029
[0m20:33:37.753768 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:33:37.779501 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:33:37.780312 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:33:37.780751 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:33:37.781123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:37.795049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:33:37.795836 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:33:37.796343 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:33:37.798891 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:33:37.801965 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:33:37.802577 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:33:37.803604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:37.805371 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:33:37.805721 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:33:37.806069 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:33:37.808221 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:33:37.811397 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:33:37.811842 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:33:37.812441 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:33:37.813988 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:33:37.753985 => 20:33:37.813750
[0m20:33:37.814349 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:33:37.815058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e6f37f-02cc-40a2-8277-2661f284ed51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f6b10>]}
[0m20:33:37.815627 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.07s]
[0m20:33:37.816479 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:33:37.818259 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:37.818811 [debug] [MainThread]: On master: BEGIN
[0m20:33:37.819143 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:37.832474 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:37.833145 [debug] [MainThread]: On master: COMMIT
[0m20:33:37.833530 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:37.833904 [debug] [MainThread]: On master: COMMIT
[0m20:33:37.834535 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:33:37.835091 [debug] [MainThread]: On master: Close
[0m20:33:37.835914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:37.837124 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:33:37.837678 [info ] [MainThread]: 
[0m20:33:37.838172 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m20:33:37.840167 [debug] [MainThread]: Command end result
[0m20:33:37.851043 [info ] [MainThread]: 
[0m20:33:37.852008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:37.852570 [info ] [MainThread]: 
[0m20:33:37.853069 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:33:37.853975 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:37.853799 after 5.16 seconds
[0m20:33:37.854679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f200d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e4bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e58c10>]}
[0m20:33:37.855177 [debug] [MainThread]: Flushing usage events
[0m20:53:30.405088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f62690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042501d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104253310>]}


============================== 20:53:30.435047 | 5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f ==============================
[0m20:53:30.435047 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:53:30.436181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:53:30.558498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c02810>]}
[0m20:53:30.577003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f57c50>]}
[0m20:53:30.578917 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:53:30.605789 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:53:30.705379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:53:30.705978 [debug] [MainThread]: Partial parsing: added file: flights_dbt://models/facts/fact_tickets.sql
[0m20:53:30.733086 [debug] [MainThread]: 1603: static parser failed on facts/fact_tickets.sql
[0m20:53:30.752543 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts/fact_tickets.sql
[0m20:53:30.763240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d9410>]}
[0m20:53:30.772256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2d890>]}
[0m20:53:30.772780 [info ] [MainThread]: Found 7 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:53:30.773167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101b0d8d0>]}
[0m20:53:30.776229 [info ] [MainThread]: 
[0m20:53:30.777355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:53:30.778990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:53:30.791253 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:53:30.791852 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:53:30.792591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:30.864716 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:53:30.866827 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:53:30.869736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:53:30.876181 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:53:30.876798 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:53:30.877183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:30.888074 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:53:30.888507 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:53:30.888811 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:53:30.894183 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:53:30.895669 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:53:30.896099 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:53:30.901788 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:30.902167 [debug] [MainThread]: On master: BEGIN
[0m20:53:30.902436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:30.913009 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:53:30.913428 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:30.913791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:53:30.937488 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:53:30.939040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f87710>]}
[0m20:53:30.939448 [debug] [MainThread]: On master: ROLLBACK
[0m20:53:30.939887 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:30.940158 [debug] [MainThread]: On master: BEGIN
[0m20:53:30.940949 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:53:30.941267 [debug] [MainThread]: On master: COMMIT
[0m20:53:30.941546 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:30.941807 [debug] [MainThread]: On master: COMMIT
[0m20:53:30.942171 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:53:30.942487 [debug] [MainThread]: On master: Close
[0m20:53:30.943144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:30.943589 [info ] [MainThread]: 
[0m20:53:30.948399 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:53:30.949256 [info ] [Thread-1 (]: 1 of 7 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:53:30.951376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:53:30.951956 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:53:30.955141 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:53:30.956348 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:53:30.952335 => 20:53:30.956090
[0m20:53:30.956801 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:53:31.007201 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:53:31.008059 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:53:31.008440 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:53:31.008750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:31.018341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:31.018754 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:53:31.019103 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:53:30' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:53:31.057847 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:53:31.065063 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:53:31.065514 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:53:31.066468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:31.069682 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:53:31.070156 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:53:31.071339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:31.097800 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:53:31.098642 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:53:31.099936 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:53:31.104162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:31.114988 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:53:31.115499 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:53:31.359689 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:53:31.366490 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:53:30.957116 => 20:53:31.366251
[0m20:53:31.367225 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:53:31.368135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451df50>]}
[0m20:53:31.369080 [info ] [Thread-1 (]: 1 of 7 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.42s]
[0m20:53:31.369857 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:53:31.370646 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:53:31.371747 [info ] [Thread-1 (]: 2 of 7 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:53:31.373097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:53:31.373826 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:53:31.376826 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:53:31.377910 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:53:31.374195 => 20:53:31.377567
[0m20:53:31.378372 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:53:31.384504 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:53:31.385582 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:53:31.386038 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:53:31.386406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:31.397328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:31.397745 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:53:31.398088 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:53:30' as dbt_time
from stg.airports_data
  );
  
[0m20:53:31.443201 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:53:31.446188 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:53:31.446572 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:53:31.447288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:31.449821 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:53:31.450272 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:53:31.451710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:31.454477 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:53:31.454877 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:53:31.455194 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:53:31.456768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:31.459491 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:53:31.460034 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:53:31.462974 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:53:31.464460 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:53:31.378602 => 20:53:31.464269
[0m20:53:31.464806 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:53:31.465505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc94d0>]}
[0m20:53:31.466053 [info ] [Thread-1 (]: 2 of 7 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.09s]
[0m20:53:31.466980 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:53:31.467513 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:53:31.468046 [info ] [Thread-1 (]: 3 of 7 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:53:31.468974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:53:31.469601 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:53:31.472548 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:53:31.474175 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:53:31.469892 => 20:53:31.473795
[0m20:53:31.474727 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:53:31.479686 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:53:31.480586 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:53:31.481737 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:53:31.482126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:31.496391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:31.496899 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:53:31.497309 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select  bp.*, tf.fare_conditions, tf.amount,
	   '2023-08-16 17:53:30' as dbt_time
from stg.ticket_flights as tf
inner join stg.boarding_passes as bp on tf.flight_id = bp.flight_id 
and bp.ticket_no =tf.ticket_no
  );
  
[0m20:53:35.462659 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 4.0 seconds
[0m20:53:35.466444 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:53:35.467070 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m20:53:35.468242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:35.472036 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:53:35.472578 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m20:53:35.513291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:35.515589 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:53:35.515956 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:53:35.516284 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:53:35.531023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:35.535259 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:53:35.535805 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m20:53:35.540002 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:53:35.541807 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 20:53:31.475068 => 20:53:35.541516
[0m20:53:35.542369 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m20:53:35.543422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e47dd0>]}
[0m20:53:35.544847 [info ] [Thread-1 (]: 3 of 7 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 4.07s]
[0m20:53:35.545835 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m20:53:35.546415 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:53:35.546963 [info ] [Thread-1 (]: 4 of 7 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:53:35.548133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m20:53:35.548614 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:53:35.552709 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:53:35.554863 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:53:35.548901 => 20:53:35.554186
[0m20:53:35.556297 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:53:35.562122 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:53:35.562926 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:53:35.563272 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:53:35.563719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:35.576211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:35.576681 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:53:35.577409 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:53:30' as dbt_time
from time_flight
  );
  
[0m20:53:35.772991 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m20:53:35.776253 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:53:35.776727 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:53:35.777721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:35.781192 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:53:35.781680 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:53:35.786297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:35.789541 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:53:35.790210 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:53:35.791128 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:53:35.801351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:35.805145 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:53:35.805754 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:53:35.810000 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:53:35.812504 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:53:35.556847 => 20:53:35.812201
[0m20:53:35.813020 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:53:35.814123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e20e10>]}
[0m20:53:35.815473 [info ] [Thread-1 (]: 4 of 7 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.27s]
[0m20:53:35.816697 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:53:35.817779 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_tickets
[0m20:53:35.818514 [info ] [Thread-1 (]: 5 of 7 START sql table model flights_wh.fact_tickets ........................... [RUN]
[0m20:53:35.819535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.fact_tickets)
[0m20:53:35.820165 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_tickets
[0m20:53:35.824016 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_tickets"
[0m20:53:35.825036 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_tickets (compile): 20:53:35.820621 => 20:53:35.824714
[0m20:53:35.825973 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_tickets
[0m20:53:35.832916 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_tickets"
[0m20:53:35.833845 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:53:35.834402 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: BEGIN
[0m20:53:35.834953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:35.847179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:35.847727 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:53:35.848615 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_tickets"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp"
  
  
    as
  
  (
    select ti.*, bo.book_date, bo.total_amount,
	   contact_data ->> 'email' as email,
	   contact_data ->> 'phone' as phone,
	   '2023-08-16 17:53:30' as dbt_time
from stg.tickets as ti
inner join stg.bookings as bo on ti.book_ref = bo.book_ref
  );
  
[0m20:53:39.234039 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 3.0 seconds
[0m20:53:39.237777 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:53:39.238177 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp" rename to "fact_tickets"
[0m20:53:39.361072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:39.363506 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: COMMIT
[0m20:53:39.363930 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:53:39.364256 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: COMMIT
[0m20:53:39.366832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:39.369852 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:53:39.370510 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_tickets"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_tickets__dbt_backup" cascade
[0m20:53:39.371420 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:53:39.372839 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_tickets (execute): 20:53:35.826375 => 20:53:39.372652
[0m20:53:39.373182 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: Close
[0m20:53:39.373908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c32010>]}
[0m20:53:39.374472 [info ] [Thread-1 (]: 5 of 7 OK created sql table model flights_wh.fact_tickets ...................... [[32mSELECT 366733[0m in 3.55s]
[0m20:53:39.375131 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_tickets
[0m20:53:39.375651 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:53:39.376559 [info ] [Thread-1 (]: 6 of 7 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:53:39.377584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_tickets, now model.flights_dbt.my_first_dbt_model)
[0m20:53:39.378269 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:53:39.381290 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:53:39.382455 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:53:39.378583 => 20:53:39.382124
[0m20:53:39.382919 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:53:39.387597 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:53:39.388435 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:53:39.388808 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:53:39.389147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:39.439835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:39.440466 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:53:39.440896 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:53:39.445158 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:53:39.448299 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:53:39.448669 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:53:39.449414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:39.453104 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:53:39.453717 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:53:39.454860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:39.457274 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:53:39.458045 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:53:39.458629 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:53:39.460251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:39.464750 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:53:39.465322 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:53:39.468293 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:53:39.469943 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:53:39.383154 => 20:53:39.469752
[0m20:53:39.470504 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:53:39.471371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e848d0>]}
[0m20:53:39.472041 [info ] [Thread-1 (]: 6 of 7 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.09s]
[0m20:53:39.472968 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:53:39.474483 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:53:39.475112 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:53:39.476389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:53:39.477186 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:53:39.480780 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:53:39.482311 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:53:39.477631 => 20:53:39.481802
[0m20:53:39.482925 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:53:39.505310 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:53:39.506065 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:53:39.506429 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:53:39.506732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:39.519027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:53:39.519437 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:53:39.519831 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:53:39.522657 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:53:39.525832 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:53:39.526642 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:53:39.528947 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:53:39.531295 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:53:39.531858 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:53:39.532220 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:53:39.533533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:53:39.535566 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:53:39.536248 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:53:39.536962 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:53:39.538545 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:53:39.483368 => 20:53:39.538357
[0m20:53:39.538886 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:53:39.539630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ee2b7a9-bfa5-4d2b-85f4-5eca76ac8c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e85850>]}
[0m20:53:39.540480 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.06s]
[0m20:53:39.541376 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:53:39.543567 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:39.544132 [debug] [MainThread]: On master: BEGIN
[0m20:53:39.544688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:39.563532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:53:39.563904 [debug] [MainThread]: On master: COMMIT
[0m20:53:39.564179 [debug] [MainThread]: Using postgres connection "master"
[0m20:53:39.564442 [debug] [MainThread]: On master: COMMIT
[0m20:53:39.564799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:53:39.565073 [debug] [MainThread]: On master: Close
[0m20:53:39.565728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:39.566020 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:53:39.566361 [info ] [MainThread]: 
[0m20:53:39.566754 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m20:53:39.568404 [debug] [MainThread]: Command end result
[0m20:53:39.577471 [info ] [MainThread]: 
[0m20:53:39.578102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:53:39.578934 [info ] [MainThread]: 
[0m20:53:39.579491 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:53:39.581265 [debug] [MainThread]: Command `dbt run` succeeded at 20:53:39.580993 after 9.22 seconds
[0m20:53:39.582092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100464c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100464c10>]}
[0m20:53:39.582741 [debug] [MainThread]: Flushing usage events
[0m20:54:14.197459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d310>]}


============================== 20:54:14.219350 | 41247423-8803-43fb-a8ea-4b1fb77ce275 ==============================
[0m20:54:14.219350 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:54:14.220083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/moranshorashi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/moranshorashi/flights_dbt_course/flights_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:54:14.352255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5bd50>]}
[0m20:54:14.371861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf5bd0>]}
[0m20:54:14.374305 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:54:14.401668 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:54:14.490009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:14.491832 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models/facts/schema.yml
[0m20:54:14.558106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697ec90>]}
[0m20:54:14.567220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766bb90>]}
[0m20:54:14.567752 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:54:14.568139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104529910>]}
[0m20:54:14.571314 [info ] [MainThread]: 
[0m20:54:14.572750 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:14.574298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m20:54:14.584980 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m20:54:14.585396 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m20:54:14.585705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:14.690118 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:54:14.692070 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m20:54:14.694097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_dbt_course, now list_flights_dbt_course_flights_wh)
[0m20:54:14.700463 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:54:14.700884 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m20:54:14.701160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:14.711675 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:54:14.712218 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m20:54:14.712596 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:54:14.715866 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:54:14.717416 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m20:54:14.718217 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m20:54:14.725735 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:14.726241 [debug] [MainThread]: On master: BEGIN
[0m20:54:14.726728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:14.741314 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:14.742269 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:14.742667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:14.767422 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:54:14.768994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106946790>]}
[0m20:54:14.769465 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:14.769877 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:14.770154 [debug] [MainThread]: On master: BEGIN
[0m20:54:14.771165 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:14.771713 [debug] [MainThread]: On master: COMMIT
[0m20:54:14.772103 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:14.772398 [debug] [MainThread]: On master: COMMIT
[0m20:54:14.773473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:54:14.773962 [debug] [MainThread]: On master: Close
[0m20:54:14.775278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:14.775851 [info ] [MainThread]: 
[0m20:54:14.781835 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_aircraft
[0m20:54:14.782491 [info ] [Thread-1 (]: 1 of 7 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m20:54:14.783567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_flights_dbt_course_flights_wh, now model.flights_dbt.dim_aircraft)
[0m20:54:14.783991 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_aircraft
[0m20:54:14.787789 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_aircraft"
[0m20:54:14.789286 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (compile): 20:54:14.784238 => 20:54:14.788751
[0m20:54:14.790078 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_aircraft
[0m20:54:14.841583 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_aircraft"
[0m20:54:14.842785 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:54:14.843214 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: BEGIN
[0m20:54:14.843546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.855135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:14.856001 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:54:14.856887 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.*, se.seat_no, se.fare_conditions,
case when ad.range > 5600 then 'high'
	 when ad.range < 5600 then 'low'
	 end as range_mode,
ad.model -> 'en' as Model_English,
ad.model -> 'ru' as Model_Russian,
'2023-08-16 17:54:14' as dbt_time
from stg.aircrafts_data as ad 
inner join stg.seats as se on ad.aircraft_code = se.aircraft_code
  );
  
[0m20:54:14.904862 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:54:14.912621 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:54:14.913207 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m20:54:14.914206 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:14.917228 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:54:14.917628 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m20:54:14.918760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:14.948202 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:54:14.948683 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:54:14.949013 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: COMMIT
[0m20:54:14.951448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:14.958000 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_aircraft"
[0m20:54:14.958428 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m20:54:14.961251 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:14.963067 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_aircraft (execute): 20:54:14.791038 => 20:54:14.962837
[0m20:54:14.963455 [debug] [Thread-1 (]: On model.flights_dbt.dim_aircraft: Close
[0m20:54:14.964221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069479d0>]}
[0m20:54:14.965020 [info ] [Thread-1 (]: 1 of 7 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.18s]
[0m20:54:14.966445 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_aircraft
[0m20:54:14.966945 [debug] [Thread-1 (]: Began running node model.flights_dbt.dim_airport
[0m20:54:14.967470 [info ] [Thread-1 (]: 2 of 7 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m20:54:14.968230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_aircraft, now model.flights_dbt.dim_airport)
[0m20:54:14.968602 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.dim_airport
[0m20:54:14.971759 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.dim_airport"
[0m20:54:14.973199 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (compile): 20:54:14.968827 => 20:54:14.972896
[0m20:54:14.973658 [debug] [Thread-1 (]: Began executing node model.flights_dbt.dim_airport
[0m20:54:14.978920 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.dim_airport"
[0m20:54:14.979910 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:54:14.980319 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: BEGIN
[0m20:54:14.980852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:14.994168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:14.994604 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:54:14.995062 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *, 
	   airport_name ->> 'en' as english_name,
	   airport_name ->> 'ru' as rusion_name,
	   city ->> 'en' as english_name2,
	   city ->> 'ru' as rusion_name2,
	   '2023-08-16 17:54:14' as dbt_time
from stg.airports_data
  );
  
[0m20:54:15.040673 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:54:15.043483 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:54:15.043972 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m20:54:15.045343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:15.048989 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:54:15.049400 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m20:54:15.050317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:15.053161 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:54:15.053626 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:54:15.054055 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: COMMIT
[0m20:54:15.055688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:15.059666 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.dim_airport"
[0m20:54:15.060069 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m20:54:15.062874 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:15.064630 [debug] [Thread-1 (]: Timing info for model.flights_dbt.dim_airport (execute): 20:54:14.973884 => 20:54:15.064346
[0m20:54:15.064995 [debug] [Thread-1 (]: On model.flights_dbt.dim_airport: Close
[0m20:54:15.065765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cc450>]}
[0m20:54:15.066729 [info ] [Thread-1 (]: 2 of 7 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.10s]
[0m20:54:15.067822 [debug] [Thread-1 (]: Finished running node model.flights_dbt.dim_airport
[0m20:54:15.068360 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_boarding_passes
[0m20:54:15.068951 [info ] [Thread-1 (]: 3 of 7 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m20:54:15.069708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.dim_airport, now model.flights_dbt.fact_boarding_passes)
[0m20:54:15.070127 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_boarding_passes
[0m20:54:15.073786 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_boarding_passes"
[0m20:54:15.074731 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (compile): 20:54:15.070492 => 20:54:15.074462
[0m20:54:15.075198 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_boarding_passes
[0m20:54:15.080837 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_boarding_passes"
[0m20:54:15.081721 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:54:15.082138 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: BEGIN
[0m20:54:15.082489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:15.094984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:15.095390 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:54:15.095763 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    select  bp.*, tf.fare_conditions, tf.amount,
	   '2023-08-16 17:54:14' as dbt_time
from stg.ticket_flights as tf
inner join stg.boarding_passes as bp on tf.flight_id = bp.flight_id 
and bp.ticket_no =tf.ticket_no
  );
  
[0m20:54:19.164430 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 4.0 seconds
[0m20:54:19.167702 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:54:19.168092 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m20:54:19.168884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:19.173508 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:54:19.174442 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m20:54:19.245820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:19.247951 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:54:19.248313 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:54:19.248633 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: COMMIT
[0m20:54:19.255005 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:19.258443 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_boarding_passes"
[0m20:54:19.258841 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m20:54:19.266636 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:19.268069 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_boarding_passes (execute): 20:54:15.075451 => 20:54:19.267869
[0m20:54:19.268497 [debug] [Thread-1 (]: On model.flights_dbt.fact_boarding_passes: Close
[0m20:54:19.269371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078657d0>]}
[0m20:54:19.270058 [info ] [Thread-1 (]: 3 of 7 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 4.20s]
[0m20:54:19.271585 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_boarding_passes
[0m20:54:19.272268 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_flights
[0m20:54:19.273179 [info ] [Thread-1 (]: 4 of 7 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m20:54:19.274783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_boarding_passes, now model.flights_dbt.fact_flights)
[0m20:54:19.275699 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_flights
[0m20:54:19.279579 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_flights"
[0m20:54:19.281548 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (compile): 20:54:19.276220 => 20:54:19.281210
[0m20:54:19.282124 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_flights
[0m20:54:19.287988 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_flights"
[0m20:54:19.289243 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:54:19.290152 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: BEGIN
[0m20:54:19.290964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:19.348443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:19.348959 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:54:19.349647 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    with time_flight as ( 
		select *, 
		actual_arrival-actual_departure as flight_duration,
		scheduled_arrival-scheduled_departure as scheduled_flight_duration
		from stg.flights as fl
		)
select *,
case when flight_duration > scheduled_flight_duration then 'longer'
	 when flight_duration < scheduled_flight_duration then 'shorter'
	 when flight_duration = scheduled_flight_duration then 'as expected'
	 else null
	 end as time_expectation,
	   '2023-08-16 17:54:14' as dbt_time
from time_flight
  );
  
[0m20:54:19.508471 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m20:54:19.512249 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:54:19.512752 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m20:54:19.513503 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:19.516371 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:54:19.516745 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m20:54:19.520877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:19.523243 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:54:19.523652 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:54:19.523969 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: COMMIT
[0m20:54:19.540856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:19.543797 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_flights"
[0m20:54:19.544323 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m20:54:19.548606 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:19.550062 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_flights (execute): 20:54:19.282588 => 20:54:19.549861
[0m20:54:19.550539 [debug] [Thread-1 (]: On model.flights_dbt.fact_flights: Close
[0m20:54:19.552042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107674590>]}
[0m20:54:19.553061 [info ] [Thread-1 (]: 4 of 7 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.28s]
[0m20:54:19.554158 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_flights
[0m20:54:19.554815 [debug] [Thread-1 (]: Began running node model.flights_dbt.fact_tickets
[0m20:54:19.555673 [info ] [Thread-1 (]: 5 of 7 START sql table model flights_wh.fact_tickets ........................... [RUN]
[0m20:54:19.556566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_flights, now model.flights_dbt.fact_tickets)
[0m20:54:19.557401 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.fact_tickets
[0m20:54:19.560317 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.fact_tickets"
[0m20:54:19.561212 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_tickets (compile): 20:54:19.557711 => 20:54:19.560989
[0m20:54:19.561805 [debug] [Thread-1 (]: Began executing node model.flights_dbt.fact_tickets
[0m20:54:19.566102 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.fact_tickets"
[0m20:54:19.567163 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:54:19.567571 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: BEGIN
[0m20:54:19.567880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:19.580067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:19.580655 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:54:19.581222 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_tickets"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp"
  
  
    as
  
  (
    select ti.*, bo.book_date, bo.total_amount,
	   contact_data ->> 'email' as email,
	   contact_data ->> 'phone' as phone,
	   '2023-08-16 17:54:14' as dbt_time
from stg.tickets as ti
inner join stg.bookings as bo on ti.book_ref = bo.book_ref
  );
  
[0m20:54:23.125330 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 4.0 seconds
[0m20:54:23.128553 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:54:23.128923 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets" rename to "fact_tickets__dbt_backup"
[0m20:54:23.129664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:23.133093 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:54:23.133723 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp" rename to "fact_tickets"
[0m20:54:23.252191 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:23.254698 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: COMMIT
[0m20:54:23.255056 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:54:23.255400 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: COMMIT
[0m20:54:23.276508 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:23.278810 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.fact_tickets"
[0m20:54:23.279386 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.fact_tickets"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_tickets__dbt_backup" cascade
[0m20:54:23.286296 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:23.287761 [debug] [Thread-1 (]: Timing info for model.flights_dbt.fact_tickets (execute): 20:54:19.562135 => 20:54:23.287572
[0m20:54:23.288106 [debug] [Thread-1 (]: On model.flights_dbt.fact_tickets: Close
[0m20:54:23.288821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a48110>]}
[0m20:54:23.289349 [info ] [Thread-1 (]: 5 of 7 OK created sql table model flights_wh.fact_tickets ...................... [[32mSELECT 366733[0m in 3.73s]
[0m20:54:23.290074 [debug] [Thread-1 (]: Finished running node model.flights_dbt.fact_tickets
[0m20:54:23.291120 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:54:23.291992 [info ] [Thread-1 (]: 6 of 7 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m20:54:23.292990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.fact_tickets, now model.flights_dbt.my_first_dbt_model)
[0m20:54:23.293400 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:54:23.296749 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:54:23.297923 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:54:23.293629 => 20:54:23.297702
[0m20:54:23.298340 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:54:23.304107 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:54:23.305155 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:54:23.305659 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:54:23.306012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:23.318871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:23.319422 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:54:23.319812 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:54:23.322494 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:54:23.325959 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:54:23.326567 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:54:23.327279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:23.332135 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:54:23.332777 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:54:23.333966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:23.336240 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:54:23.336667 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:54:23.336987 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:54:23.338178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:23.341087 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:54:23.341736 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:54:23.344544 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:54:23.346336 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:54:23.298694 => 20:54:23.346048
[0m20:54:23.346730 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:54:23.347455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cc450>]}
[0m20:54:23.348028 [info ] [Thread-1 (]: 6 of 7 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.05s]
[0m20:54:23.348838 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:54:23.350063 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:54:23.350953 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:54:23.352184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:54:23.352628 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:54:23.355003 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:54:23.355784 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:54:23.352856 => 20:54:23.355527
[0m20:54:23.356197 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:54:23.379336 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:54:23.381393 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:54:23.381974 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:54:23.382743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:23.394268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:23.394737 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:54:23.395138 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:54:23.601402 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:54:23.604312 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:54:23.604808 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:54:23.605726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:54:23.607770 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:54:23.608346 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:54:23.608933 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:54:23.691580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:54:23.693881 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:54:23.694260 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:54:23.695193 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:54:23.697404 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:54:23.356426 => 20:54:23.697072
[0m20:54:23.697810 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:54:23.698692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41247423-8803-43fb-a8ea-4b1fb77ce275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ceef90>]}
[0m20:54:23.699803 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.35s]
[0m20:54:23.701054 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:54:23.703197 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:23.703686 [debug] [MainThread]: On master: BEGIN
[0m20:54:23.703972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:23.714951 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:23.715341 [debug] [MainThread]: On master: COMMIT
[0m20:54:23.715815 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:23.716230 [debug] [MainThread]: On master: COMMIT
[0m20:54:23.716880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:54:23.717237 [debug] [MainThread]: On master: Close
[0m20:54:23.717969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:23.718273 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:54:23.718710 [info ] [MainThread]: 
[0m20:54:23.719105 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m20:54:23.720937 [debug] [MainThread]: Command end result
[0m20:54:23.729306 [info ] [MainThread]: 
[0m20:54:23.729867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:23.730317 [info ] [MainThread]: 
[0m20:54:23.731036 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:54:23.732206 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:23.732024 after 9.56 seconds
[0m20:54:23.732755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e73d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e73dd0>]}
[0m20:54:23.733132 [debug] [MainThread]: Flushing usage events
